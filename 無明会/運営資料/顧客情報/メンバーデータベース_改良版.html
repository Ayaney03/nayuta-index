<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ‘¥ ç„¡æ˜ä¼š ãƒ¡ãƒ³ãƒãƒ¼ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hiragino Kaku Gothic ProN', 'Yu Gothic', 'Meiryo', sans-serif;
            background: linear-gradient(135deg, #f8f6f3 0%, #fff8dc 50%, #f5e6a3 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼ & çµ±è¨ˆã‚¨ãƒªã‚¢ï¼ˆ2ã‚«ãƒ©ãƒ ï¼‰ */
        .header-stats {
            display: grid; 
            grid-template-columns: 1fr 2fr; 
            gap: 20px; 
            margin: 20px 0; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); 
            padding: 20px; 
            border-radius: 12px; 
            color: white;
        }

        .header-info h1 {
            font-size: 1.8em; 
            margin: 0 0 8px 0;
        }

        .header-info h2 {
            font-size: 1.2em; 
            margin: 0 0 12px 0; 
            opacity: 0.9;
        }

        .header-info p {
            margin: 0; 
            opacity: 0.8; 
            font-size: 0.9em;
        }

        .stats-grid {
            display: grid; 
            grid-template-columns: repeat(3, 1fr); 
            gap: 12px;
        }

        .stat-card {
            background: rgba(255,255,255,0.15); 
            padding: 12px; 
            border-radius: 8px; 
            text-align: center; 
            backdrop-filter: blur(10px);
        }

        .stat-number {
            font-size: 1.4em; 
            font-weight: bold;
        }

        .stat-label {
            font-size: 0.75em; 
            opacity: 0.9;
        }

        /* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ */
        .filters {
            background: white;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .filter-row {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        select, input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.9em;
        }

        button {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9em;
        }

        .btn-primary { background: #007bff; color: white; }
        .btn-success { background: #28a745; color: white; }

        /* ä¸‰æ¯’ãƒãƒ¼ãƒ çµ±è¨ˆ */
        .team-stats {
            background: #f8f9fa;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            border-left: 4px solid #6f42c1;
        }

        .team-stats h3 {
            color: #6f42c1;
            margin-bottom: 10px;
            font-size: 1em;
        }

        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            font-size: 0.85em;
        }

        .team-card {
            padding: 8px;
            border-radius: 4px;
            text-align: center;
            color: white;
            font-weight: bold;
        }

        .team-è²ªæ¬² { background: #ffc107; color: #856404; }
        .team-ç‹æš { background: #dc3545; }
        .team-æ„šç—´ { background: #28a745; }
        .team-ãªã— { background: #6c757d; }
        .team-æœªè¨­å®š { background: #e9ecef; color: #666; }

        /* ãƒ¡ãƒ³ãƒãƒ¼ãƒªã‚¹ãƒˆ */
        .member-list {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .member-header {
            background: #2c3e50;
            color: white;
            padding: 10px 15px;
            display: grid;
            grid-template-columns: 50px 150px 100px 80px 100px 100px 120px;
            gap: 10px;
            font-weight: bold;
            font-size: 0.8em;
        }

        .member-header.with-rank {
            grid-template-columns: 40px 50px 150px 100px 80px 100px 100px 120px;
        }

        .member-item {
            padding: 8px 15px;
            border-bottom: 1px solid #e9ecef;
            display: grid;
            grid-template-columns: 50px 150px 100px 80px 100px 100px 120px;
            gap: 10px;
            font-size: 0.8em;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .member-item.with-rank {
            grid-template-columns: 40px 50px 150px 100px 80px 100px 100px 120px;
        }

        .rank-number {
            text-align: center;
            font-weight: bold;
            color: #6f42c1;
        }

        .member-item:hover {
            background-color: #f8f9fa;
        }

        .member-item.faded {
            opacity: 0.6;
        }

        /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è‰² */
        .status-å¹´é–“ { color: #28a745; font-weight: bold; }
        .status-é€šå¸¸ { color: #17a2b8; font-weight: bold; }
        .status-ä½“é¨“ä¸­ { color: #007bff; font-weight: bold; }
        .status-ä½“é¨“çµ‚äº† { color: #ffc107; }
        .status-é€€ä¼š { color: #dc3545; }

        /* ãƒãƒ¼ãƒ è¡¨ç¤º */
        .team-display {
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.7em;
            color: white;
        }

        .team-display.team-è²ªæ¬² { background: #ffc107; color: #856404; }
        .team-display.team-ç‹æš { background: #dc3545; }
        .team-display.team-æ„šç—´ { background: #28a745; }
        .team-display.team-ãªã— { background: #6c757d; }
        .team-display.team-æœªè¨­å®š { background: #e9ecef; color: #666; }
    </style>
</head>
<body>
    <div class="container">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ & çµ±è¨ˆ -->
        <div class="header-stats">
            <div class="header-info">
                <h1>ğŸ‘¥ ç„¡æ˜ä¼š</h1>
                <h2>ãƒ¡ãƒ³ãƒãƒ¼ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</h2>
                <p>ãƒ¡ãƒ³ãƒãƒ¼ç®¡ç†ãƒ»LTVåˆ†æã‚·ã‚¹ãƒ†ãƒ </p>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="total-members">0</div>
                    <div class="stat-label">ğŸ‘¥ ç·ãƒ¡ãƒ³ãƒãƒ¼</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="annual-members">0</div>
                    <div class="stat-label">ğŸ’ å¹´é–“ä¼šå“¡</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="regular-members">0</div>
                    <div class="stat-label">â­ é€šå¸¸ä¼šå“¡</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="trial-members">0</div>
                    <div class="stat-label">ğŸ”µ ä½“é¨“ä¸­</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="trial-ended">0</div>
                    <div class="stat-label">â° ä½“é¨“çµ‚äº†</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="churned">0</div>
                    <div class="stat-label">âŒ é€€ä¼š</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="active-ltv">Â¥0M</div>
                    <div class="stat-label">ğŸ’° ç¾å½¹LTV</div>
                </div>
            </div>
        </div>

        <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
        <div class="filters">
            <div class="filter-row">
                <div class="filter-item">
                    <label>ğŸ” æ¤œç´¢:</label>
                    <input type="text" id="searchBox" placeholder="åå‰ã§æ¤œç´¢..." style="width: 200px;">
                </div>
                <div class="filter-item">
                    <label>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹:</label>
                    <select id="statusFilter">
                        <option value="">å…¨ã¦</option>
                        <option value="å¹´é–“">å¹´é–“ä¼šå“¡</option>
                        <option value="é€šå¸¸">é€šå¸¸ä¼šå“¡</option>
                        <option value="ä½“é¨“çµ‚äº†">ä½“é¨“çµ‚äº†</option>
                        <option value="é€€ä¼š">é€€ä¼š</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label>ãƒãƒ¼ãƒ :</label>
                    <select id="teamFilter">
                        <option value="">å…¨ã¦</option>
                        <option value="è²ªæ¬²">è²ªæ¬²ãƒãƒ¼ãƒ </option>
                        <option value="ç‹æš">ç‹æšãƒãƒ¼ãƒ </option>
                        <option value="æ„šç—´">æ„šç—´ãƒãƒ¼ãƒ </option>
                        <option value="ãªã—">ãƒãƒ¼ãƒ æœªæ‰€å±</option>
                        <option value="æœªè¨­å®š">æœªè¨­å®š</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label>ä¸¦ã³é †:</label>
                    <select id="sortBy">
                        <option value="id">IDé †</option>
                        <option value="name">åå‰é †</option>
                        <option value="ltv-high">LTVé«˜ã„é †</option>
                        <option value="ltv-low">LTVä½ã„é †</option>
                        <option value="total-ltv-high">ç·LTVé«˜ã„é †</option>
                        <option value="total-ltv-low">ç·LTVä½ã„é †</option>
                        <option value="upsell-high">ã‚¢ãƒƒãƒ—ã‚»ãƒ«é«˜ã„é †</option>
                    </select>
                </div>
                <button class="btn-success" id="activeOnlyBtn">ğŸ‘¥ ç¾å½¹ä¼šå“¡ã®ã¿</button>
                <button class="btn-primary" id="ltvRankingBtn">ğŸ† LTVãƒ©ãƒ³ã‚­ãƒ³ã‚°</button>
            </div>
        </div>

        <!-- ä¸‰æ¯’ãƒãƒ¼ãƒ çµ±è¨ˆ -->
        <div class="team-stats">
            <h3>ğŸ”® ä¸‰æ¯’ãƒãƒ¼ãƒ åˆ†å¸ƒ</h3>
            <div class="team-grid">
                <div class="team-card team-è²ªæ¬²">
                    <div id="greed-count">0</div>
                    <div>è²ªæ¬²ãƒãƒ¼ãƒ </div>
                </div>
                <div class="team-card team-ç‹æš">
                    <div id="anger-count">0</div>
                    <div>ç‹æšãƒãƒ¼ãƒ </div>
                </div>
                <div class="team-card team-æ„šç—´">
                    <div id="ignorance-count">0</div>
                    <div>æ„šç—´ãƒãƒ¼ãƒ </div>
                </div>
                <div class="team-card team-ãªã—">
                    <div id="no-team-count">0</div>
                    <div>ãƒãƒ¼ãƒ æœªæ‰€å±</div>
                </div>
                <div class="team-card team-æœªè¨­å®š">
                    <div id="unassigned-count">0</div>
                    <div>æœªè¨­å®š</div>
                </div>
            </div>
        </div>

        <!-- ãƒ¡ãƒ³ãƒãƒ¼ãƒªã‚¹ãƒˆ -->
        <div class="member-list">
            <div class="member-header">
                <div id="rankHeader" style="display: none;">é †ä½</div>
                <div>ID</div>
                <div>åå‰</div>
                <div>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</div>
                <div>ä¸‰æ¯’ãƒãƒ¼ãƒ </div>
                <div>åŸºæœ¬LTV</div>
                <div>ã‚¢ãƒƒãƒ—ã‚»ãƒ«</div>
                <div>ç·LTV</div>
            </div>
            <div id="memberGrid">
                <!-- ãƒ¡ãƒ³ãƒãƒ¼ä¸€è¦§ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
            </div>
        </div>
    </div>

    <script>
        // CSVãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€
        let members = [];
        let filteredMembers = [];
        let showActiveOnly = false;

        // CSVãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
        // CSVã‚’è§£æã™ã‚‹é–¢æ•°ï¼ˆã‚«ãƒ³ãƒã‚’å«ã‚€å€¤ã«å¯¾å¿œï¼‰
        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                if (char === '"') {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    result.push(current.trim());
                    current = '';
                } else {
                    current += char;
                }
            }
            result.push(current.trim());
            return result;
        }

        async function loadMembersFromCSV() {
            try {
                console.log('CSVãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿é–‹å§‹');
                const response = await fetch('members_data.csv');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const csvText = await response.text();
                console.log('CSVèª­ã¿è¾¼ã¿æˆåŠŸã€ãƒ†ã‚­ã‚¹ãƒˆé•·:', csvText.length);
                
                const lines = csvText.split('\n').filter(line => line.trim());
                console.log('ç·è¡Œæ•°:', lines.length);
                
                const headers = parseCSVLine(lines[0]);
                console.log('CSVãƒ˜ãƒƒãƒ€ãƒ¼:', headers);
                
                members = []; // é…åˆ—ã‚’ãƒªã‚»ãƒƒãƒˆ
                
                for (let i = 1; i < lines.length; i++) {
                    const values = parseCSVLine(lines[i]);
                    if (values.length >= 5 && values[0] && values[1]) { // IDã¨åå‰ãŒã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
                        const member = {
                            id: values[0] || '',
                            name: values[1] || '',
                            furigana: values[2] || '',
                            discord: values[3] || '',
                            discordId: values[4] || '',
                            status: values[5] || '',
                            joinDate: values[6] || '',
                            regularJoinDate: values[7] || '',
                            annualPaymentDate: values[8] || '',
                            team: values[9] || 'æœªè¨­å®š',
                            lastActive: values[10] || '',
                            events: parseInt(values[11]) || 0,
                            ltv: parseInt(values[12]) || 0,
                            tesseiShin: values[13] || '',
                            nhProduct: values[14] || '',
                            nhAmount: parseInt(values[15]) || 0,
                            nhDate: values[16] || '',
                            upsell: (values[13] === 'ã‚ã‚Š' ? 330000 : 0) + (parseInt(values[15]) || 0),
                            purchaseHistory: []
                        };
                        
                        // è³¼å…¥å±¥æ­´ã®ç”Ÿæˆ
                        if (member.tesseiShin === 'ã‚ã‚Š') {
                            member.purchaseHistory.push({
                                date: '2025-06-01',
                                product: 'å¾¹åº•ç²¾é€²',
                                amount: 330000,
                                type: 'ã‚¢ãƒƒãƒ—ã‚»ãƒ«'
                            });
                        }
                        
                        if (member.nhProduct && member.nhAmount > 0) {
                            member.purchaseHistory.push({
                                date: member.nhDate,
                                product: member.nhProduct,
                                amount: member.nhAmount,
                                type: 'ã‚¢ãƒƒãƒ—ã‚»ãƒ«'
                            });
                        }
                        
                        members.push(member);
                    }
                }
                
                console.log('CSVèª­ã¿è¾¼ã¿å®Œäº†:', members.length, 'å');
                filteredMembers = [...members];
                return true;
                
            } catch (error) {
                console.error('CSVèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
                console.log('120äººã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¾ã™');
                
                // 120äººåˆ†ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿
                members = [
            { id: 'M001', name: 'è—¤æ¾¤ç§€å½°', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 650000, upsell: 0 },
            { id: 'M002', name: 'éˆ´æœ¨è£•ä»‹', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 9800, upsell: 0 },
            { id: 'M003', name: 'ç¦äº•åº·å¤§', status: 'å¹´é–“', team: 'è²ªæ¬²', ltv: 720000, upsell: 0 },
            { id: 'M004', name: 'ä¿µå¥å¤ªéƒ', status: 'å¹´é–“', team: 'ç‹æš', ltv: 620000, upsell: 0 },
            { id: 'M005', name: 'é€²è—¤å‹‡è¼', status: 'é€šå¸¸', team: 'æ„šç—´', ltv: 780000, upsell: 0 },
            { id: 'M006', name: 'ä½è—¤è«’é§¿', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 540000, upsell: 0 },
            { id: 'M007', name: 'æ‰å¹³æ¶¼', status: 'é€šå¸¸', team: 'æ„šç—´', ltv: 320000, upsell: 0 },
            { id: 'M008', name: 'æ¾æœ¬å’Œä¹…', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 150000, upsell: 0 },
            { id: 'M009', name: 'æ¾ç”°é™½å¹³', status: 'é€šå¸¸', team: 'ç‹æš', ltv: 280000, upsell: 55000 },
            { id: 'M010', name: 'äº•ä¸Šç´”ä¹Ÿ', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 90000, upsell: 0 },
            { id: 'M011', name: 'æ ¹å¡šé™½å·±', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 60000, upsell: 0 },
            { id: 'M012', name: 'è—¤åŸç¶œå¤ªéƒ', status: 'å¹´é–“', team: 'è²ªæ¬²', ltv: 880000, upsell: 0 },
            { id: 'M013', name: 'çŸ³å³¶ç§€å³°', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 180000, upsell: 0 },
            { id: 'M014', name: 'ä½è—¤äºœç¾', status: 'å¹´é–“', team: 'æ„šç—´', ltv: 760000, upsell: 0 },
            { id: 'M015', name: 'å¡šæœ¬çœŸä¼', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 120000, upsell: 0 },
            { id: 'M016', name: 'æ¹Šç¿”å¤ªéƒ', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M017', name: 'éˆ´æœ¨èœæ‘˜', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 60000, upsell: 0 },
            { id: 'M018', name: 'æ¾å³¶å¾¹', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 90000, upsell: 0 },
            { id: 'M019', name: 'ç²Ÿæ´¥å¾‹å­', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M020', name: 'æ¦æœ¬é«˜ä¹Ÿ', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 60000, upsell: 0 },
            { id: 'M021', name: 'çŸ³å£å‰è¦', status: 'é€šå¸¸', team: 'ãªã—', ltv: 170000, upsell: 0 },
            { id: 'M022', name: 'ãƒ–ãƒ«', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M023', name: 'éˆ´æœ¨åº·å¤ª', status: 'å¹´é–“', team: 'è²ªæ¬²', ltv: 480000, upsell: 0 },
            { id: 'M024', name: 'å¥¥æ‘æ‹“å“‰', status: 'é€šå¸¸', team: 'ãªã—', ltv: 320000, upsell: 0 },
            { id: 'M025', name: 'æ± æœ¬æ¹Šäº†æ±°', status: 'é€šå¸¸', team: 'ãªã—', ltv: 240000, upsell: 0 },
            { id: 'M026', name: 'æ¾æœ¬ç«œå­£', status: 'å¹´é–“', team: 'ç‹æš', ltv: 400000, upsell: 0 },
            { id: 'M027', name: 'è¥¿å³¶é¢¯äºº', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 60000, upsell: 0 },
            { id: 'M028', name: 'å±±ç¸£èª äºŒ', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M029', name: 'ç¶¿è²«æ¡‚å¤ª', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M030', name: 'æ¸…æ°´æš', status: 'é€šå¸¸', team: 'ç‹æš', ltv: 120000, upsell: 0 },
            { id: 'M031', name: 'ä¸­æ‘æ„å¤®é‡Œ', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M032', name: 'å³¶å®ˆå‹‡æ¬¡', status: 'ä½“é¨“çµ‚äº†', team: 'ãªã—', ltv: 60000, upsell: 0 },
            { id: 'M033', name: 'åƒå‰è‰¯ä¿Šå……', status: 'é€šå¸¸', team: 'ãªã—', ltv: 160000, upsell: 0 },
            { id: 'M034', name: 'å²©ä¸‹æœªèª‰å­', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M035', name: 'å®‰ç”°æ»‰ä¸€', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M036', name: 'çœŸæœ¨æ™ºä¹‹', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M037', name: 'å‰åµœä¿Šä¸€éƒ', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M038', name: 'ä»Šäº•ä¸€çœŸ', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M039', name: 'å¹³é‡ç†çµµ', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M040', name: 'å†…ç”°æ³°æ–‡', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M041', name: 'å¢—ç”°å‡Œä¸€', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M042', name: 'æ–°ä¿å‹æœ›å¥ˆ', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M043', name: 'å¸‚å·ä½³å¥ˆ', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M044', name: 'æ¸¡é‚‰æ™ºå¤§', status: 'å¹´é–“', team: 'æ„šç—´', ltv: 600000, upsell: 0 },
            { id: 'M045', name: 'æ³‰ç”°ç¥è¼', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M046', name: 'æ°¸äº•å…‹å¹¸', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M047', name: 'èŒ‚æœ¨ä¸€å¹¸', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M048', name: 'æ¾ç”°åœ­å³', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M049', name: 'æ¾æ‘é¼æ²³', status: 'é€šå¸¸', team: 'æ„šç—´', ltv: 320000, upsell: 0 },
            { id: 'M050', name: 'å¹³å²©é¼å¿—', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M051', name: 'ä½è—¤ä¸€æ°—', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M052', name: 'ç…§äº•ç´€è‡£', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M053', name: 'å‚è©°å®£äºº', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M054', name: 'ä¸­æ‚ å¤ª', status: 'å¹´é–“', team: 'æ„šç—´', ltv: 560000, upsell: 0 },
            { id: 'M055', name: 'å°æ—åƒæ³°', status: 'é€šå¸¸', team: 'æ„šç—´', ltv: 280000, upsell: 0 },
            { id: 'M056', name: 'å»£ç”°ä¸€æ•¬', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M057', name: 'éˆ´æœ¨æ™ºå¼˜', status: 'é€šå¸¸', team: 'è²ªæ¬²', ltv: 240000, upsell: 0 },
            { id: 'M058', name: 'å°å³¶å•“è¼”', status: 'é€šå¸¸', team: 'è²ªæ¬²', ltv: 200000, upsell: 0 },
            { id: 'M059', name: 'å°¾å´å‹‡å“‰', status: 'å¹´é–“', team: 'ç‹æš', ltv: 520000, upsell: 0 },
            { id: 'M060', name: 'ä½ã€…æœ¨é€', status: 'é€šå¸¸', team: 'ãªã—', ltv: 160000, upsell: 0 },
            { id: 'M061', name: 'å°æ—å’Œè²´', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M062', name: 'æ—¥é«˜æ‚ æ²³', status: 'é€šå¸¸', team: 'ç‹æš', ltv: 360000, upsell: 0 },
            { id: 'M063', name: 'å®‰ç”°æ»‰ä¸€', status: 'å¹´é–“', team: 'ç‹æš', ltv: 440000, upsell: 0 },
            { id: 'M064', name: 'æ±Ÿå£é”å®', status: 'å¹´é–“', team: 'æ„šç—´', ltv: 640000, upsell: 0 },
            { id: 'M065', name: 'æ±å‡ºæ•™è‹¥', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M066', name: 'å‡ºç”°ç«œä¹Ÿ', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M067', name: 'é•·ç”°ä¸€', status: 'é€šå¸¸', team: 'æ„šç—´', ltv: 400000, upsell: 0 },
            { id: 'M068', name: 'å¸‚æ©‹æ…å£«', status: 'å¹´é–“', team: 'ç‹æš', ltv: 680000, upsell: 0 },
            { id: 'M069', name: 'ä»Šäº•å¥ä»‹', status: 'é€šå¸¸', team: 'è²ªæ¬²', ltv: 480000, upsell: 0 },
            { id: 'M070', name: 'ä¸­è¥¿èˆªå¹³', status: 'é€šå¸¸', team: 'è²ªæ¬²', ltv: 320000, upsell: 0 },
            { id: 'M071', name: 'ç†Šè°·ç‘å¥ˆç¾', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M072', name: 'å†…é‡çœŸå­', status: 'é€šå¸¸', team: 'è²ªæ¬²', ltv: 240000, upsell: 0 },
            { id: 'M073', name: 'ç¨²å£çœŸè£•', status: 'å¹´é–“', team: 'ç‹æš', ltv: 720000, upsell: 0 },
            { id: 'M074', name: 'æ¸…ç”°å®‡å®™', status: 'é€šå¸¸', team: 'ãªã—', ltv: 200000, upsell: 0 },
            { id: 'M075', name: 'çŒªé‡å€«å“‰', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M076', name: 'æ¾å£å‹', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M077', name: 'ç¯ å´å¼˜å¤š', status: 'é€šå¸¸', team: 'ç‹æš', ltv: 280000, upsell: 0 },
            { id: 'M078', name: 'å¸‚æ‘æ™º', status: 'å¹´é–“', team: 'æ„šç—´', ltv: 760000, upsell: 0 },
            { id: 'M079', name: 'ä»Šé‡å¤§è¼”', status: 'å¹´é–“', team: 'è²ªæ¬²', ltv: 800000, upsell: 0 },
            { id: 'M080', name: 'å±±ç¸£èª äºŒ', status: 'é€šå¸¸', team: 'æ„šç—´', ltv: 360000, upsell: 0 },
            { id: 'M081', name: 'å·¾å´ç”±ç´€å­', status: 'é€šå¸¸', team: 'ç‹æš', ltv: 440000, upsell: 0 },
            { id: 'M082', name: 'ç±¾å±±éŠ€æ²³', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M083', name: 'å‚è©°å®£äºº', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M084', name: 'å‚ä¹‹ä¸Šé¢¯äºº', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M085', name: 'æ°å®¶å¨å¹', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M086', name: 'é»’æŸ³æœ±éŸ³', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M087', name: 'å›½å®‰ã‚ãšã¿', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M088', name: 'è¥¿å³¶é¢¯äºº', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M089', name: 'é˜ªæœ¬å·³ç–ä¹Ÿ', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M090', name: 'å‚æœ¬ç ”å¤ªæœ—', status: 'é€šå¸¸', team: 'ãªã—', ltv: 520000, upsell: 0 },
            { id: 'M091', name: 'è—¤äº•å¾¹', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M092', name: 'å‰å²¡ä½‘å¼¥', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M093', name: 'ä½è—¤æ­å¹³', status: 'é€šå¸¸', team: 'ãªã—', ltv: 560000, upsell: 0 },
            { id: 'M094', name: 'å°æ¸•æ¡ƒå­', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M095', name: 'å‰æ¾¤å¹¸ä¸€', status: 'é€šå¸¸', team: 'ãªã—', ltv: 600000, upsell: 0 },
            { id: 'M096', name: 'æ£®å²¡è£•ä¹‹', status: 'å¹´é–“', team: 'è²ªæ¬²', ltv: 640000, upsell: 0 },
            { id: 'M097', name: 'é è—¤ç‘›å¤ª', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M098', name: 'äº€äº•æ‚ ', status: 'å¹´é–“', team: 'ãªã—', ltv: 680000, upsell: 0 },
            { id: 'M099', name: 'ä¼Šè—¤è‹±å“‰', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M100', name: 'å°æ‰æ²™é‡Œè¡£', status: 'é€šå¸¸', team: 'ãªã—', ltv: 720000, upsell: 0 },
            { id: 'M101', name: 'è–„ç”°äº¬', status: 'å¹´é–“', team: 'è²ªæ¬²', ltv: 760000, upsell: 0 },
            { id: 'M102', name: 'æ·ºæ²¼ä½³é‚£å­', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M103', name: 'å±±ç”°å¤§å°†', status: 'å¹´é–“', team: 'ç‹æš', ltv: 800000, upsell: 0 },
            { id: 'M104', name: 'æ°¸é‡ç¦ä¸‰', status: 'é€šå¸¸', team: 'ç‹æš', ltv: 840000, upsell: 0 },
            { id: 'M105', name: 'ä¸­æ ¹æ»‰ä»‹', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M106', name: 'å±±ç”°å‰›', status: 'é€šå¸¸', team: 'ãªã—', ltv: 880000, upsell: 0 },
            { id: 'M107', name: 'ç”°åŸç’ƒéŸ³', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M108', name: 'æ·ºåˆ©å‹‡æ–—', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M109', name: 'ç‰‡å±±è£•å­', status: 'å¹´é–“', team: 'è²ªæ¬²', ltv: 920000, upsell: 0 },
            { id: 'M110', name: 'æ°´æ—éº»é‡Œæµ', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M111', name: 'å…«æœ¨', status: 'é€€ä¼š', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M112', name: 'æ¦æœ¬çŸ¥ä½³', status: 'é€šå¸¸', team: 'ç‹æš', ltv: 960000, upsell: 0 },
            { id: 'M113', name: 'ç• ç”°ã¯ãª', status: 'é€šå¸¸', team: 'è²ªæ¬²', ltv: 1000000, upsell: 0 },
            { id: 'M114', name: 'ä¸Šæ‘å¾¹é›„', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M115', name: 'æ¸¡é‚‰æ•¦å­', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M116', name: 'ä¸æ˜', status: 'é€šå¸¸', team: 'ãªã—', ltv: 1040000, upsell: 0 },
            { id: 'M117', name: 'ä¼Šè—¤å¥è¡£', status: 'é€šå¸¸', team: 'æ„šç—´', ltv: 1080000, upsell: 0 },
            { id: 'M118', name: 'ç‰‡æ¡ç­', status: 'é€šå¸¸', team: 'ãªã—', ltv: 1120000, upsell: 0 },
            { id: 'M119', name: 'æ¸•ä¸Šå“²æ±°', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M120', name: 'ä»Šæ³‰', status: 'é€šå¸¸', team: 'ç‹æš', ltv: 1160000, upsell: 0 },
            { id: 'M121', name: 'å®®å´å¼˜ç™»', status: 'é€šå¸¸', team: 'è²ªæ¬²', ltv: 220000, upsell: 0 },
            { id: 'M122', name: 'è¥¿å³¶é¢¯äºº', status: 'ä½“é¨“çµ‚äº†', team: 'æœªè¨­å®š', ltv: 60000, upsell: 0 },
            { id: 'M123', name: 'äº•æ²¼ã•ã¨ã¿', status: 'ä½“é¨“ä¸­', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M124', name: 'ä¸æ˜', status: 'ä½“é¨“ä¸­', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M125', name: 'ä¸æ˜', status: 'ä½“é¨“ä¸­', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M126', name: 'ä¸æ˜', status: 'ä½“é¨“ä¸­', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M127', name: 'å—ä½³å­', status: 'ä½“é¨“ä¸­', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 },
            { id: 'M128', name: 'ã‚†ã¤', status: 'ä½“é¨“ä¸­', team: 'æœªè¨­å®š', ltv: 30000, upsell: 0 }
                ];
                
                filteredMembers = [...members];
                return false;
            }
        }

        // çµ±è¨ˆã®è¨ˆç®—ãƒ»æ›´æ–°
        function updateStats() {
            const total = filteredMembers.length;
            const annual = filteredMembers.filter(m => m.status === 'å¹´é–“').length;
            const regular = filteredMembers.filter(m => m.status === 'é€šå¸¸').length;
            const trial = filteredMembers.filter(m => m.status === 'ä½“é¨“ä¸­').length;
            const trialEnded = filteredMembers.filter(m => m.status === 'ä½“é¨“çµ‚äº†').length;
            const churned = filteredMembers.filter(m => m.status === 'é€€ä¼š').length;
            
            const activeLTV = filteredMembers
                .filter(m => m.status === 'å¹´é–“' || m.status === 'é€šå¸¸')
                .reduce((sum, m) => sum + m.ltv, 0);

            // ãƒãƒ¼ãƒ çµ±è¨ˆ
            const greedCount = filteredMembers.filter(m => m.team === 'è²ªæ¬²').length;
            const angerCount = filteredMembers.filter(m => m.team === 'ç‹æš').length;
            const ignoranceCount = filteredMembers.filter(m => m.team === 'æ„šç—´').length;
            const noTeamCount = filteredMembers.filter(m => m.team === 'ãªã—').length;
            const unassignedCount = filteredMembers.filter(m => m.team === 'æœªè¨­å®š').length;

            // çµ±è¨ˆè¡¨ç¤ºæ›´æ–°
            document.getElementById('total-members').textContent = total;
            document.getElementById('annual-members').textContent = annual;
            document.getElementById('regular-members').textContent = regular;
            document.getElementById('trial-members').textContent = trial;
            document.getElementById('trial-ended').textContent = trialEnded;
            document.getElementById('churned').textContent = churned;
            document.getElementById('active-ltv').textContent = `Â¥${(activeLTV / 1000000).toFixed(1)}M`;

            // ãƒãƒ¼ãƒ çµ±è¨ˆæ›´æ–°
            document.getElementById('greed-count').textContent = greedCount;
            document.getElementById('anger-count').textContent = angerCount;
            document.getElementById('ignorance-count').textContent = ignoranceCount;
            document.getElementById('no-team-count').textContent = noTeamCount;
            document.getElementById('unassigned-count').textContent = unassignedCount;

            console.log('çµ±è¨ˆæ›´æ–°:', {total, annual, regular, activeLTV: (activeLTV/1000000).toFixed(1)+'M'});
        }



        // ãƒ¡ãƒ³ãƒãƒ¼ä¸€è¦§ã®è¡¨ç¤º
        function renderMembers() {
            console.log('ãƒ¡ãƒ³ãƒãƒ¼è¡¨ç¤º:', filteredMembers.length, 'å');
            const grid = document.getElementById('memberGrid');
            const html = filteredMembers.map((member, index) => createMemberCard(member, index)).join('');
            grid.innerHTML = html;
            
            // ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ˜ãƒƒãƒ€ãƒ¼ã®è¡¨ç¤º/éè¡¨ç¤ºåˆ¶å¾¡
            const sortBy = document.getElementById('sortBy').value;
            const showRank = sortBy.includes('ltv') || sortBy.includes('upsell');
            const rankHeader = document.getElementById('rankHeader');
            const memberHeader = document.querySelector('.member-header');
            
            rankHeader.style.display = showRank ? 'block' : 'none';
            
            // ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®èª¿æ•´
            if (showRank) {
                memberHeader.classList.add('with-rank');
            } else {
                memberHeader.classList.remove('with-rank');
            }
            
            // ãƒ¡ãƒ³ãƒãƒ¼ã‚¢ã‚¤ãƒ†ãƒ ã®ã‚¯ãƒ©ã‚¹ã¯createCardã§å‡¦ç†ã•ã‚Œã‚‹ãŸã‚å‰Šé™¤
        }

        // ã‚½ãƒ¼ãƒˆæ©Ÿèƒ½
        function sortMembers() {
            const sortBy = document.getElementById('sortBy').value;
            
            filteredMembers.sort((a, b) => {
                switch (sortBy) {
                    case 'id':
                        return a.id.localeCompare(b.id);
                    case 'name':
                        return a.name.localeCompare(b.name, 'ja');
                    case 'ltv-high':
                        return b.ltv - a.ltv;
                    case 'ltv-low':
                        return a.ltv - b.ltv;
                    case 'total-ltv-high':
                        return (b.ltv + b.upsell) - (a.ltv + a.upsell);
                    case 'total-ltv-low':
                        return (a.ltv + a.upsell) - (b.ltv + b.upsell);
                    case 'upsell-high':
                        return b.upsell - a.upsell;
                    default:
                        return a.id.localeCompare(b.id);
                }
            });

            renderMembers();
        }

        // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
        function filterMembers() {
            const searchTerm = document.getElementById('searchBox').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            const teamFilter = document.getElementById('teamFilter').value;

            filteredMembers = members.filter(member => {
                const matchesSearch = member.name.toLowerCase().includes(searchTerm);
                const matchesStatus = !statusFilter || member.status === statusFilter;
                const matchesTeam = !teamFilter || member.team === teamFilter;
                const matchesActiveFilter = !showActiveOnly || (member.status === 'å¹´é–“' || member.status === 'é€šå¸¸');

                return matchesSearch && matchesStatus && matchesTeam && matchesActiveFilter;
            });

            sortMembers(); // ãƒ•ã‚£ãƒ«ã‚¿å¾Œã«ã‚½ãƒ¼ãƒˆ
            updateStats();
        }

        // ç¾å½¹ä¼šå“¡ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼åˆ‡ã‚Šæ›¿ãˆ
        function toggleActiveOnly() {
            showActiveOnly = !showActiveOnly;
            const btn = document.getElementById('activeOnlyBtn');
            
            if (showActiveOnly) {
                btn.style.background = '#dc3545';
                btn.textContent = 'ğŸš« å…¨å“¡è¡¨ç¤º';
            } else {
                btn.style.background = '#28a745';
                btn.textContent = 'ğŸ‘¥ ç¾å½¹ä¼šå“¡ã®ã¿';
            }
            
            filterMembers();
        }

        // LTVãƒ©ãƒ³ã‚­ãƒ³ã‚°è¡¨ç¤º
        function showLTVRanking() {
            // ç¾å½¹ä¼šå“¡ã®ã¿ã«çµã‚Šè¾¼ã¿
            showActiveOnly = true;
            const activeBtn = document.getElementById('activeOnlyBtn');
            activeBtn.style.background = '#dc3545';
            activeBtn.textContent = 'ğŸš« å…¨å“¡è¡¨ç¤º';
            
            // ç·LTVé«˜ã„é †ã§ã‚½ãƒ¼ãƒˆ
            document.getElementById('sortBy').value = 'total-ltv-high';
            
            // ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ†ã‚­ã‚¹ãƒˆã‚’å¤‰æ›´
            const rankHeader = document.getElementById('rankHeader');
            rankHeader.textContent = 'ğŸ† é †ä½';
            
            filterMembers();
            
            // ãƒ©ãƒ³ã‚­ãƒ³ã‚°è¡¨ç¤ºãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
            setTimeout(() => {
                alert('ğŸ† LTVãƒ©ãƒ³ã‚­ãƒ³ã‚°è¡¨ç¤º\n\nç¾å½¹ä¼šå“¡ã‚’ç·LTVé«˜ã„é †ã§è¡¨ç¤ºã—ã¦ã„ã¾ã™ã€‚\nã€Œä¸¦ã³é †ã€ã§ä»–ã®é †åºã‚‚é¸æŠã§ãã¾ã™ã€‚');
            }, 100);
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š
        function setupEventListeners() {
            document.getElementById('searchBox').addEventListener('input', filterMembers);
            document.getElementById('statusFilter').addEventListener('change', filterMembers);
            document.getElementById('teamFilter').addEventListener('change', filterMembers);
            document.getElementById('sortBy').addEventListener('change', sortMembers);
            document.getElementById('activeOnlyBtn').addEventListener('click', toggleActiveOnly);
            document.getElementById('ltvRankingBtn').addEventListener('click', showLTVRanking);
        }

        // ãƒ¡ãƒ³ãƒãƒ¼è©³ç´°ãƒšãƒ¼ã‚¸ã‚’é–‹ã
        function openMemberDetail(memberId) {
            const member = members.find(m => m.id === memberId);
            if (member) {
                // ãƒ¡ãƒ³ãƒãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’localStorageã«ä¿å­˜
                localStorage.setItem(`member_${memberId}`, JSON.stringify(member));
                
                // è©³ç´°ãƒšãƒ¼ã‚¸ã«é·ç§»
                window.open(`member_detail.html?id=${memberId}`, '_blank');
            }
        }

        // ãƒ¡ãƒ³ãƒãƒ¼ã‚«ãƒ¼ãƒ‰ã«ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿½åŠ 
        function createMemberCard(member, index) {
            const totalLTV = member.ltv + member.upsell;
            const upsellText = member.upsell > 0 ? `Â¥${member.upsell.toLocaleString()}` : '-';
            const fadedClass = (member.status === 'é€€ä¼š' || member.status === 'ä½“é¨“çµ‚äº†') ? 'faded' : '';
            
            const sortBy = document.getElementById('sortBy').value;
            const showRank = sortBy.includes('ltv') || sortBy.includes('upsell');
            const withRankClass = showRank ? 'with-rank' : '';
            const rankDisplay = showRank ? `<div class="rank-number">${index + 1}</div>` : '';
            
            return `
                <div class="member-item ${fadedClass} ${withRankClass}" onclick="openMemberDetail('${member.id}')" style="cursor: pointer;">
                    ${rankDisplay}
                    <div>${member.id}</div>
                    <div>${member.name}</div>
                    <div class="status-${member.status}">${member.status}</div>
                    <div><span class="team-display team-${member.team}">${member.team}</span></div>
                    <div>Â¥${member.ltv.toLocaleString()}</div>
                    <div>${upsellText}</div>
                    <div>Â¥${totalLTV.toLocaleString()}</div>
                </div>
            `;
        }

        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('ãƒšãƒ¼ã‚¸åˆæœŸåŒ–é–‹å§‹');
            
            // CSVãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
            await loadMembersFromCSV();
            
            renderMembers();
            updateStats();
            setupEventListeners();
            console.log('ãƒšãƒ¼ã‚¸åˆæœŸåŒ–å®Œäº†');
        });

        console.log('JavaScriptèª­ã¿è¾¼ã¿å®Œäº†');
    </script>
</body>
</html>
