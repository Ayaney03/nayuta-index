// 通常会員入会日（サブスク開始日）マッピングデータ
const regularJoinDatesMapping = [
    '', // 藤澤秀彰 - 空欄
    '2024-01-24', // 鈴木裕介
    '2024-02-26', // 福井康大
    '2024-01-26', // 俵健太郎
    '', // 進藤勇輝 - 空欄
    '2024-02-04', // 佐藤諒駿
    '2024-01-25', // 杉平涼
    '2024-01-26', // 松本和久
    '2024-01-26', // 松田陽平
    '2024-02-29', // 井上純也
    '2024-01-25', // 根塚陽己
    '', // 藤原綜太郎 - 空欄
    '2024-02-13', // 石島秀峰
    '2024-01-25', // 佐藤亜美
    '2024-01-25', // 塚本真伍
    '', '', // 湊翔太郎、鈴木菜摘 - 空欄x2
    '2024-01-25', // 松島徹
    '', // 粟津律子 - 空欄
    '2024-01-29', // 榎本高也
    '2024-01-30', // 石垣吉規
    '2024-01-31', // ブル
    '2024-01-31', // 鈴木康太
    '2024-01-31', // 奥村拓哉
    '2024-02-01', // 池本湊了汰
    '', '', '', // 松本竜季、西島颯人、山縣誠二 - 空欄x3
    '2024-02-01', // 綿貫桂太
    '', // 清水暁 - 空欄
    '2024-02-28', // 中村意央里
    '', '', // 島守勇次、千吉良俊充 - 空欄x2
    '2024-05-15', // 岩下未誉子
    '', // 安田滉一 - 空欄
    '2024-06-18', // 真木智之
    '', '', '', // 吉嵜俊一郎、今井一真、平野理絵 - 空欄x3
    '2024-07-01', // 内田泰文
    '', '', '', // 増田凌一、新保友望奈、市川佳奈 - 空欄x3
    '2024-06-24', // 渡邉智大
    '', // 泉田祐輝 - 空欄
    '2024-11-08', // 永井克幸
    '', '', '', // 茂木一幸、松田圭右、松村遼河 - 空欄x3
    '2024-05-18', // 平岩遼志
    '2024-05-24', // 佐藤一気
    '2024-06-03', // 照井紀臣
    '2024-06-14', // 坂詰宣人
    '2024-07-23', // 中悠太
    '2024-08-22', // 小林千泰
    '2024-09-07', // 廣田一敬
    '2024-10-27', // 鈴木智弘
    '2024-10-02', // 小島啓輔
    '', '', // 尾崎勇哉、佐々木透 - 空欄x2
    '2024-10-24', // 小林和貴
    '', // 日高悠河 - 空欄
    '2024-10-24', // 江口達宏
    '2024-10-24', // 東出教若
    '2024-11-28', // 出田竜也
    '2024-10-24', // 長田一
    '', // 市橋慎士 - 空欄
    '2024-10-25', // 今井奎介
    '2024-10-26', // 中西航平
    '', // 熊谷瑞奈美 - 空欄
    '2024-10-25', // 内野真子
    '', // 稲垣真裕 - 空欄
    '2024-11-26', // 清田宇宙
    '2024-10-26', // 猪野倫哉
    '2024-10-26', // 松垣友
    '2024-10-26', // 篠崎弘多
    '', '', // 市村智、今野大輔 - 空欄x2
    '2024-11-19', // 巾崎由紀子
    '', '', '', // 籾山銀河、坂詰宣人、坂之上颯人 - 空欄x3
    '2024-11-12', // 氏家威吹
    '', '', // 黒柳朱音、国安あずみ - 空欄x2
    '2024-10-26', // 阪本巳玖也
    '2024-11-02', // 坂本研太朗
    '2024-10-29', // 藤井徹
    '', // 吉岡佑弥 - 空欄
    '2024-11-19', // 佐藤恭平
    '2025-01-16', // 小渕桃子
    '2025-02-15', // 吉澤幸一
    '2025-01-17', // 森岡裕之
    '2025-01-18', // 遠藤瑛太
    '2025-01-19', // 亀井悠
    '2025-01-19', // 伊藤英哉
    '2025-02-28', // 小杉沙里衣
    '2025-01-20', // 薄田京
    '2025-01-21', // 淺沼佳那子
    '2025-01-21', // 山田大将
    '2025-01-21', // 永野福三
    '2025-01-21', // 中根滉介
    '2025-01-22', // 山田剛
    '2025-01-21', // 田原璃音
    '2025-01-21', // 淺利勇斗
    '2025-01-28', // 片山裕子
    '', '', // 水林麻里恵、榎本知佳 - 空欄x2
    '2025-02-15', // 畠田はな
    '2025-05-02', // 上村徹雄
    '2025-05-28', // 渡邊敦子
    '', // 不明 - 空欄
    '2025-06-05', // 伊藤奏衣
    '', // 片桐瞭 - 空欄
    '', // 渕上哲汰 - 空欄
    '', // 今泉 - 空欄
    '', // 宮崎弘登 - 空欄
    '' // 西島颯人（重複） - 空欄
];

// メンバーデータベースに通常会員入会日を追加する関数
function updateMembersWithRegularJoinDates(membersDatabase) {
    return membersDatabase.map((member, index) => {
        const regularJoinDate = regularJoinDatesMapping[index];
        
        // サブスク期間の計算（通常会員入会日から現在まで）
        let subscriptionMonths = null;
        if (regularJoinDate) {
            const startDate = new Date(regularJoinDate);
            const currentDate = new Date();
            const monthDiff = (currentDate.getFullYear() - startDate.getFullYear()) * 12 + 
                             (currentDate.getMonth() - startDate.getMonth());
            subscriptionMonths = Math.max(0, monthDiff);
        }

        // 体験から正式入会までの日数
        let trialToPaidDays = null;
        if (member.trialJoinDate && regularJoinDate) {
            const trialDate = new Date(member.trialJoinDate);
            const paidDate = new Date(regularJoinDate);
            trialToPaidDays = Math.ceil((paidDate - trialDate) / (1000 * 60 * 60 * 24));
        }

        return {
            ...member,
            regularJoinDate: regularJoinDate || '', // サブスク開始日
            subscriptionMonths: subscriptionMonths, // サブスク継続月数
            trialToPaidDays: trialToPaidDays, // 体験から正式入会までの日数
            // LTVの再計算（サブスク期間ベース）
            monthlyValue: subscriptionMonths > 0 ? Math.round(member.ltv / subscriptionMonths) : 0
        };
    });
}

console.log('Regular join dates mapping loaded. Use updateMembersWithRegularJoinDates() to apply.');
