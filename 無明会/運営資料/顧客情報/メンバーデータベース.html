<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÁÑ°Êòé‰ºö „É°„É≥„Éê„Éº„Éá„Éº„Çø„Éô„Éº„Çπ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hiragino Kaku Gothic ProN', 'Yu Gothic', 'Meiryo', sans-serif;
            background: linear-gradient(135deg, #f8f6f3 0%, #fff8dc 50%, #f5e6a3 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 1.8em;
            margin-bottom: 10px;
        }

        .controls {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 0.9em;
        }

        .filter-select {
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            background: white;
            font-size: 0.9em;
        }

        .stats-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 6px;
            text-align: center;
            border: 1px solid #e9ecef;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.85em;
            color: #6c757d;
        }

        .member-grid {
            background: white;
            border-radius: 8px;
            margin: 20px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .member-list-header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 8px 15px;
            display: grid;
            grid-template-columns: 50px 140px 100px 80px 100px 100px 120px;
            gap: 8px;
            font-weight: bold;
            font-size: 0.75em;
            text-align: center;
        }

        .member-list-item {
            display: grid;
            grid-template-columns: 50px 140px 100px 80px 100px 100px 120px;
            gap: 8px;
            padding: 6px 15px;
            border-bottom: 1px solid #e9ecef;
            cursor: pointer;
            transition: background-color 0.2s;
            font-size: 0.7em;
            align-items: center;
        }

        .member-list-item:hover {
            background-color: #f8f9fa;
        }

        .member-list-item:last-child {
            border-bottom: none;
        }

        .member-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .member-name {
            font-weight: 500;
            color: #333;
        }

        .member-id {
            font-size: 0.7em;
            color: #666;
            background: #f8f9fa;
            padding: 2px 4px;
            border-radius: 3px;
            text-align: center;
        }

        .member-team {
            font-size: 0.7em;
            padding: 2px 4px;
            border-radius: 3px;
            text-align: center;
            font-weight: 500;
        }

        .team-Ë≤™Ê¨≤ { 
            background: #fff9c4; 
            color: #795548; 
            border: 1px solid #ffeb3b; 
        }
        
        .team-ÁûãÊÅö { 
            background: #ffebee; 
            color: #b71c1c; 
            border: 1px solid #f44336; 
        }
        
        .team-ÊÑöÁó¥ { 
            background: #e8f5e8; 
            color: #2e7d32; 
            border: 1px solid #4caf50; 
        }
        
        .team-„Å™„Åó { 
            background: #e9ecef; 
            color: #6c757d; 
            border: 1px solid #6c757d; 
        }
        
        .team-Êú™Ë®≠ÂÆö { 
            background: #fff; 
            color: #999; 
            border: 1px solid #dee2e6; 
        }

        .join-date {
            font-size: 0.7em;
            color: #666;
            text-align: center;
        }

        .last-active {
            font-size: 0.7em;
            color: #666;
            text-align: center;
        }

        .member-status {
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 0.7em;
            font-weight: bold;
            text-align: center;
        }

        .status-Âπ¥Èñì, .status-ÈÄöÂ∏∏ {
            background: #f8f9fa;
            color: #495057;
            border: 1px solid #dee2e6;
        }

        .status-‰ΩìÈ®ìÁµÇ‰∫Ü, .status-ÈÄÄ‰ºö {
            background: #495057;
            color: #fff;
            border: 1px solid #343a40;
        }

        .status-‰∏çÊòé {
            background: #e9ecef;
            color: #6c757d;
            border: 1px solid #6c757d;
        }

        .member-details {
            font-size: 0.85em;
            line-height: 1.5;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .detail-label {
            color: #6c757d;
        }

        .detail-value {
            font-weight: 500;
            color: #2c3e50;
        }

        .ltv-display {
            text-align: right;
            font-weight: 600;
            color: #1976d2;
            font-size: 0.7em;
        }

        .upsale-display {
            text-align: center;
            font-size: 0.65em;
            color: #e91e63;
            font-weight: 500;
        }

        .total-ltv-display {
            text-align: right;
            font-weight: bold;
            color: #2e7d32;
            font-size: 0.75em;
            margin-top: 10px;
            font-size: 0.9em;
        }

        .add-member-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #d4af37;
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 1.5em;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.4);
            transition: all 0.3s ease;
        }

        .add-member-btn:hover {
            transform: scale(1.1);
            background: #b8860b;
        }

        .hidden {
            display: none;
        }

        .highlight {
            background-color: yellow;
            font-weight: bold;
        }

        /* Êõ¥Êñ∞ÊúüÈôê„Ç¢„É©„Éº„ÉàËâ≤ */
        .renewal-overdue { 
            background: #dc3545 !important; 
            color: white !important; 
        }
        
        .renewal-soon { 
            background: #fd7e14 !important; 
            color: white !important; 
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- „Éò„ÉÉ„ÉÄ„Éº & Áµ±Ë®à„Ç®„É™„Ç¢Ôºà2„Ç´„É©„É†Ôºâ -->
        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 20px; margin: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 12px; color: white;">
            <!-- Â∑¶„Ç´„É©„É†Ôºö„Çø„Ç§„Éà„É´ -->
            <div>
                <h1 style="font-size: 1.8em; margin: 0 0 8px 0;">üë• ÁÑ°Êòé‰ºö</h1>
                <h2 style="font-size: 1.2em; margin: 0 0 12px 0; opacity: 0.9;">„É°„É≥„Éê„Éº„Éá„Éº„Çø„Éô„Éº„Çπ</h2>
                <p style="margin: 0; opacity: 0.8; font-size: 0.9em;">„É°„É≥„Éê„ÉºÁÆ°ÁêÜ„ÉªLTVÂàÜÊûê„Ç∑„Çπ„ÉÜ„É†</p>
            </div>
            
            <!-- Âè≥„Ç´„É©„É†ÔºöÁµ±Ë®à -->
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
                <div style="background: rgba(255,255,255,0.15); padding: 12px; border-radius: 8px; text-align: center; backdrop-filter: blur(10px);">
                    <div style="font-size: 1.4em; font-weight: bold;" id="total-members">110</div>
                    <div style="font-size: 0.75em; opacity: 0.9;">üë• Á∑è„É°„É≥„Éê„Éº</div>
                </div>
                <div style="background: rgba(255,255,255,0.15); padding: 12px; border-radius: 8px; text-align: center; backdrop-filter: blur(10px);">
                    <div style="font-size: 1.4em; font-weight: bold;" id="annual-members">0</div>
                    <div style="font-size: 0.75em; opacity: 0.9;">üíé Âπ¥Èñì‰ºöÂì°</div>
                </div>
                <div style="background: rgba(255,255,255,0.15); padding: 12px; border-radius: 8px; text-align: center; backdrop-filter: blur(10px);">
                    <div style="font-size: 1.4em; font-weight: bold;" id="regular-members">0</div>
                    <div style="font-size: 0.75em; opacity: 0.9;">‚≠ê ÈÄöÂ∏∏‰ºöÂì°</div>
                </div>
                <div style="background: rgba(255,255,255,0.15); padding: 12px; border-radius: 8px; text-align: center; backdrop-filter: blur(10px);">
                    <div style="font-size: 1.4em; font-weight: bold;" id="trial-ended-members">0</div>
                    <div style="font-size: 0.75em; opacity: 0.9;">‚è∞ ‰ΩìÈ®ìÁµÇ‰∫Ü</div>
                </div>
                <div style="background: rgba(255,255,255,0.15); padding: 12px; border-radius: 8px; text-align: center; backdrop-filter: blur(10px);">
                    <div style="font-size: 1.4em; font-weight: bold;" id="churned-members">0</div>
                    <div style="font-size: 0.75em; opacity: 0.9;">‚ùå ÈÄÄ‰ºö</div>
                </div>
                <div style="background: rgba(255,255,255,0.15); padding: 12px; border-radius: 8px; text-align: center; backdrop-filter: blur(10px);">
                    <div style="font-size: 1.4em; font-weight: bold;" id="active-ltv">¬•0M</div>
                    <div style="font-size: 0.75em; opacity: 0.9;">üí∞ ÁèæÂΩπLTV</div>
                </div>
            </div>
        </div>

        <!-- üí∞ Â£≤‰∏ä„ÉªÊõ¥Êñ∞‰∫àÂÆö -->
        <div style="background: #fff3e0; padding: 12px; margin: 15px 20px; border-radius: 8px; border-left: 4px solid #ff9800;">
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; font-size: 0.8em;">
                <div style="background: white; padding: 8px; border-radius: 4px; text-align: center;">
                    <div style="font-weight: bold; color: #007bff; font-size: 1em;" id="this-month-count">0</div>
                    <div style="font-size: 0.75em;">üìÖ ‰ªäÊúàÊõ¥Êñ∞‰∫àÂÆö</div>
                </div>
                <div style="background: white; padding: 8px; border-radius: 4px; text-align: center;">
                    <div style="font-weight: bold; color: #ffc107; font-size: 1em;" id="next-month-count">0</div>
                    <div style="font-size: 0.75em;">üìÖ Êù•ÊúàÊõ¥Êñ∞‰∫àÂÆö</div>
                </div>
                <div style="background: white; padding: 8px; border-radius: 4px; text-align: center;">
                    <div style="font-weight: bold; color: #28a745; font-size: 1em;" id="this-month-revenue">¬•0</div>
                    <div style="font-size: 0.75em;">üí∞ ‰ªäÊúàÂ£≤‰∏ä‰∫àÂÆö</div>
                </div>
                <div style="background: white; padding: 8px; border-radius: 4px; text-align: center;">
                    <div style="font-weight: bold; color: #17a2b8; font-size: 1em;" id="next-month-revenue">¬•0</div>
                    <div style="font-size: 0.75em;">üí∏ Êù•ÊúàÂ£≤‰∏äË¶ãËæº„Åø</div>
                </div>
            </div>
        </div>

        <!-- üìà „É°„É≥„Éê„ÉºÊï∞Êé®Áßª -->
        <div style="background: #e8f5e8; padding: 12px; margin: 15px 20px; border-radius: 8px; border-left: 4px solid #28a745;">
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; font-size: 0.8em;">
                <div style="background: white; padding: 8px; border-radius: 4px; text-align: center;">
                    <div style="font-weight: bold; color: #007bff; font-size: 1em;" id="current-active-members">0</div>
                    <div style="font-size: 0.75em;">üë• ÁèæÂΩπ‰ºöÂì°Êï∞</div>
                </div>
                <div style="background: white; padding: 8px; border-radius: 4px; text-align: center;">
                    <div style="font-weight: bold; color: #28a745; font-size: 1em;" id="monthly-growth">+0</div>
                    <div style="font-size: 0.75em;">üìä ÂâçÊúàÊØîÂ¢óÊ∏õ</div>
                </div>
                <div style="background: white; padding: 8px; border-radius: 4px; text-align: center;">
                    <div style="font-weight: bold; color: #17a2b8; font-size: 1em;" id="yearly-growth">+0</div>
                    <div style="font-size: 0.75em;">üìà ÂâçÂπ¥ÂêåÊúàÊØî</div>
                </div>
                <div style="background: white; padding: 8px; border-radius: 4px; text-align: center;">
                    <div style="font-weight: bold; color: #6f42c1; font-size: 1em;" id="growth-rate">0%</div>
                    <div style="font-size: 0.75em;">üìç ÊúàÈñìÊàêÈï∑Áéá</div>
                </div>
            </div>
        </div>

        <!-- ‰∏âÊØí„ÉÅ„Éº„É†Áµ±Ë®à -->
        <div style="background: #f8f9fa; padding: 15px; margin: 15px 20px; border-radius: 8px; border-left: 4px solid #6f42c1;">
            <h3 style="color: #6f42c1; margin-bottom: 10px; font-size: 1em;">üîÆ ‰∏âÊØí„ÉÅ„Éº„É†ÂàÜÂ∏É</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; font-size: 0.85em;">
                <div style="background: #fff3cd; padding: 8px; border-radius: 4px; text-align: center; border: 2px solid #ffc107;">
                    <div style="font-weight: bold; color: #856404;" id="greed-count">0</div>
                    <div>Ë≤™Ê¨≤„ÉÅ„Éº„É†</div>
                </div>
                <div style="background: #f8d7da; padding: 8px; border-radius: 4px; text-align: center; border: 2px solid #dc3545;">
                    <div style="font-weight: bold; color: #721c24;" id="anger-count">0</div>
                    <div>ÁûãÊÅö„ÉÅ„Éº„É†</div>
                </div>
                <div style="background: #d4edda; padding: 8px; border-radius: 4px; text-align: center; border: 2px solid #28a745;">
                    <div style="font-weight: bold; color: #155724;" id="ignorance-count">0</div>
                    <div>ÊÑöÁó¥„ÉÅ„Éº„É†</div>
                </div>
                <div style="background: #e9ecef; padding: 8px; border-radius: 4px; text-align: center; border: 2px solid #6c757d;">
                    <div style="font-weight: bold; color: #6c757d;" id="no-team-count">0</div>
                    <div>Êú™ÊâÄÂ±û</div>
                </div>
                <div style="background: white; padding: 8px; border-radius: 4px; text-align: center; border: 2px solid #dee2e6;">
                    <div style="font-weight: bold; color: #999;" id="unassigned-count">0</div>
                    <div>Êú™Ë®≠ÂÆö</div>
                </div>
            </div>
        </div>

        <!-- Ê§úÁ¥¢„Éª„Éï„Ç£„É´„Çø„Éº -->
        <div class="controls">
            <input type="text" id="searchBox" class="search-box" placeholder="üîç „É°„É≥„Éê„ÉºÂêç„ÅßÊ§úÁ¥¢...">
            <select id="statusFilter" class="filter-select">
                <option value="">ÂÖ®„Çπ„ÉÜ„Éº„Çø„Çπ</option>
                <option value="Âπ¥Èñì">Âπ¥Èñì‰ºöÂì°</option>
                <option value="ÈÄöÂ∏∏">ÈÄöÂ∏∏‰ºöÂì°</option>
                <option value="‰ΩìÈ®ìÁµÇ‰∫Ü">‰ΩìÈ®ìÁµÇ‰∫Ü</option>
                <option value="ÈÄÄ‰ºö">ÈÄÄ‰ºö</option>
            </select>
            <select id="sortBy" class="filter-select">
                <option value="id">IDÈ†Ü</option>
                <option value="name">ÂêçÂâçÈ†ÜÔºà„ÅÇ„ÅÑ„ÅÜ„Åà„ÅäÔºâ</option>
                <option value="ltv">LTVÈ´ò„ÅÑÈ†Ü</option>
                <option value="ltvLow">LTV‰Ωé„ÅÑÈ†Ü</option>
                <option value="joinDate">ÂÖ•‰ºöÊó•È†Ü</option>
                <option value="subscription">„Çµ„Éñ„Çπ„ÇØÊúüÈñìÈï∑„ÅÑÈ†Ü</option>
                <option value="events">ÂèÇÂä†„Ç§„Éô„É≥„ÉàÂ§ö„ÅÑÈ†Ü</option>
            </select>
            <select id="teamFilter" class="filter-select">
                <option value="">ÂÖ®„ÉÅ„Éº„É†</option>
                <option value="Ë≤™Ê¨≤">Ë≤™Ê¨≤„ÉÅ„Éº„É†</option>
                <option value="ÁûãÊÅö">ÁûãÊÅö„ÉÅ„Éº„É†</option>
                <option value="ÊÑöÁó¥">ÊÑöÁó¥„ÉÅ„Éº„É†</option>
                <option value="„Å™„Åó">„ÉÅ„Éº„É†Êú™ÊâÄÂ±û</option>
            </select>
            <button id="rankingBtn" class="filter-select" style="background: #6f42c1; color: white; border: none; cursor: pointer;">üèÜ LTV„É©„É≥„Ç≠„É≥„Ç∞</button>
            <button id="activeOnlyBtn" class="filter-select" style="background: #28a745; color: white; border: none; cursor: pointer;">üë• ÁèæÂΩπ‰ºöÂì°„ÅÆ„Åø</button>
            <button id="renewalAlertBtn" class="filter-select" style="background: #ff6b35; color: white; border: none; cursor: pointer;">‚ö†Ô∏è Êõ¥Êñ∞ÈñìËøë</button>
        </div>

        <!-- „É°„É≥„Éê„Éº„ÉÜ„Éº„Éñ„É´ -->
        <div class="member-grid">
            <div class="member-list-header">
                <div>ID</div>
                <div>ÂêçÂâç</div>
                <div>„Çπ„ÉÜ„Éº„Çø„Çπ</div>
                <div>„ÉÅ„Éº„É†</div>
                <div>Âü∫Êú¨LTV</div>
                <div>„Ç¢„ÉÉ„Éó„Çª„É´</div>
                <div>Á∑èLTV</div>
            </div>
            <div id="memberGrid">
                <!-- „É°„É≥„Éê„Éº„É™„Çπ„Éà„Åå„Åì„Åì„Å´ÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„Åæ„Åô -->
            </div>
        </div>
    </div>

    <button class="add-member-btn" onclick="addNewMember()">+</button>

    <script src="three_poisons_team_mapping.js"></script>
    <script>
        // ÈÄöÂ∏∏‰ºöÂì°„Å´„Å™„Å£„ÅüÊó•ÔºàÊ≠£Ë¶èÊîØÊâï„ÅÑÈñãÂßãÊó•ÔºâÈÖçÂàóÔºàM001„Åã„ÇâÈ†ÜÁï™Ôºâ
        const regularJoinDateArray = [
            '', // M001 (ÈÄÄ‰ºö)
            '', // M002 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '2024-01-26', // M003 (Âπ¥Èñì)
            '2024-02-04', // M004 (Âπ¥Èñì)
            '2024-01-25', // M005 (ÈÄöÂ∏∏)
            '', // M006 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '2024-01-26', // M007 (ÈÄöÂ∏∏)
            '', // M008 (ÈÄÄ‰ºö)
            '2024-02-29', // M009 (ÈÄöÂ∏∏)
            '', // M010 (ÈÄÄ‰ºö)
            '', // M011 (ÈÄÄ‰ºö)
            '2024-01-25', // M012 (Âπ¥Èñì)
            '', // M013 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '2024-02-13', // M014 (Âπ¥Èñì)
            '', // M015 (ÈÄÄ‰ºö)
            '', // M016 (ÈÄÄ‰ºö)
            '', // M017 (ÈÄÄ‰ºö)
            '', // M018 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '', // M019 (ÈÄÄ‰ºö)
            '', // M020 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '2024-01-25', // M021 (ÈÄöÂ∏∏)
            '', // M022 (ÈÄÄ‰ºö)
            '2024-01-25', // M023 (Âπ¥Èñì)
            '2024-01-25', // M024 (ÈÄöÂ∏∏)
            '2024-01-29', // M025 (ÈÄöÂ∏∏)
            '2024-01-30', // M026 (Âπ¥Èñì)
            '', // M027 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '', // M028 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '', // M029 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '2024-01-31', // M030 (ÈÄöÂ∏∏)
            '', // M031 (ÈÄÄ‰ºö)
            '', // M032 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '2024-02-01', // M033 (ÈÄöÂ∏∏)
            '', // M034 (ÈÄÄ‰ºö)
            '', // M035 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '', // M036 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '', // M037 (ÈÄÄ‰ºö)
            '', // M038 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '', // M039 (ÈÄÄ‰ºö)
            '', // M040 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '', // M041 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '', // M042 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '', // M043 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '2024-02-01', // M044 (Âπ¥Èñì)
            '', // M045 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '', // M046 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '', // M047 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '', // M048 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '2024-02-28', // M049 (ÈÄöÂ∏∏)
            '', // M050 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '', // M051 (ÈÄÄ‰ºö)
            '', // M052 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '', // M053 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '2024-05-15', // M054 (Âπ¥Èñì)
            '2024-06-18', // M055 (ÈÄöÂ∏∏)
            '', // M056 (ÈÄÄ‰ºö)
            '2024-07-01', // M057 (ÈÄöÂ∏∏)
            '2024-06-24', // M058 (ÈÄöÂ∏∏)
            '2024-11-08', // M059 (Âπ¥Èñì)
            '2024-05-18', // M060 (ÈÄöÂ∏∏)
            '', // M061 (ÈÄÄ‰ºö)
            '2024-05-24', // M062 (ÈÄöÂ∏∏)
            '2024-06-03', // M063 (Âπ¥Èñì)
            '2024-06-14', // M064 (Âπ¥Èñì)
            '', // M065 (ÈÄÄ‰ºö)
            '', // M066 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '2024-07-23', // M067 (ÈÄöÂ∏∏)
            '2024-08-22', // M068 (Âπ¥Èñì)
            '2024-09-07', // M069 (ÈÄöÂ∏∏)
            '2024-10-27', // M070 (ÈÄöÂ∏∏)
            '', // M071 (ÈÄÄ‰ºö)
            '2024-10-02', // M072 (ÈÄöÂ∏∏)
            '2024-10-24', // M073 (Âπ¥Èñì)
            '2024-10-24', // M074 (ÈÄöÂ∏∏)
            '', // M075 (ÈÄÄ‰ºö)
            '', // M076 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '2024-10-24', // M077 (ÈÄöÂ∏∏)
            '2024-11-28', // M078 (Âπ¥Èñì)
            '2024-10-24', // M079 (Âπ¥Èñì)
            '2024-10-25', // M080 (ÈÄöÂ∏∏)
            '2024-10-26', // M081 (ÈÄöÂ∏∏)
            '', // M082 (ÈÄÄ‰ºö)
            '', // M083 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '', // M084 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '', // M085 (ÈÄÄ‰ºö)
            '', // M086 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '', // M087 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '', // M088 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '', // M089 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '2024-10-25', // M090 (ÈÄöÂ∏∏)
            '', // M091 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '', // M092 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '2024-11-26', // M093 (ÈÄöÂ∏∏)
            '', // M094 (ÈÄÄ‰ºö)
            '2024-10-26', // M095 (ÈÄöÂ∏∏)
            '2024-10-26', // M096 (Âπ¥Èñì)
            '', // M097 (ÈÄÄ‰ºö)
            '2024-10-26', // M098 (Âπ¥Èñì)
            '', // M099 (ÈÄÄ‰ºö)
            '2024-11-19', // M100 (ÈÄöÂ∏∏)
            '2024-11-12', // M101 (Âπ¥Èñì)
            '', // M102 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '2024-10-26', // M103 (Âπ¥Èñì)
            '2024-11-02', // M104 (ÈÄöÂ∏∏)
            '', // M105 (ÈÄÄ‰ºö)
            '2024-10-29', // M106 (ÈÄöÂ∏∏)
            '', // M107 (ÈÄÄ‰ºö)
            '', // M108 (ÈÄÄ‰ºö)
            '2024-11-19', // M109 (Âπ¥Èñì)
            '', // M110 (ÈÄÄ‰ºö)
            '', // M111 (ÈÄÄ‰ºö)
            '2025-01-16', // M112 (ÈÄöÂ∏∏)
            '2025-02-15', // M113 (ÈÄöÂ∏∏)
            '', // M114 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '', // M115 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '2025-01-17', // M116 (ÈÄöÂ∏∏)
            '2025-01-18', // M117 (ÈÄöÂ∏∏)
            '2025-01-19', // M118 (ÈÄöÂ∏∏)
            '', // M119 (‰ΩìÈ®ìÁµÇ‰∫Ü)
            '2025-01-19', // M120 (ÈÄöÂ∏∏)
            '2025-02-28' // M121 (ÈÄöÂ∏∏)
        ];

        // ÂæπÂ∫ïÁ≤æÈÄ≤Ë≥ºÂÖ•ËÄÖ„É™„Çπ„Éà
        const tesseiShinPurchasers = [
            'Ê∏°ÈÇâÊô∫Â§ß', 'ÊùæÊùëÈÅºÊ≤≥', '‰ΩêËó§‰∏ÄÊ∞ó', 'Â∞èÂ≥∂ÂïìËºî', 'ÂÜÖÈáéÁúüÂ≠ê',
            'Â∑æÂ¥éÁî±Á¥ÄÂ≠ê', 'ÂùÇÊú¨Á†îÂ§™Êúó', 'ËñÑÁî∞‰∫¨', 'Â±±Áî∞Â§ßÂ∞Ü', 'Ê∑∫Âà©ÂãáÊñó',
            'ÁâáÂ±±Ë£ïÂ≠ê', '‰∏äÊùëÂæπÈõÑ', '‰ªäÈáéÂ§ßËºî', '‰ªä‰∫ïÂ•é‰ªã', 'ÊùæÊú¨Á´úÂ≠£',
            'ÂÆâÁî∞Êªâ‰∏Ä', 'Â∞æÂ¥éÂãáÂìâ', 'ÊùæÁî∞ÈôΩÂπ≥'
        ];

        // NH„Éñ„Éº„Éà„Ç≠„É£„É≥„ÉóË≥ºÂÖ•ËÄÖ„É™„Çπ„Éà
        const nhBootcampPurchasers = [
            { name: 'Èà¥Êú®Êô∫Âºò', date: '2025-07-12', product: 'NH„Éñ„Éº„Éà„Ç≠„É£„É≥„Éó ÂçäÂπ¥„Ç≥„Éº„Çπ„Éª„Éé„Éº„Éû„É´„Éó„É©„É≥', amount: 29880 },
            { name: 'ÂÜÖÈáéÁúüÂ≠ê', date: '2025-07-13', product: 'NH„Éñ„Éº„Éà„Ç≠„É£„É≥„Éó ÂçäÂπ¥„Ç≥„Éº„Çπ„Éª„Éé„Éº„Éû„É´„Éó„É©„É≥', amount: 29880 },
            { name: 'Â∞æÂ¥éÂãáÂìâ', date: '2025-07-21', product: 'NH„Éñ„Éº„Éà„Ç≠„É£„É≥„Éó 1Âπ¥„Ç≥„Éº„Çπ„Éª„Éé„Éº„Éû„É´„Éó„É©„É≥', amount: 49800 },
            { name: 'ÊùæÊùëÈÅºÊ≤≥', date: '2025-07-22', product: 'NH„Éñ„Éº„Éà„Ç≠„É£„É≥„Éó ÂçäÂπ¥„Ç≥„Éº„Çπ„Éª„Éé„Éº„Éû„É´„Éó„É©„É≥', amount: 29880 },
            { name: 'ËñÑÁî∞‰∫¨', date: '2025-07-23', product: 'NH„Éñ„Éº„Éà„Ç≠„É£„É≥„Éó 1Âπ¥„Ç≥„Éº„Çπ„Éª„Éé„Éº„Éû„É´„Éó„É©„É≥', amount: 49800 },
            { name: 'Ê∏°ÈÇâÊô∫Â§ß', date: '2025-07-27', product: 'ÁÑ°Êòé‰ºö_NH„Éñ„Éº„Éà„Ç≠„É£„É≥„Éó_ÂÖ•‰ºöË≤ª', amount: 30000 },
            { name: 'Â±±Áî∞Â§ßÂ∞Ü', date: '2025-07-27', product: 'NH„Éñ„Éº„Éà„Ç≠„É£„É≥„Éó ÂçäÂπ¥„Ç≥„Éº„Çπ„Éª„Éé„Éº„Éû„É´„Éó„É©„É≥', amount: 29880 },
            { name: 'ÊùæÁî∞ÈôΩÂπ≥', date: '2025-07-16', product: 'NHBC1Âπ¥VIP', amount: 50000 },
            { name: 'ÊùæÊú¨Á´úÂ≠£', date: '2025-07-31', product: 'NH„Éñ„Éº„Éà„Ç≠„É£„É≥„Éó ÂçäÂπ¥„Ç≥„Éº„Çπ„Éª„Éé„Éº„Éû„É´„Éó„É©„É≥', amount: 29880 }
        ];

        // ÁèæÂú®„ÅÆ„Çπ„ÉÜ„Éº„Çø„ÇπÈÖçÂàóÔºàM001„Åã„ÇâÈ†ÜÁï™Ôºâ
        const currentStatusArray = [
            'ÈÄÄ‰ºö',      // M001
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M002
            'Âπ¥Èñì',      // M003
            'Âπ¥Èñì',      // M004
            'ÈÄöÂ∏∏',      // M005
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M006
            'ÈÄöÂ∏∏',      // M007
            'ÈÄÄ‰ºö',      // M008
            'ÈÄöÂ∏∏',      // M009
            'ÈÄÄ‰ºö',      // M010
            'ÈÄÄ‰ºö',      // M011
            'Âπ¥Èñì',      // M012
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M013
            'Âπ¥Èñì',      // M014
            'ÈÄÄ‰ºö',      // M015
            'ÈÄÄ‰ºö',      // M016
            'ÈÄÄ‰ºö',      // M017
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M018
            'ÈÄÄ‰ºö',      // M019
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M020
            'ÈÄöÂ∏∏',      // M021
            'ÈÄÄ‰ºö',      // M022
            'Âπ¥Èñì',      // M023
            'ÈÄöÂ∏∏',      // M024
            'ÈÄöÂ∏∏',      // M025
            'Âπ¥Èñì',      // M026
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M027
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M028
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M029
            'ÈÄöÂ∏∏',      // M030
            'ÈÄÄ‰ºö',      // M031
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M032
            'ÈÄöÂ∏∏',      // M033
            'ÈÄÄ‰ºö',      // M034
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M035
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M036
            'ÈÄÄ‰ºö',      // M037
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M038
            'ÈÄÄ‰ºö',      // M039
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M040
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M041
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M042
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M043
            'Âπ¥Èñì',      // M044
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M045
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M046
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M047
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M048
            'ÈÄöÂ∏∏',      // M049
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M050
            'ÈÄÄ‰ºö',      // M051
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M052
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M053
            'Âπ¥Èñì',      // M054
            'ÈÄöÂ∏∏',      // M055
            'ÈÄÄ‰ºö',      // M056
            'ÈÄöÂ∏∏',      // M057
            'ÈÄöÂ∏∏',      // M058
            'Âπ¥Èñì',      // M059
            'ÈÄöÂ∏∏',      // M060
            'ÈÄÄ‰ºö',      // M061
            'ÈÄöÂ∏∏',      // M062
            'Âπ¥Èñì',      // M063
            'Âπ¥Èñì',      // M064
            'ÈÄÄ‰ºö',      // M065
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M066
            'ÈÄöÂ∏∏',      // M067
            'Âπ¥Èñì',      // M068
            'ÈÄöÂ∏∏',      // M069
            'ÈÄöÂ∏∏',      // M070
            'ÈÄÄ‰ºö',      // M071
            'ÈÄöÂ∏∏',      // M072
            'Âπ¥Èñì',      // M073
            'ÈÄöÂ∏∏',      // M074
            'ÈÄÄ‰ºö',      // M075
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M076
            'ÈÄöÂ∏∏',      // M077
            'Âπ¥Èñì',      // M078
            'Âπ¥Èñì',      // M079
            'ÈÄöÂ∏∏',      // M080
            'ÈÄöÂ∏∏',      // M081
            'ÈÄÄ‰ºö',      // M082
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M083
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M084
            'ÈÄÄ‰ºö',      // M085
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M086
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M087
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M088
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M089
            'ÈÄöÂ∏∏',      // M090
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M091
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M092
            'ÈÄöÂ∏∏',      // M093
            'ÈÄÄ‰ºö',      // M094
            'ÈÄöÂ∏∏',      // M095
            'Âπ¥Èñì',      // M096
            'ÈÄÄ‰ºö',      // M097
            'Âπ¥Èñì',      // M098
            'ÈÄÄ‰ºö',      // M099
            'ÈÄöÂ∏∏',      // M100
            'Âπ¥Èñì',      // M101
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M102
            'Âπ¥Èñì',      // M103
            'ÈÄöÂ∏∏',      // M104
            'ÈÄÄ‰ºö',      // M105
            'ÈÄöÂ∏∏',      // M106
            'ÈÄÄ‰ºö',      // M107
            'ÈÄÄ‰ºö',      // M108
            'Âπ¥Èñì',      // M109
            'ÈÄÄ‰ºö',      // M110
            'ÈÄÄ‰ºö',      // M111
            'ÈÄöÂ∏∏',      // M112
            'ÈÄöÂ∏∏',      // M113
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M114
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M115
            'ÈÄöÂ∏∏',      // M116
            'ÈÄöÂ∏∏',      // M117
            'ÈÄöÂ∏∏',      // M118
            '‰ΩìÈ®ìÁµÇ‰∫Ü',  // M119
            'ÈÄöÂ∏∏',      // M120
            'ÈÄöÂ∏∏'       // M121
        ];

        // „É°„É≥„Éê„ÉºÊï∞Êé®Áßª„Éá„Éº„ÇøÔºàÈÅéÂéª12„É∂ÊúàÂàÜÔºâ
        const memberGrowthData = {
            '2024-08': { total: 85, annual: 18, regular: 29, churned: 38 },
            '2024-09': { total: 88, annual: 19, regular: 31, churned: 38 },
            '2024-10': { total: 92, annual: 20, regular: 33, churned: 39 },
            '2024-11': { total: 95, annual: 20, regular: 35, churned: 40 },
            '2024-12': { total: 98, annual: 20, regular: 37, churned: 41 },
            '2025-01': { total: 102, annual: 20, regular: 40, churned: 42 },
            '2025-02': { total: 106, annual: 20, regular: 43, churned: 43 },
            '2025-03': { total: 110, annual: 20, regular: 46, churned: 44 },
            '2025-04': { total: 113, annual: 20, regular: 48, churned: 45 },
            '2025-05': { total: 116, annual: 20, regular: 50, churned: 46 },
            '2025-06': { total: 119, annual: 20, regular: 52, churned: 47 },
            '2025-07': { total: 121, annual: 20, regular: 54, churned: 47 }
        };

        // Âπ¥ÈñìÊ±∫Ê∏àÊó•„Éá„Éº„ÇøÔºàÂπ¥Èñì‰ºöÂì°„ÅÆ„ÅøÔºâ
        const annualPaymentDates = {
            'M003': '2024-03-01',
            'M004': '2024-03-08', 
            'M012': '2024-02-28',
            'M014': '2024-02-12',
            'M023': '2024-03-01',
            'M026': '2024-02-09',
            'M044': '2024-02-21',
            'M054': '2024-02-10',
            'M059': '2024-02-05',
            'M063': '2025-02-04',
            'M064': '2024-11-02',
            'M068': '2024-02-26',
            'M073': '2024-07-01',
            'M078': '2024-05-16',
            'M079': '2024-05-18',
            'M096': '2025-01-16',
            'M098': '2025-02-12',
            'M101': '2024-12-04',
            'M103': '2024-10-25',
            'M109': '2024-10-30'
        };

        // „É°„É≥„Éê„Éº„Éá„Éº„Çø„Éô„Éº„Çπ
        const membersDatabase = [
            // Âπ¥Èñì‰ºöÂì°Ôºà20ÂêçÔºâ
            { id: 'M001', name: 'Ëó§Êæ§ÁßÄÂΩ∞', discord: 'Ëó§Êæ§', discordId: '', status: 'annual', joinDate: '2024-03-15', ltv: 650000, lastActive: '2025-07-28', events: 15, currentStatus: 'ÈÄÄ‰ºö' },
            { id: 'M002', name: 'Èà¥Êú®Ë£ï‰ªã', discord: '„ÇÜ„ÅÜ', discordId: 'exuberant_pomelo_29770', status: 'annual', joinDate: '2024-04-20', ltv: 9800, lastActive: '2025-07-27', events: 12, currentStatus: '‰ΩìÈ®ìÁµÇ‰∫Ü' },
            { id: 'M003', name: 'Á¶è‰∫ïÂ∫∑Â§ß', discord: 'yasu0016', discordId: '', status: 'annual', joinDate: '2024-02-10', ltv: 720000, lastActive: '2025-07-29', events: 18, currentStatus: 'Âπ¥Èñì' },
            { id: 'M004', name: '‰øµÂÅ•Â§™ÈÉé', discord: '„Åü„Çè„Çâ', discordId: '', status: 'annual', joinDate: '2024-05-12', ltv: 620000, lastActive: '2025-07-26', events: 14, currentStatus: 'Âπ¥Èñì' },
            { id: 'M005', name: 'ÈÄ≤Ëó§ÂãáËºù', discord: '„Ç∑„É≥', discordId: '', status: 'annual', joinDate: '2024-01-08', ltv: 780000, lastActive: '2025-07-30', events: 20, currentStatus: 'ÈÄöÂ∏∏' },
            { id: 'M006', name: '‰ΩêËó§Ë´íÈßø', status: 'annual', joinDate: '2024-06-18', ltv: 540000, lastActive: '2025-07-25', events: 11 },
            { id: 'M007', name: 'ÊùâÂπ≥Ê∂º', status: 'annual', joinDate: '2024-03-22', ltv: 660000, lastActive: '2025-07-28', events: 16 },
            { id: 'M008', name: 'ÊùæÊú¨Âíå‰πÖ', status: 'annual', joinDate: '2024-04-05', ltv: 590000, lastActive: '2025-07-27', events: 13 },
            { id: 'M009', name: 'ÊùæÁî∞ÈôΩÂπ≥', status: 'annual', joinDate: '2024-07-01', ltv: 450000, lastActive: '2025-07-29', events: 8 },
            { id: 'M010', name: '‰∫ï‰∏äÁ¥î‰πü', status: 'annual', joinDate: '2024-02-28', ltv: 710000, lastActive: '2025-07-30', events: 17 },
            { id: 'M011', name: 'Ê†πÂ°öÈôΩÂ∑±', status: 'annual', joinDate: '2024-05-30', ltv: 570000, lastActive: '2025-07-26', events: 12 },
            { id: 'M012', name: 'Ëó§ÂéüÁ∂úÂ§™ÈÉé', status: 'annual', joinDate: '2024-01-15', ltv: 790000, lastActive: '2025-07-28', events: 21 },
            { id: 'M013', name: 'Áü≥Â≥∂ÁßÄÂ≥∞', status: 'annual', joinDate: '2024-06-08', ltv: 520000, lastActive: '2025-07-27', events: 10 },
            { id: 'M014', name: '‰ΩêËó§‰∫úÁæé', status: 'annual', joinDate: '2024-03-12', ltv: 680000, lastActive: '2025-07-29', events: 15 },
            { id: 'M015', name: 'Â°öÊú¨Áúü‰ºç', status: 'annual', joinDate: '2024-04-25', ltv: 600000, lastActive: '2025-07-25', events: 14 },
            { id: 'M016', name: 'ÊπäÁøîÂ§™ÈÉé', status: 'annual', joinDate: '2024-07-10', ltv: 440000, lastActive: '2025-07-30', events: 7 },
            { id: 'M017', name: 'Èà¥Êú®ËèúÊëò', status: 'annual', joinDate: '2024-02-05', ltv: 730000, lastActive: '2025-07-28', events: 19 },
            { id: 'M018', name: 'ÊùæÂ≥∂Âæπ', status: 'annual', joinDate: '2024-05-18', ltv: 610000, lastActive: '2025-07-26', events: 13 },
            { id: 'M019', name: 'Á≤üÊ¥•ÂæãÂ≠ê', status: 'annual', joinDate: '2024-01-25', ltv: 750000, lastActive: '2025-07-27', events: 20 },
            { id: 'M020', name: 'Ê¶éÊú¨È´ò‰πü', status: 'annual', joinDate: '2024-06-22', ltv: 530000, lastActive: '2025-07-29', events: 11 },

            // ÈÄöÂ∏∏‰ºöÂì°Ôºà85ÂêçÔºâ- Êèê‰æõ„Åï„Çå„Åü„É™„Çπ„Éà„Åã„Çâ85Âêç„ÇíÈÅ∏Âá∫
            { id: 'M021', name: 'Áü≥Âû£ÂêâË¶è', status: 'regular', joinDate: '2024-08-15', ltv: 280000, lastActive: '2025-07-28', events: 8 },
            { id: 'M022', name: '„Éñ„É´', status: 'regular', joinDate: '2024-09-10', ltv: 150000, lastActive: '2025-07-27', events: 5 },
            { id: 'M023', name: 'Èà¥Êú®Â∫∑Â§™', status: 'regular', joinDate: '2024-10-05', ltv: 220000, lastActive: '2025-07-29', events: 6 },
            { id: 'M024', name: 'Â••ÊùëÊãìÂìâ', status: 'regular', joinDate: '2024-11-12', ltv: 180000, lastActive: '2025-07-26', events: 4 },
            { id: 'M025', name: 'Ê±†Êú¨Êπä‰∫ÜÊ±∞', status: 'regular', joinDate: '2024-12-20', ltv: 120000, lastActive: '2025-07-25', events: 3 },
            { id: 'M026', name: 'ÊùæÊú¨Á´úÂ≠£', status: 'regular', joinDate: '2025-01-15', ltv: 90000, lastActive: '2025-07-30', events: 2 },
            { id: 'M027', name: 'Ë•øÂ≥∂È¢Ø‰∫∫', status: 'regular', joinDate: '2025-02-08', ltv: 60000, lastActive: '2025-07-28', events: 1 },
            { id: 'M028', name: 'Â±±Á∏£Ë™†‰∫å', status: 'regular', joinDate: '2024-07-22', ltv: 320000, lastActive: '2025-07-27', events: 9 },
            { id: 'M029', name: 'Á∂øË≤´Ê°ÇÂ§™', status: 'regular', joinDate: '2024-08-18', ltv: 260000, lastActive: '2025-07-29', events: 7 },
            { id: 'M030', name: 'Ê∏ÖÊ∞¥ÊöÅ', status: 'regular', joinDate: '2024-09-25', ltv: 200000, lastActive: '2025-07-26', events: 5 },
            { id: 'M031', name: '‰∏≠ÊùëÊÑèÂ§ÆÈáå', status: 'regular', joinDate: '2024-10-30', ltv: 170000, lastActive: '2025-07-25', events: 4 },
            { id: 'M032', name: 'Â≥∂ÂÆàÂãáÊ¨°', status: 'regular', joinDate: '2024-11-15', ltv: 140000, lastActive: '2025-07-30', events: 3 },
            { id: 'M033', name: 'ÂçÉÂêâËâØ‰øäÂÖÖ', status: 'regular', joinDate: '2024-12-08', ltv: 110000, lastActive: '2025-07-28', events: 2 },
            { id: 'M034', name: 'Â≤©‰∏ãÊú™Ë™âÂ≠ê', status: 'regular', joinDate: '2025-01-20', ltv: 80000, lastActive: '2025-07-27', events: 1 },
            { id: 'M035', name: 'ÂÆâÁî∞Êªâ‰∏Ä', status: 'regular', joinDate: '2024-06-12', ltv: 380000, lastActive: '2025-07-29', events: 10 },
            { id: 'M036', name: 'ÁúüÊú®Êô∫‰πã', status: 'regular', joinDate: '2024-07-05', ltv: 340000, lastActive: '2025-07-26', events: 9 },
            { id: 'M037', name: 'ÂêâÂµú‰øä‰∏ÄÈÉé', status: 'regular', joinDate: '2024-08-28', ltv: 240000, lastActive: '2025-07-25', events: 6 },
            { id: 'M038', name: '‰ªä‰∫ï‰∏ÄÁúü', status: 'regular', joinDate: '2024-09-15', ltv: 190000, lastActive: '2025-07-30', events: 5 },
            { id: 'M039', name: 'Âπ≥ÈáéÁêÜÁµµ', status: 'regular', joinDate: '2024-10-10', ltv: 160000, lastActive: '2025-07-28', events: 4 },
            { id: 'M040', name: 'ÂÜÖÁî∞Ê≥∞Êñá', status: 'regular', joinDate: '2024-11-22', ltv: 130000, lastActive: '2025-07-27', events: 3 },
            { id: 'M041', name: 'Â¢óÁî∞Âáå‰∏Ä', status: 'regular', joinDate: '2024-12-18', ltv: 100000, lastActive: '2025-07-29', events: 2 },
            { id: 'M042', name: 'Êñ∞‰øùÂèãÊúõÂ•à', status: 'regular', joinDate: '2025-01-12', ltv: 70000, lastActive: '2025-07-26', events: 1 },
            { id: 'M043', name: 'Â∏ÇÂ∑ù‰Ω≥Â•à', status: 'regular', joinDate: '2024-05-25', ltv: 420000, lastActive: '2025-07-25', events: 11 },
            { id: 'M044', name: 'Ê∏°ÈÇâÊô∫Â§ß', status: 'regular', joinDate: '2024-06-30', ltv: 360000, lastActive: '2025-07-30', events: 10 },
            { id: 'M045', name: 'Ê≥âÁî∞Á•êËºù', status: 'regular', joinDate: '2024-07-18', ltv: 300000, lastActive: '2025-07-28', events: 8 },
            { id: 'M046', name: 'Ê∞∏‰∫ïÂÖãÂπ∏', status: 'regular', joinDate: '2024-08-12', ltv: 250000, lastActive: '2025-07-27', events: 7 },
            { id: 'M047', name: 'ËåÇÊú®‰∏ÄÂπ∏', status: 'regular', joinDate: '2024-09-08', ltv: 210000, lastActive: '2025-07-29', events: 6 },
            { id: 'M048', name: 'ÊùæÁî∞Âú≠Âè≥', status: 'regular', joinDate: '2024-10-20', ltv: 180000, lastActive: '2025-07-26', events: 4 },
            { id: 'M049', name: 'ÊùæÊùëÈÅºÊ≤≥', status: 'regular', joinDate: '2024-11-08', ltv: 150000, lastActive: '2025-07-25', events: 3 },
            { id: 'M050', name: 'Âπ≥Â≤©ÈÅºÂøó', status: 'regular', joinDate: '2024-12-25', ltv: 120000, lastActive: '2025-07-30', events: 2 },
            { id: 'M051', name: '‰ΩêËó§‰∏ÄÊ∞ó', status: 'regular', joinDate: '2025-01-18', ltv: 90000, lastActive: '2025-07-28', events: 1 },
            { id: 'M052', name: 'ÁÖß‰∫ïÁ¥ÄËá£', status: 'regular', joinDate: '2024-04-15', ltv: 480000, lastActive: '2025-07-27', events: 12 },
            { id: 'M053', name: 'ÂùÇË©∞ÂÆ£‰∫∫', status: 'regular', joinDate: '2024-05-12', ltv: 440000, lastActive: '2025-07-29', events: 11 },
            { id: 'M054', name: '‰∏≠ÊÇ†Â§™', status: 'regular', joinDate: '2024-06-18', ltv: 380000, lastActive: '2025-07-26', events: 10 },
            { id: 'M055', name: 'Â∞èÊûóÂçÉÊ≥∞', status: 'regular', joinDate: '2024-07-25', ltv: 320000, lastActive: '2025-07-25', events: 8 },
            { id: 'M056', name: 'Âª£Áî∞‰∏ÄÊï¨', status: 'regular', joinDate: '2024-08-08', ltv: 280000, lastActive: '2025-07-30', events: 7 },
            { id: 'M057', name: 'Èà¥Êú®Êô∫Âºò', status: 'regular', joinDate: '2024-09-12', ltv: 240000, lastActive: '2025-07-28', events: 6 },
            { id: 'M058', name: 'Â∞èÂ≥∂ÂïìËºî', status: 'regular', joinDate: '2024-10-28', ltv: 200000, lastActive: '2025-07-27', events: 5 },
            { id: 'M059', name: 'Â∞æÂ¥éÂãáÂìâ', status: 'regular', joinDate: '2024-11-18', ltv: 160000, lastActive: '2025-07-29', events: 4 },
            { id: 'M060', name: '‰Ωê„ÄÖÊú®ÈÄè', status: 'regular', joinDate: '2024-12-05', ltv: 130000, lastActive: '2025-07-26', events: 3 },
            { id: 'M061', name: 'Â∞èÊûóÂíåË≤¥', status: 'regular', joinDate: '2025-01-08', ltv: 100000, lastActive: '2025-07-25', events: 2 },
            { id: 'M062', name: 'Êó•È´òÊÇ†Ê≤≥', status: 'regular', joinDate: '2024-03-20', ltv: 520000, lastActive: '2025-07-30', events: 13 },
            { id: 'M063', name: 'Ê±üÂè£ÈÅîÂÆè', status: 'regular', joinDate: '2024-04-22', ltv: 460000, lastActive: '2025-07-28', events: 12 },
            { id: 'M064', name: 'Êù±Âá∫ÊïôËã•', status: 'regular', joinDate: '2024-05-30', ltv: 400000, lastActive: '2025-07-27', events: 10 },
            { id: 'M065', name: 'Âá∫Áî∞Á´ú‰πü', status: 'regular', joinDate: '2024-06-25', ltv: 350000, lastActive: '2025-07-29', events: 9 },
            { id: 'M066', name: 'Èï∑Áî∞‰∏Ä', status: 'regular', joinDate: '2024-07-15', ltv: 310000, lastActive: '2025-07-26', events: 8 },
            { id: 'M067', name: 'Â∏ÇÊ©ãÊÖéÂ£´', status: 'regular', joinDate: '2024-08-20', ltv: 270000, lastActive: '2025-07-25', events: 7 },
            { id: 'M068', name: '‰ªä‰∫ïÂ•é‰ªã', status: 'regular', joinDate: '2024-09-18', ltv: 230000, lastActive: '2025-07-30', events: 6 },
            { id: 'M069', name: '‰∏≠Ë•øËà™Âπ≥', status: 'regular', joinDate: '2024-10-15', ltv: 190000, lastActive: '2025-07-28', events: 5 },
            { id: 'M070', name: 'ÁÜäË∞∑ÁëûÂ•àÁæé', status: 'regular', joinDate: '2024-11-28', ltv: 150000, lastActive: '2025-07-27', events: 3 },
            { id: 'M071', name: 'ÂÜÖÈáéÁúüÂ≠ê', status: 'regular', joinDate: '2024-12-12', ltv: 120000, lastActive: '2025-07-29', events: 2 },
            { id: 'M072', name: 'Á®≤Âû£ÁúüË£ï', status: 'regular', joinDate: '2025-01-25', ltv: 80000, lastActive: '2025-07-26', events: 1 },
            { id: 'M073', name: 'Ê∏ÖÁî∞ÂÆáÂÆô', status: 'regular', joinDate: '2024-02-18', ltv: 560000, lastActive: '2025-07-25', events: 14 },
            { id: 'M074', name: 'Áå™ÈáéÂÄ´Âìâ', status: 'regular', joinDate: '2024-03-15', ltv: 500000, lastActive: '2025-07-30', events: 13 },
            { id: 'M075', name: 'ÊùæÂû£Âèã', status: 'regular', joinDate: '2024-04-10', ltv: 440000, lastActive: '2025-07-28', events: 11 },
            { id: 'M076', name: 'ÁØ†Â¥éÂºòÂ§ö', status: 'regular', joinDate: '2024-05-08', ltv: 390000, lastActive: '2025-07-27', events: 10 },
            { id: 'M077', name: 'Â∏ÇÊùëÊô∫', status: 'regular', joinDate: '2024-06-12', ltv: 340000, lastActive: '2025-07-29', events: 9 },
            { id: 'M078', name: '‰ªäÈáéÂ§ßËºî', status: 'regular', joinDate: '2024-07-28', ltv: 290000, lastActive: '2025-07-26', events: 7 },
            { id: 'M079', name: 'Â∑æÂ¥éÁî±Á¥ÄÂ≠ê', status: 'regular', joinDate: '2024-08-25', ltv: 250000, lastActive: '2025-07-25', events: 6 },
            { id: 'M080', name: 'Á±æÂ±±ÈäÄÊ≤≥', status: 'regular', joinDate: '2024-09-22', ltv: 210000, lastActive: '2025-07-30', events: 5 },
            { id: 'M081', name: 'ÂùÇ‰πã‰∏äÈ¢Ø‰∫∫', status: 'regular', joinDate: '2024-10-18', ltv: 170000, lastActive: '2025-07-28', events: 4 },
            { id: 'M082', name: 'Ê∞èÂÆ∂Â®ÅÂêπ', status: 'regular', joinDate: '2024-11-25', ltv: 140000, lastActive: '2025-07-27', events: 3 },
            { id: 'M083', name: 'ÈªíÊü≥Êú±Èü≥', status: 'regular', joinDate: '2024-12-20', ltv: 110000, lastActive: '2025-07-29', events: 2 },
            { id: 'M084', name: 'ÂõΩÂÆâ„ÅÇ„Åö„Åø', status: 'regular', joinDate: '2025-01-15', ltv: 75000, lastActive: '2025-07-26', events: 1 },
            { id: 'M085', name: 'Èò™Êú¨Â∑≥Áéñ‰πü', status: 'regular', joinDate: '2024-01-20', ltv: 580000, lastActive: '2025-07-25', events: 15 },
            { id: 'M086', name: 'ÂùÇÊú¨Á†îÂ§™Êúó', status: 'regular', joinDate: '2024-02-25', ltv: 540000, lastActive: '2025-07-30', events: 14 },
            { id: 'M087', name: 'Ëó§‰∫ïÂæπ', status: 'regular', joinDate: '2024-03-28', ltv: 480000, lastActive: '2025-07-28', events: 12 },
            { id: 'M088', name: 'ÂêâÂ≤°‰ΩëÂº•', status: 'regular', joinDate: '2024-04-18', ltv: 420000, lastActive: '2025-07-27', events: 11 },
            { id: 'M089', name: '‰ΩêËó§ÊÅ≠Âπ≥', status: 'regular', joinDate: '2024-05-22', ltv: 380000, lastActive: '2025-07-29', events: 10 },
            { id: 'M090', name: 'Â∞èÊ∏ïÊ°ÉÂ≠ê', status: 'regular', joinDate: '2024-06-15', ltv: 330000, lastActive: '2025-07-26', events: 9 },
            { id: 'M091', name: 'Ê£ÆÂ≤°Ë£ï‰πã', status: 'regular', joinDate: '2024-07-12', ltv: 280000, lastActive: '2025-07-25', events: 8 },
            { id: 'M092', name: 'ÈÅ†Ëó§ÁëõÂ§™', status: 'regular', joinDate: '2024-08-05', ltv: 240000, lastActive: '2025-07-30', events: 6 },
            { id: 'M093', name: '‰∫Ä‰∫ïÊÇ†', status: 'regular', joinDate: '2024-09-10', ltv: 200000, lastActive: '2025-07-28', events: 5 },
            { id: 'M094', name: '‰ºäËó§Ëã±Âìâ', status: 'regular', joinDate: '2024-10-08', ltv: 160000, lastActive: '2025-07-27', events: 4 },
            { id: 'M095', name: 'Â∞èÊùâÊ≤ôÈáåË°£', status: 'regular', joinDate: '2024-11-12', ltv: 130000, lastActive: '2025-07-29', events: 3 },
            { id: 'M096', name: 'ËñÑÁî∞‰∫¨', status: 'regular', joinDate: '2024-12-08', ltv: 100000, lastActive: '2025-07-26', events: 2 },
            { id: 'M097', name: 'Ê∑∫Ê≤º‰Ω≥ÈÇ£Â≠ê', status: 'regular', joinDate: '2025-01-05', ltv: 70000, lastActive: '2025-07-25', events: 1 },
            { id: 'M098', name: 'Â±±Áî∞Â§ßÂ∞Ü', status: 'regular', joinDate: '2023-12-15', ltv: 620000, lastActive: '2025-07-30', events: 16 },
            { id: 'M099', name: 'Ê∞∏ÈáéÁ¶è‰∏â', status: 'regular', joinDate: '2024-01-08', ltv: 590000, lastActive: '2025-07-28', events: 15 },
            { id: 'M100', name: '‰∏≠Ê†πÊªâ‰ªã', status: 'regular', joinDate: '2024-02-12', ltv: 520000, lastActive: '2025-07-27', events: 13 },
            { id: 'M101', name: 'Â±±Áî∞Ââõ', status: 'regular', joinDate: '2024-03-05', ltv: 460000, lastActive: '2025-07-29', events: 12 },
            { id: 'M102', name: 'Áî∞ÂéüÁíÉÈü≥', status: 'regular', joinDate: '2024-04-08', ltv: 400000, lastActive: '2025-07-26', events: 10 },
            { id: 'M103', name: 'Ê∑∫Âà©ÂãáÊñó', status: 'regular', joinDate: '2024-05-15', ltv: 350000, lastActive: '2025-07-25', events: 9 },
            { id: 'M104', name: 'ÁâáÂ±±Ë£ïÂ≠ê', status: 'regular', joinDate: '2024-06-20', ltv: 310000, lastActive: '2025-07-30', events: 8 },
            { id: 'M105', name: 'Ê∞¥ÊûóÈ∫ªÈáåÊÅµ', status: 'regular', joinDate: '2024-07-08', ltv: 270000, lastActive: '2025-07-28', events: 7 },

            // ‰ΩìÈ®ì‰ºöÂì°Ôºà5ÂêçÔºâ
            { id: 'M106', name: 'Ê¶éÊú¨Áü•‰Ω≥', status: 'trial', joinDate: '2025-07-15', ltv: 5000, lastActive: '2025-07-27', events: 1 },
            { id: 'M107', name: 'Áï†Áî∞„ÅØ„Å™', status: 'trial', joinDate: '2025-07-18', ltv: 5000, lastActive: '2025-07-29', events: 1 },
            { id: 'M108', name: '‰∏äÊùëÂæπÈõÑ', status: 'trial', joinDate: '2025-07-22', ltv: 5000, lastActive: '2025-07-26', events: 1 },
            { id: 'M109', name: 'Ê∏°ÈÇäÊï¶Â≠ê', status: 'trial', joinDate: '2025-07-25', ltv: 5000, lastActive: '2025-07-25', events: 1 },
            { id: 'M110', name: '‰ºäËó§Â•èË°£', status: 'trial', joinDate: '2025-07-28', ltv: 5000, lastActive: '2025-07-30', events: 1 }
        ];

        let filteredMembers = [];

        // LTVË®àÁÆóÈñ¢Êï∞
        function calculateBaseLTV(member) {
            const now = new Date();
            
            // ÁèæÂú®„ÅÆ„Çπ„ÉÜ„Éº„Çø„Çπ„Å´Âü∫„Å•„ÅÑ„Å¶LTV„ÇíË®àÁÆó
            if (member.currentStatus === '‰ΩìÈ®ìÁµÇ‰∫Ü') {
                return 3000; // ‰ΩìÈ®ì„ÅÆ„Åø
            } else if (member.currentStatus === 'ÈÄÄ‰ºö' || member.currentStatus === 'ÈÄöÂ∏∏') {
                // ÈÄöÂ∏∏‰ºöÂì°„ÅÆË®àÁÆóÔºàÈÄÄ‰ºö„ÉªÁ∂ôÁ∂öÂïè„Çè„ÅöÔºâ
                // regularJoinDateÔºàÊ≠£Ë¶èÊîØÊâï„ÅÑÈñãÂßãÊó•Ôºâ„Åã„ÇâË®àÁÆó
                if (member.regularJoinDate) {
                    const regularStartDate = new Date(member.regularJoinDate);
                    const monthsActive = Math.max(1, Math.floor((now - regularStartDate) / (1000 * 60 * 60 * 24 * 30)));
                    return 3000 + (monthsActive * 22000); // ‰ΩìÈ®ì + ÈÄöÂ∏∏‰ºöÂì°ÊúüÈñì
                } else {
                    // regularJoinDate„Åå„Å™„ÅÑÂ†¥Âêà„ÅØjoinDate„Åã„ÇâÊé®ÂÆö
                    const joinDate = new Date(member.joinDate);
                    const monthsActive = Math.max(1, Math.floor((now - joinDate) / (1000 * 60 * 60 * 24 * 30)));
                    return monthsActive * 22000;
                }
            } else if (member.currentStatus === 'Âπ¥Èñì') {
                // Âπ¥Èñì‰ºöÂì°ÔºöÂÖ•‰ºö„Åã„Çâ„ÅÆÂπ¥Êï∞ √ó 220,000ÂÜÜ
                const joinDate = new Date(member.regularJoinDate || member.joinDate);
                const yearsActive = Math.max(1, Math.ceil((now - joinDate) / (1000 * 60 * 60 * 24 * 365)));
                return yearsActive * 220000;
            }
            return 0;
        }

        // Âπ¥ÈñìÊ±∫Ê∏àÊõ¥Êñ∞ÊúüÈôêË®àÁÆó
        function calculateRenewalStatus(member) {
            if (member.currentStatus !== 'Âπ¥Èñì' || !member.annualPaymentDate) {
                return { status: '„Å™„Åó', daysUntilRenewal: null, renewalDate: null };
            }

            const today = new Date();
            const lastPayment = new Date(member.annualPaymentDate);
            const renewalDate = new Date(lastPayment);
            renewalDate.setFullYear(renewalDate.getFullYear() + 1);
            
            const daysUntilRenewal = Math.ceil((renewalDate - today) / (1000 * 60 * 60 * 24));
            
            let status;
            if (daysUntilRenewal < 0) {
                status = 'Êõ¥Êñ∞ÂøÖË¶Å';
            } else if (daysUntilRenewal <= 30) {
                status = 'Êõ¥Êñ∞ÈñìËøë';
            } else if (daysUntilRenewal <= 60) {
                status = 'Ë¶ÅÊ≥®ÊÑè';
            } else {
                status = 'Ê≠£Â∏∏';
            }

            return {
                status: status,
                daysUntilRenewal: daysUntilRenewal,
                renewalDate: renewalDate.toISOString().split('T')[0]
            };
        }

        // „É°„É≥„Éê„Éº„Éá„Éº„Çø„ÅÆÂàùÊúüÂåñÔºàÁèæÂú®„ÅÆ„Çπ„ÉÜ„Éº„Çø„Çπ„Å®LTV„ÅÆË™øÊï¥Ôºâ
        function initializeMemberData() {
            membersDatabase.forEach((member, index) => {
                // ÁèæÂú®„ÅÆ„Çπ„ÉÜ„Éº„Çø„Çπ„ÇíË®≠ÂÆö
                member.currentStatus = currentStatusArray[index];
                
                // Ê≠£Ë¶èÊîØÊâï„ÅÑÈñãÂßãÊó•„ÇíË®≠ÂÆö
                member.regularJoinDate = regularJoinDateArray[index] || null;
                
                // LTV„ÇíÊ≠£„Åó„ÅèË®àÁÆó
                member.ltv = calculateBaseLTV(member);
                
                // ‰∏âÊØí„ÉÅ„Éº„É†ÊÉÖÂ†±„ÇíË®≠ÂÆö
                if (typeof threePoisonsTeamMapping !== 'undefined') {
                    member.threePoisonsTeam = threePoisonsTeamMapping[member.name] || 'Êú™Ë®≠ÂÆö';
                }
                
                // „Ç¢„ÉÉ„Éó„Çª„É´Â£≤‰∏ä„ÅÆË®≠ÂÆö
                member.upsales = member.upsales || [];
                let totalUpsales = 0;
                
                // ÂæπÂ∫ïÁ≤æÈÄ≤Ë≥ºÂÖ•ËÄÖ„ÅÆÂ†¥Âêà
                if (tesseiShinPurchasers.includes(member.name)) {
                    const tesseiShin = {
                        name: 'ÂæπÂ∫ïÁ≤æÈÄ≤',
                        totalAmount: 330000,
                        purchaseDate: '2025-06',
                        installments: 3,
                        monthlyAmount: 110000,
                        paidInstallments: 2, // 2ÂõûÂàÜÊîØÊâï„ÅÑÊ∏à„ÅøÔºà6Êúà„ÄÅ7ÊúàÔºâ
                        remainingAmount: 110000,
                        nextPaymentDate: '2025-08-31',
                        status: 'ÂàÜÂâ≤‰∏≠'
                    };
                    member.upsales.push(tesseiShin);
                    totalUpsales += 330000;
                }
                
                // NH„Éñ„Éº„Éà„Ç≠„É£„É≥„ÉóË≥ºÂÖ•ËÄÖ„ÅÆÂ†¥Âêà
                const nhPurchase = nhBootcampPurchasers.find(p => p.name === member.name);
                if (nhPurchase) {
                    const nhBootcamp = {
                        name: nhPurchase.product,
                        totalAmount: nhPurchase.amount,
                        purchaseDate: nhPurchase.date,
                        installments: 1,
                        monthlyAmount: nhPurchase.amount,
                        paidInstallments: 1,
                        remainingAmount: 0,
                        nextPaymentDate: null,
                        status: 'ÂÆåÊ∏à'
                    };
                    member.upsales.push(nhBootcamp);
                    totalUpsales += nhPurchase.amount;
                }
                
                member.totalUpsales = totalUpsales;
                
                member.totalLTV = member.ltv + member.totalUpsales;

                // Âπ¥ÈñìÊ±∫Ê∏àÊó•„ÇíË®≠ÂÆö
                if (member.currentStatus === 'Âπ¥Èñì') {
                    member.annualPaymentDate = annualPaymentDates[member.id] || null;
                    
                    if (member.annualPaymentDate) {
                        const renewalInfo = calculateRenewalStatus(member);
                        member.renewalStatus = renewalInfo.status;
                        member.daysUntilRenewal = renewalInfo.daysUntilRenewal;
                        member.renewalDate = renewalInfo.renewalDate;
                    }
                }
            });
        }

        // „Éö„Éº„Ç∏Ë™≠„ÅøËæº„ÅøÊôÇ„ÅÆÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            try {
                console.log('DOMContentLoadedÂÆüË°åÈñãÂßã');
                console.log('membersDatabaseÈï∑„Åï:', membersDatabase ? membersDatabase.length : 'undefined');
                
                if (!membersDatabase || membersDatabase.length === 0) {
                    console.error('membersDatabase „ÅåÁ©∫„Åæ„Åü„ÅØÊú™ÂÆöÁæ©');
                    document.getElementById('memberGrid').innerHTML = '<div style="text-align:center; padding:50px; color:red;">„É°„É≥„Éê„Éº„Éá„Éº„Çø„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü</div>';
                    return;
                }
                
                initializeMemberData();
                filteredMembers = [...membersDatabase];
                console.log('filteredMembersÈï∑„Åï:', filteredMembers.length);
                
                // Áõ¥Êé•renderMembers„ÇíÂëº„Å≥Âá∫„Åó„Å¶„ÉÜ„Çπ„Éà
                renderMembers();
                setupEventListeners();
                updateStats();
                
                console.log('ÂàùÊúüÂåñÂÆå‰∫Ü');
            } catch (error) {
                console.error('ÂàùÊúüÂåñ„Ç®„É©„Éº:', error);
                document.getElementById('memberGrid').innerHTML = '<div style="text-align:center; padding:50px; color:red;">ÂàùÊúüÂåñ„Ç®„É©„Éº: ' + error.message + '</div>';
            }
        });

        // „Ç¢„ÇØ„ÉÜ„Ç£„Éñ„É°„É≥„Éê„Éº„ÅÆ„ÅøË°®Á§∫„Éï„É©„Ç∞
        let showActiveOnly = false;

        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÅÆË®≠ÂÆö
        function setupEventListeners() {
            document.getElementById('searchBox').addEventListener('input', filterMembers);
            document.getElementById('statusFilter').addEventListener('change', filterMembers);
            document.getElementById('sortBy').addEventListener('change', sortMembers);
            document.getElementById('teamFilter').addEventListener('change', filterMembers);
            document.getElementById('activeOnlyBtn').addEventListener('click', toggleActiveOnly);
            document.getElementById('rankingBtn').addEventListener('click', showLTVRanking);
            document.getElementById('renewalAlertBtn').addEventListener('click', showRenewalAlert);
        }

        // LTV„É©„É≥„Ç≠„É≥„Ç∞Ë°®Á§∫
        function showLTVRanking() {
            // ÁèæÂΩπ‰ºöÂì°„Çí„Éï„Ç£„É´„Çø
            showActiveOnly = true;
            const btn = document.getElementById('activeOnlyBtn');
            btn.style.background = '#dc3545';
            btn.textContent = 'üö´ ÂÖ®Âì°Ë°®Á§∫';
            
            // LTVÈ†Ü„Åß„ÇΩ„Éº„Éà
            document.getElementById('sortBy').value = 'ltv';
            filterMembers();
        }

        // Êõ¥Êñ∞ÈñìËøë„Ç¢„É©„Éº„ÉàË°®Á§∫
        function showRenewalAlert() {
            const renewalAlertMembers = membersDatabase.filter(m => 
                m.currentStatus === 'Âπ¥Èñì' && 
                (m.renewalStatus === 'Êõ¥Êñ∞ÂøÖË¶Å' || m.renewalStatus === 'Êõ¥Êñ∞ÈñìËøë' || m.renewalStatus === 'Ë¶ÅÊ≥®ÊÑè')
            );

            if (renewalAlertMembers.length === 0) {
                alert('ÁèæÂú®„ÄÅÊõ¥Êñ∞„ÅåÂøÖË¶Å„Å™Âπ¥Èñì‰ºöÂì°„ÅØ„ÅÑ„Åæ„Åõ„Çì„ÄÇ');
                return;
            }

            // Êõ¥Êñ∞ÊúüÈôêÈ†Ü„Åß„ÇΩ„Éº„Éà
            renewalAlertMembers.sort((a, b) => (a.daysUntilRenewal || -999) - (b.daysUntilRenewal || -999));

            let alertMessage = `‚ö†Ô∏è Âπ¥Èñì‰ºöÂì°Êõ¥Êñ∞„Ç¢„É©„Éº„Éà (${renewalAlertMembers.length}Âêç)\n\n`;
            
            renewalAlertMembers.forEach(member => {
                const daysText = member.daysUntilRenewal < 0 ? 
                    `ÊúüÈôêÂàá„Çå(${Math.abs(member.daysUntilRenewal)}Êó•ÁµåÈÅé)` : 
                    `„ÅÇ„Å®${member.daysUntilRenewal}Êó•`;
                
                alertMessage += `${member.name} (${member.id})\n`;
                alertMessage += `  ‚îî ${member.renewalStatus}: ${daysText}\n`;
                alertMessage += `  ‚îî Êõ¥Êñ∞ÊúüÈôê: ${member.renewalDate}\n\n`;
            });

            alert(alertMessage);

            // „Éï„Ç£„É´„Çø„Éº„ÇíÂπ¥Èñì‰ºöÂì°„Å´Ë®≠ÂÆö
            document.getElementById('statusFilter').value = 'Âπ¥Èñì';
            filterMembers();
        }

        // ÁèæÂΩπ‰ºöÂì°„ÅÆ„ÅøË°®Á§∫Âàá„ÇäÊõø„Åà
        function toggleActiveOnly() {
            showActiveOnly = !showActiveOnly;
            const btn = document.getElementById('activeOnlyBtn');
            
            if (showActiveOnly) {
                btn.style.background = '#dc3545';
                btn.textContent = 'üö´ ÂÖ®Âì°Ë°®Á§∫';
                btn.title = '„ÇØ„É™„ÉÉ„ÇØ„ÅßÂÖ®„É°„É≥„Éê„Éº„ÇíË°®Á§∫';
            } else {
                btn.style.background = '#28a745';
                btn.textContent = 'üë• ÁèæÂΩπ‰ºöÂì°„ÅÆ„Åø';
                btn.title = '„ÇØ„É™„ÉÉ„ÇØ„ÅßÁèæÂΩπ‰ºöÂì°„ÅÆ„ÅøË°®Á§∫';
            }
            
            filterMembers();
        }

        // „É°„É≥„Éê„Éº„É™„Çπ„Éà„Ç¢„Ç§„ÉÜ„É†„ÅÆÁîüÊàê
        function createMemberCard(member) {
            // „Çπ„ÉÜ„Éº„Çø„ÇπË°®Á§∫ÔºàÂπ¥Èñì‰ºöÂì°„ÅØÊõ¥Êñ∞ÊúüÈôêÊÉÖÂ†±„ÇíË°®Á§∫Ôºâ
            let statusLabel = member.currentStatus || {
                'annual': 'Âπ¥Èñì',
                'regular': 'ÈÄöÂ∏∏',
                'trial': '‰ΩìÈ®ì'
            }[member.status];
            
            let statusClass = `status-${member.currentStatus || member.status}`;
            
            if (member.currentStatus === 'Âπ¥Èñì' && member.renewalDate) {
                const today = new Date();
                const currentMonth = today.getMonth() + 1;
                const renewalDate = new Date(member.renewalDate);
                const renewalMonth = renewalDate.getMonth() + 1;
                
                if (member.daysUntilRenewal <= 30) {
                    statusLabel = `Âπ¥Èñì(${renewalMonth}ÊúàÊõ¥Êñ∞)`;
                    if (member.daysUntilRenewal < 0) {
                        statusClass += ' renewal-overdue';
                    } else {
                        statusClass += ' renewal-soon';
                    }
                } else {
                    statusLabel = `Âπ¥Èñì(${currentMonth}Êúà)`;
                }
            }

            // ‰∏âÊØí„ÉÅ„Éº„É†Ë°®Á§∫
            const teamClass = `team-${member.threePoisonsTeam || 'Êú™Ë®≠ÂÆö'}`;
            const teamLabel = member.threePoisonsTeam || 'Êú™Ë®≠ÂÆö';



            const opacity = (member.currentStatus === 'ÈÄÄ‰ºö' || member.currentStatus === '‰ΩìÈ®ìÁµÇ‰∫Ü') ? 'opacity: 0.6;' : '';

            // „Ç¢„ÉÉ„Éó„Çª„É´Ë°®Á§∫
            let upsaleDisplay = '-';
            if (member.upsales && member.upsales.length > 0) {
                const upsaleNames = member.upsales.map(u => {
                    if (u.name === 'ÂæπÂ∫ïÁ≤æÈÄ≤') return 'ÂæπÂ∫ïÁ≤æÈÄ≤';
                    if (u.name.includes('NH„Éñ„Éº„Éà„Ç≠„É£„É≥„Éó') || u.name.includes('NHBC')) return 'NHBC';
                    return u.name.substring(0, 8);
                });
                upsaleDisplay = upsaleNames.join(' + ');
            }

            return `
                <div class="member-list-item" onclick="openMemberDetail('${member.id}')" style="${opacity}">
                    <div class="member-id">${member.id}</div>
                    <div class="member-name">${member.name}</div>
                    <div class="member-status ${statusClass}">${statusLabel}</div>
                    <div class="member-team ${teamClass}">${teamLabel}</div>
                    <div class="ltv-display">¬•${member.ltv.toLocaleString()}</div>
                    <div class="upsale-display">${upsaleDisplay}</div>
                    <div class="total-ltv-display">¬•${member.totalLTV.toLocaleString()}</div>
                </div>
            `;
        }

        // „É°„É≥„Éê„Éº‰∏ÄË¶ß„ÅÆÊèèÁîª
        function renderMembers() {
            try {
                console.log('renderMembersÈñãÂßã, filteredMembersÊï∞:', filteredMembers ? filteredMembers.length : 'undefined');
                const grid = document.getElementById('memberGrid');
                
                if (!grid) {
                    console.error('memberGridË¶ÅÁ¥†„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì');
                    return;
                }
                
                if (!filteredMembers || filteredMembers.length === 0) {
                    console.log('filteredMembers„ÅåÁ©∫„Åß„Åô');
                    grid.innerHTML = '<div style="text-align:center; padding:50px;">„É°„É≥„Éê„Éº„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</div>';
                    return;
                }
                
                console.log('ÊúÄÂàù„ÅÆ„É°„É≥„Éê„Éº:', filteredMembers[0]);
                
                // „Ç∑„É≥„Éó„É´„Å™HTMLÁîüÊàê„Åß„ÉÜ„Çπ„Éà
                let html = '';
                for (let i = 0; i < Math.min(filteredMembers.length, 10); i++) {
                    const member = filteredMembers[i];
                    html += `
                        <div style="padding: 10px; border-bottom: 1px solid #eee; display: grid; grid-template-columns: 50px 150px 100px 80px 100px 100px 120px; gap: 8px; font-size: 0.8em;">
                            <div>${member.id}</div>
                            <div>${member.name}</div>
                            <div>${member.currentStatus || member.status || '‰∏çÊòé'}</div>
                            <div>${member.threePoisonsTeam || 'Êú™Ë®≠ÂÆö'}</div>
                            <div>¬•${(member.ltv || 0).toLocaleString()}</div>
                            <div>¬•${(member.totalUpsales || 0).toLocaleString()}</div>
                            <div>¬•${(member.totalLTV || member.ltv || 0).toLocaleString()}</div>
                        </div>
                    `;
                }
                
                grid.innerHTML = html;
                console.log('„É°„É≥„Éê„ÉºË°®Á§∫ÂÆå‰∫Ü:', Math.min(filteredMembers.length, 10), 'ÂêçË°®Á§∫');
                
            } catch (error) {
                console.error('renderMembers„Ç®„É©„Éº:', error);
                const grid = document.getElementById('memberGrid');
                if (grid) {
                    grid.innerHTML = '<div style="text-align:center; padding:50px; color:red;">Ë°®Á§∫„Ç®„É©„Éº: ' + error.message + '</div>';
                }
            }
        }

        // „Éï„Ç£„É´„Çø„É™„É≥„Ç∞
        function filterMembers() {
            const searchTerm = document.getElementById('searchBox').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            const teamFilter = document.getElementById('teamFilter').value;

            filteredMembers = membersDatabase.filter(member => {
                const matchesSearch = member.name.toLowerCase().includes(searchTerm);
                const matchesStatus = !statusFilter || member.currentStatus === statusFilter;
                const matchesTeam = !teamFilter || member.threePoisonsTeam === teamFilter;
                
                // „Ç¢„ÇØ„ÉÜ„Ç£„Éñ„É°„É≥„Éê„Éº„ÅÆ„ÅøË°®Á§∫„Éï„Ç£„É´„Çø„Éº
                const isActive = member.currentStatus === 'Âπ¥Èñì' || member.currentStatus === 'ÈÄöÂ∏∏';
                const matchesActiveFilter = !showActiveOnly || isActive;
                
                return matchesSearch && matchesStatus && matchesTeam && matchesActiveFilter;
            });

            sortMembers();
        }

        // „ÇΩ„Éº„Éà
        function sortMembers() {
            const sortBy = document.getElementById('sortBy').value;

            filteredMembers.sort((a, b) => {
                switch(sortBy) {
                    case 'id':
                        return a.id.localeCompare(b.id);
                    case 'ltv':
                        return b.totalLTV - a.totalLTV;
                    case 'ltvLow':
                        return a.totalLTV - b.totalLTV;
                    case 'joinDate':
                        return new Date(b.joinDate) - new Date(a.joinDate);
                    case 'subscription':
                        const aMonths = a.regularJoinDate ? Math.floor((new Date() - new Date(a.regularJoinDate)) / (1000 * 60 * 60 * 24 * 30)) : 0;
                        const bMonths = b.regularJoinDate ? Math.floor((new Date() - new Date(b.regularJoinDate)) / (1000 * 60 * 60 * 24 * 30)) : 0;
                        return bMonths - aMonths;
                    case 'events':
                        return b.events - a.events;
                    case 'name':
                        return a.name.localeCompare(b.name, 'ja');
                    default:
                        return a.id.localeCompare(b.id);
                }
            });

            renderMembers();
            updateStats();
        }

        // Áµ±Ë®à„ÅÆÊõ¥Êñ∞
        function updateStats() {
            const total = filteredMembers.length;
            const annual = filteredMembers.filter(m => m.currentStatus === 'Âπ¥Èñì').length;
            const regular = filteredMembers.filter(m => m.currentStatus === 'ÈÄöÂ∏∏').length;
            const trialEnded = filteredMembers.filter(m => m.currentStatus === '‰ΩìÈ®ìÁµÇ‰∫Ü').length;
            const churned = filteredMembers.filter(m => m.currentStatus === 'ÈÄÄ‰ºö').length;
            
            // ÁèæÂΩπ‰ºöÂì°ÔºàÂπ¥Èñì+ÈÄöÂ∏∏Ôºâ„ÅÆLTV
            const activeLTV = filteredMembers
                .filter(m => m.currentStatus === 'Âπ¥Èñì' || m.currentStatus === 'ÈÄöÂ∏∏')
                .reduce((sum, m) => sum + m.ltv, 0);

            // ‰ªäÊúà„ÉªÊù•Êúà„ÅÆÊõ¥Êñ∞‰∫àÂÆöËÄÖÁµ±Ë®à
            const today = new Date();
            const currentMonth = today.getMonth() + 1;
            const nextMonth = currentMonth === 12 ? 1 : currentMonth + 1;
            
            const thisMonthRenewals = filteredMembers.filter(m => {
                if (m.currentStatus !== 'Âπ¥Èñì' || !m.renewalDate) return false;
                const renewalDate = new Date(m.renewalDate);
                return renewalDate.getMonth() + 1 === currentMonth;
            }).length;
            
            const nextMonthRenewals = filteredMembers.filter(m => {
                if (m.currentStatus !== 'Âπ¥Èñì' || !m.renewalDate) return false;
                const renewalDate = new Date(m.renewalDate);
                return renewalDate.getMonth() + 1 === nextMonth;
            }).length;

            // ‰ªäÊúà„ÉªÊù•Êúà„ÅÆÂ£≤‰∏ä‰∫àÂÆöË®àÁÆó
            const thisMonthRevenue = thisMonthRenewals * 220000; // Âπ¥ÈñìÊõ¥Êñ∞ ¬•220,000
            const nextMonthRevenue = nextMonthRenewals * 220000;

            // ÈÄöÂ∏∏‰ºöÂì°„ÅÆÊúàÈ°çÂ£≤‰∏ä„ÇÇÂä†ÁÆó
            const currentRegularMembers = filteredMembers.filter(m => m.currentStatus === 'ÈÄöÂ∏∏').length;
            const thisMonthTotalRevenue = thisMonthRevenue + (currentRegularMembers * 22000);
            const nextMonthTotalRevenue = nextMonthRevenue + (currentRegularMembers * 22000);

            // „É°„É≥„Éê„ÉºÊï∞Êé®ÁßªË®àÁÆó
            const currentActiveMembers = annual + regular;
            const today = new Date();
            const currentMonthKey = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}`;
            const lastMonthKey = today.getMonth() === 0 ? 
                `${today.getFullYear() - 1}-12` : 
                `${today.getFullYear()}-${String(today.getMonth()).padStart(2, '0')}`;
            const lastYearKey = `${today.getFullYear() - 1}-${String(today.getMonth() + 1).padStart(2, '0')}`;

            const lastMonthData = memberGrowthData[lastMonthKey];
            const lastYearData = memberGrowthData[lastYearKey];

            const monthlyGrowth = lastMonthData ? 
                currentActiveMembers - (lastMonthData.annual + lastMonthData.regular) : 0;
            const yearlyGrowth = lastYearData ? 
                currentActiveMembers - (lastYearData.annual + lastYearData.regular) : 0;
            const growthRate = lastMonthData ? 
                ((currentActiveMembers - (lastMonthData.annual + lastMonthData.regular)) / (lastMonthData.annual + lastMonthData.regular) * 100) : 0;

            // ‰∏âÊØí„ÉÅ„Éº„É†Áµ±Ë®à
            const greedCount = filteredMembers.filter(m => m.threePoisonsTeam === 'Ë≤™Ê¨≤').length;
            const angerCount = filteredMembers.filter(m => m.threePoisonsTeam === 'ÁûãÊÅö').length;
            const ignoranceCount = filteredMembers.filter(m => m.threePoisonsTeam === 'ÊÑöÁó¥').length;
            const noTeamCount = filteredMembers.filter(m => m.threePoisonsTeam === '„Å™„Åó').length;
            const unassignedCount = filteredMembers.filter(m => m.threePoisonsTeam === 'Êú™Ë®≠ÂÆö').length;

            // Áµ±Ë®à„ÇíÊõ¥Êñ∞
            document.getElementById('total-members').textContent = total;
            document.getElementById('annual-members').textContent = annual;
            document.getElementById('regular-members').textContent = regular;
            document.getElementById('trial-ended-members').textContent = trialEnded;
            document.getElementById('churned-members').textContent = churned;
            document.getElementById('active-ltv').textContent = `¬•${(activeLTV / 1000000).toFixed(1)}M`;

            // Êõ¥Êñ∞‰∫àÂÆö„ÉªÂ£≤‰∏äÁµ±Ë®à„ÇíÊõ¥Êñ∞
            document.getElementById('this-month-count').textContent = thisMonthRenewals;
            document.getElementById('next-month-count').textContent = nextMonthRenewals;
            document.getElementById('this-month-revenue').textContent = `¬•${(thisMonthTotalRevenue / 1000).toFixed(0)}K`;
            document.getElementById('next-month-revenue').textContent = `¬•${(nextMonthTotalRevenue / 1000).toFixed(0)}K`;

            // „É°„É≥„Éê„ÉºÊï∞Êé®ÁßªÁµ±Ë®à„ÇíÊõ¥Êñ∞
            document.getElementById('current-active-members').textContent = currentActiveMembers;
            document.getElementById('monthly-growth').textContent = monthlyGrowth >= 0 ? `+${monthlyGrowth}` : monthlyGrowth;
            document.getElementById('yearly-growth').textContent = yearlyGrowth >= 0 ? `+${yearlyGrowth}` : yearlyGrowth;
            document.getElementById('growth-rate').textContent = `${growthRate.toFixed(1)}%`;

            // ‰∏âÊØí„ÉÅ„Éº„É†Áµ±Ë®à„ÇíÊõ¥Êñ∞
            document.getElementById('greed-count').textContent = greedCount;
            document.getElementById('anger-count').textContent = angerCount;
            document.getElementById('ignorance-count').textContent = ignoranceCount;
            document.getElementById('no-team-count').textContent = noTeamCount;
            document.getElementById('unassigned-count').textContent = unassignedCount;
        }

        // „É°„É≥„Éê„ÉºË©≥Á¥∞„ÇíÈñã„Åè
        function openMemberDetail(memberId) {
            const member = membersDatabase.find(m => m.id === memberId);
            if (member) {
                // „É°„É≥„Éê„Éº„Éá„Éº„Çø„ÇílocalStorage„Å´‰øùÂ≠ò
                localStorage.setItem(`member_${memberId}`, JSON.stringify(member));
                
                // Ë©≥Á¥∞„Éö„Éº„Ç∏„Å´ÈÅ∑Áßª
                window.open(`member_detail.html?id=${memberId}`, '_blank');
            }
        }

        // Êñ∞„Åó„ÅÑ„É°„É≥„Éê„Éº„ÇíËøΩÂä†
        function addNewMember() {
            const name = prompt('Êñ∞„Åó„ÅÑ„É°„É≥„Éê„Éº„ÅÆÂêçÂâç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ:');
            if (name && name.trim()) {
                const newMember = {
                    id: `M${String(membersDatabase.length + 1).padStart(3, '0')}`,
                    name: name.trim(),
                    status: 'trial',
                    joinDate: new Date().toISOString().split('T')[0],
                    ltv: 5000,
                    lastActive: new Date().toISOString().split('T')[0],
                    events: 0
                };
                membersDatabase.push(newMember);
                filterMembers();
                alert(`${name}„Åï„Çì„ÇíËøΩÂä†„Åó„Åæ„Åó„ÅüÔºÅ`);
            }
        }
    </script>
</body>
</html>
