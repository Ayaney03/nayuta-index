<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç„¡æ˜ä¼š ãƒ¡ãƒ³ãƒãƒ¼ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Hiragino Kaku Gothic ProN', 'Yu Gothic', 'Meiryo', sans-serif;
            background: linear-gradient(135deg, #f8f6f3 0%, #fff8dc 50%, #f5e6a3 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 1.8em;
            margin-bottom: 10px;
        }

        .controls {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .search-box {
            flex: 1;
            min-width: 250px;
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 0.9em;
        }

        .filter-select {
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            background: white;
            font-size: 0.9em;
        }

        .stats-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }

        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 6px;
            text-align: center;
            border: 1px solid #e9ecef;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.85em;
            color: #6c757d;
        }

        .member-grid {
            background: white;
            border-radius: 8px;
            margin: 20px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .member-list-header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 8px 15px;
            display: grid;
            grid-template-columns: 50px 140px 100px 80px 100px 100px 120px;
            gap: 8px;
            font-weight: bold;
            font-size: 0.75em;
            text-align: center;
        }

        .member-list-item {
            display: grid;
            grid-template-columns: 50px 140px 100px 80px 100px 100px 120px;
            gap: 8px;
            padding: 6px 15px;
            border-bottom: 1px solid #e9ecef;
            cursor: pointer;
            transition: background-color 0.2s;
            font-size: 0.7em;
            align-items: center;
        }

        .member-list-item:hover {
            background-color: #f8f9fa;
        }

        .member-list-item:last-child {
            border-bottom: none;
        }

        .member-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .member-name {
            font-weight: 500;
            color: #333;
        }

        .member-id {
            font-size: 0.7em;
            color: #666;
            background: #f8f9fa;
            padding: 2px 4px;
            border-radius: 3px;
            text-align: center;
        }

        .member-team {
            font-size: 0.7em;
            padding: 2px 4px;
            border-radius: 3px;
            text-align: center;
            font-weight: 500;
        }

        .team-è²ªæ¬² { 
            background: #fff9c4; 
            color: #795548; 
            border: 1px solid #ffeb3b; 
        }
        
        .team-ç‹æš { 
            background: #ffebee; 
            color: #b71c1c; 
            border: 1px solid #f44336; 
        }
        
        .team-æ„šç—´ { 
            background: #e8f5e8; 
            color: #2e7d32; 
            border: 1px solid #4caf50; 
        }
        
        .team-ãªã— { 
            background: #e9ecef; 
            color: #6c757d; 
            border: 1px solid #6c757d; 
        }
        
        .team-æœªè¨­å®š { 
            background: #fff; 
            color: #999; 
            border: 1px solid #dee2e6; 
        }

        .join-date {
            font-size: 0.7em;
            color: #666;
            text-align: center;
        }

        .last-active {
            font-size: 0.7em;
            color: #666;
            text-align: center;
        }

        .member-status {
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 0.7em;
            font-weight: bold;
            text-align: center;
        }

        .status-å¹´é–“, .status-é€šå¸¸ {
            background: #f8f9fa;
            color: #495057;
            border: 1px solid #dee2e6;
        }

        .status-ä½“é¨“çµ‚äº†, .status-é€€ä¼š {
            background: #495057;
            color: #fff;
            border: 1px solid #343a40;
        }

        .status-ä¸æ˜ {
            background: #e9ecef;
            color: #6c757d;
            border: 1px solid #6c757d;
        }

        .member-details {
            font-size: 0.85em;
            line-height: 1.5;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .detail-label {
            color: #6c757d;
        }

        .detail-value {
            font-weight: 500;
            color: #2c3e50;
        }

        .ltv-display {
            text-align: right;
            font-weight: 600;
            color: #1976d2;
            font-size: 0.7em;
        }

        .upsale-display {
            text-align: center;
            font-size: 0.65em;
            color: #e91e63;
            font-weight: 500;
        }

        .total-ltv-display {
            text-align: right;
            font-weight: bold;
            color: #2e7d32;
            font-size: 0.75em;
            margin-top: 10px;
            font-size: 0.9em;
        }

        .add-member-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #d4af37;
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 1.5em;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(212, 175, 55, 0.4);
            transition: all 0.3s ease;
        }

        .add-member-btn:hover {
            transform: scale(1.1);
            background: #b8860b;
        }

        .hidden {
            display: none;
        }

        .highlight {
            background-color: yellow;
            font-weight: bold;
        }

        /* æ›´æ–°æœŸé™ã‚¢ãƒ©ãƒ¼ãƒˆè‰² */
        .renewal-overdue { 
            background: #dc3545 !important; 
            color: white !important; 
        }
        
        .renewal-soon { 
            background: #fd7e14 !important; 
            color: white !important; 
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ & çµ±è¨ˆã‚¨ãƒªã‚¢ï¼ˆ2ã‚«ãƒ©ãƒ ï¼‰ -->
        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 20px; margin: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 12px; color: white;">
            <!-- å·¦ã‚«ãƒ©ãƒ ï¼šã‚¿ã‚¤ãƒˆãƒ« -->
            <div>
                <h1 style="font-size: 1.8em; margin: 0 0 8px 0;">ğŸ‘¥ ç„¡æ˜ä¼š</h1>
                <h2 style="font-size: 1.2em; margin: 0 0 12px 0; opacity: 0.9;">ãƒ¡ãƒ³ãƒãƒ¼ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</h2>
                <p style="margin: 0; opacity: 0.8; font-size: 0.9em;">ãƒ¡ãƒ³ãƒãƒ¼ç®¡ç†ãƒ»LTVåˆ†æã‚·ã‚¹ãƒ†ãƒ </p>
            </div>
            
            <!-- å³ã‚«ãƒ©ãƒ ï¼šçµ±è¨ˆ -->
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
                <div style="background: rgba(255,255,255,0.15); padding: 12px; border-radius: 8px; text-align: center; backdrop-filter: blur(10px);">
                    <div style="font-size: 1.4em; font-weight: bold;" id="total-members">110</div>
                    <div style="font-size: 0.75em; opacity: 0.9;">ğŸ‘¥ ç·ãƒ¡ãƒ³ãƒãƒ¼</div>
                </div>
                <div style="background: rgba(255,255,255,0.15); padding: 12px; border-radius: 8px; text-align: center; backdrop-filter: blur(10px);">
                    <div style="font-size: 1.4em; font-weight: bold;" id="annual-members">0</div>
                    <div style="font-size: 0.75em; opacity: 0.9;">ğŸ’ å¹´é–“ä¼šå“¡</div>
                </div>
                <div style="background: rgba(255,255,255,0.15); padding: 12px; border-radius: 8px; text-align: center; backdrop-filter: blur(10px);">
                    <div style="font-size: 1.4em; font-weight: bold;" id="regular-members">0</div>
                    <div style="font-size: 0.75em; opacity: 0.9;">â­ é€šå¸¸ä¼šå“¡</div>
                </div>
                <div style="background: rgba(255,255,255,0.15); padding: 12px; border-radius: 8px; text-align: center; backdrop-filter: blur(10px);">
                    <div style="font-size: 1.4em; font-weight: bold;" id="trial-ended-members">0</div>
                    <div style="font-size: 0.75em; opacity: 0.9;">â° ä½“é¨“çµ‚äº†</div>
                </div>
                <div style="background: rgba(255,255,255,0.15); padding: 12px; border-radius: 8px; text-align: center; backdrop-filter: blur(10px);">
                    <div style="font-size: 1.4em; font-weight: bold;" id="churned-members">0</div>
                    <div style="font-size: 0.75em; opacity: 0.9;">âŒ é€€ä¼š</div>
                </div>
                <div style="background: rgba(255,255,255,0.15); padding: 12px; border-radius: 8px; text-align: center; backdrop-filter: blur(10px);">
                    <div style="font-size: 1.4em; font-weight: bold;" id="active-ltv">Â¥0M</div>
                    <div style="font-size: 0.75em; opacity: 0.9;">ğŸ’° ç¾å½¹LTV</div>
                </div>
            </div>
        </div>

        <!-- ğŸ’° å£²ä¸Šãƒ»æ›´æ–°äºˆå®š -->
        <div style="background: #fff3e0; padding: 12px; margin: 15px 20px; border-radius: 8px; border-left: 4px solid #ff9800;">
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; font-size: 0.8em;">
                <div style="background: white; padding: 8px; border-radius: 4px; text-align: center;">
                    <div style="font-weight: bold; color: #007bff; font-size: 1em;" id="this-month-count">0</div>
                    <div style="font-size: 0.75em;">ğŸ“… ä»Šæœˆæ›´æ–°äºˆå®š</div>
                </div>
                <div style="background: white; padding: 8px; border-radius: 4px; text-align: center;">
                    <div style="font-weight: bold; color: #ffc107; font-size: 1em;" id="next-month-count">0</div>
                    <div style="font-size: 0.75em;">ğŸ“… æ¥æœˆæ›´æ–°äºˆå®š</div>
                </div>
                <div style="background: white; padding: 8px; border-radius: 4px; text-align: center;">
                    <div style="font-weight: bold; color: #28a745; font-size: 1em;" id="this-month-revenue">Â¥0</div>
                    <div style="font-size: 0.75em;">ğŸ’° ä»Šæœˆå£²ä¸Šäºˆå®š</div>
                </div>
                <div style="background: white; padding: 8px; border-radius: 4px; text-align: center;">
                    <div style="font-weight: bold; color: #17a2b8; font-size: 1em;" id="next-month-revenue">Â¥0</div>
                    <div style="font-size: 0.75em;">ğŸ’¸ æ¥æœˆå£²ä¸Šè¦‹è¾¼ã¿</div>
                </div>
            </div>
        </div>

        <!-- ğŸ“ˆ ãƒ¡ãƒ³ãƒãƒ¼æ•°æ¨ç§» -->
        <div style="background: #e8f5e8; padding: 12px; margin: 15px 20px; border-radius: 8px; border-left: 4px solid #28a745;">
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; font-size: 0.8em;">
                <div style="background: white; padding: 8px; border-radius: 4px; text-align: center;">
                    <div style="font-weight: bold; color: #007bff; font-size: 1em;" id="current-active-members">0</div>
                    <div style="font-size: 0.75em;">ğŸ‘¥ ç¾å½¹ä¼šå“¡æ•°</div>
                </div>
                <div style="background: white; padding: 8px; border-radius: 4px; text-align: center;">
                    <div style="font-weight: bold; color: #28a745; font-size: 1em;" id="monthly-growth">+0</div>
                    <div style="font-size: 0.75em;">ğŸ“Š å‰æœˆæ¯”å¢—æ¸›</div>
                </div>
                <div style="background: white; padding: 8px; border-radius: 4px; text-align: center;">
                    <div style="font-weight: bold; color: #17a2b8; font-size: 1em;" id="yearly-growth">+0</div>
                    <div style="font-size: 0.75em;">ğŸ“ˆ å‰å¹´åŒæœˆæ¯”</div>
                </div>
                <div style="background: white; padding: 8px; border-radius: 4px; text-align: center;">
                    <div style="font-weight: bold; color: #6f42c1; font-size: 1em;" id="growth-rate">0%</div>
                    <div style="font-size: 0.75em;">ğŸ“ æœˆé–“æˆé•·ç‡</div>
                </div>
            </div>
        </div>

        <!-- ä¸‰æ¯’ãƒãƒ¼ãƒ çµ±è¨ˆ -->
        <div style="background: #f8f9fa; padding: 15px; margin: 15px 20px; border-radius: 8px; border-left: 4px solid #6f42c1;">
            <h3 style="color: #6f42c1; margin-bottom: 10px; font-size: 1em;">ğŸ”® ä¸‰æ¯’ãƒãƒ¼ãƒ åˆ†å¸ƒ</h3>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 10px; font-size: 0.85em;">
                <div style="background: #fff3cd; padding: 8px; border-radius: 4px; text-align: center; border: 2px solid #ffc107;">
                    <div style="font-weight: bold; color: #856404;" id="greed-count">0</div>
                    <div>è²ªæ¬²ãƒãƒ¼ãƒ </div>
                </div>
                <div style="background: #f8d7da; padding: 8px; border-radius: 4px; text-align: center; border: 2px solid #dc3545;">
                    <div style="font-weight: bold; color: #721c24;" id="anger-count">0</div>
                    <div>ç‹æšãƒãƒ¼ãƒ </div>
                </div>
                <div style="background: #d4edda; padding: 8px; border-radius: 4px; text-align: center; border: 2px solid #28a745;">
                    <div style="font-weight: bold; color: #155724;" id="ignorance-count">0</div>
                    <div>æ„šç—´ãƒãƒ¼ãƒ </div>
                </div>
                <div style="background: #e9ecef; padding: 8px; border-radius: 4px; text-align: center; border: 2px solid #6c757d;">
                    <div style="font-weight: bold; color: #6c757d;" id="no-team-count">0</div>
                    <div>æœªæ‰€å±</div>
                </div>
                <div style="background: white; padding: 8px; border-radius: 4px; text-align: center; border: 2px solid #dee2e6;">
                    <div style="font-weight: bold; color: #999;" id="unassigned-count">0</div>
                    <div>æœªè¨­å®š</div>
                </div>
            </div>
        </div>

        <!-- æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
        <div class="controls">
            <input type="text" id="searchBox" class="search-box" placeholder="ğŸ” ãƒ¡ãƒ³ãƒãƒ¼åã§æ¤œç´¢...">
            <select id="statusFilter" class="filter-select">
                <option value="">å…¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</option>
                <option value="å¹´é–“">å¹´é–“ä¼šå“¡</option>
                <option value="é€šå¸¸">é€šå¸¸ä¼šå“¡</option>
                <option value="ä½“é¨“çµ‚äº†">ä½“é¨“çµ‚äº†</option>
                <option value="é€€ä¼š">é€€ä¼š</option>
            </select>
            <select id="sortBy" class="filter-select">
                <option value="id">IDé †</option>
                <option value="name">åå‰é †ï¼ˆã‚ã„ã†ãˆãŠï¼‰</option>
                <option value="ltv">LTVé«˜ã„é †</option>
                <option value="ltvLow">LTVä½ã„é †</option>
                <option value="joinDate">å…¥ä¼šæ—¥é †</option>
                <option value="subscription">ã‚µãƒ–ã‚¹ã‚¯æœŸé–“é•·ã„é †</option>
                <option value="events">å‚åŠ ã‚¤ãƒ™ãƒ³ãƒˆå¤šã„é †</option>
            </select>
            <select id="teamFilter" class="filter-select">
                <option value="">å…¨ãƒãƒ¼ãƒ </option>
                <option value="è²ªæ¬²">è²ªæ¬²ãƒãƒ¼ãƒ </option>
                <option value="ç‹æš">ç‹æšãƒãƒ¼ãƒ </option>
                <option value="æ„šç—´">æ„šç—´ãƒãƒ¼ãƒ </option>
                <option value="ãªã—">ãƒãƒ¼ãƒ æœªæ‰€å±</option>
            </select>
            <button id="rankingBtn" class="filter-select" style="background: #6f42c1; color: white; border: none; cursor: pointer;">ğŸ† LTVãƒ©ãƒ³ã‚­ãƒ³ã‚°</button>
            <button id="activeOnlyBtn" class="filter-select" style="background: #28a745; color: white; border: none; cursor: pointer;">ğŸ‘¥ ç¾å½¹ä¼šå“¡ã®ã¿</button>
            <button id="renewalAlertBtn" class="filter-select" style="background: #ff6b35; color: white; border: none; cursor: pointer;">âš ï¸ æ›´æ–°é–“è¿‘</button>
        </div>

        <!-- ãƒ¡ãƒ³ãƒãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ« -->
        <div class="member-grid">
            <div class="member-list-header">
                <div>ID</div>
                <div>åå‰</div>
                <div>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</div>
                <div>ãƒãƒ¼ãƒ </div>
                <div>åŸºæœ¬LTV</div>
                <div>ã‚¢ãƒƒãƒ—ã‚»ãƒ«</div>
                <div>ç·LTV</div>
            </div>
            <div id="memberGrid">
                <!-- ãƒ¡ãƒ³ãƒãƒ¼ãƒªã‚¹ãƒˆãŒã“ã“ã«å‹•çš„ã«ç”Ÿæˆã•ã‚Œã¾ã™ -->
            </div>
        </div>
    </div>

    <button class="add-member-btn" onclick="addNewMember()">+</button>

    <script src="three_poisons_team_mapping.js"></script>
    <script>
        // é€šå¸¸ä¼šå“¡ã«ãªã£ãŸæ—¥ï¼ˆæ­£è¦æ”¯æ‰•ã„é–‹å§‹æ—¥ï¼‰é…åˆ—ï¼ˆM001ã‹ã‚‰é †ç•ªï¼‰
        const regularJoinDateArray = [
            '', // M001 (é€€ä¼š)
            '', // M002 (ä½“é¨“çµ‚äº†)
            '2024-01-26', // M003 (å¹´é–“)
            '2024-02-04', // M004 (å¹´é–“)
            '2024-01-25', // M005 (é€šå¸¸)
            '', // M006 (ä½“é¨“çµ‚äº†)
            '2024-01-26', // M007 (é€šå¸¸)
            '', // M008 (é€€ä¼š)
            '2024-02-29', // M009 (é€šå¸¸)
            '', // M010 (é€€ä¼š)
            '', // M011 (é€€ä¼š)
            '2024-01-25', // M012 (å¹´é–“)
            '', // M013 (ä½“é¨“çµ‚äº†)
            '2024-02-13', // M014 (å¹´é–“)
            '', // M015 (é€€ä¼š)
            '', // M016 (é€€ä¼š)
            '', // M017 (é€€ä¼š)
            '', // M018 (ä½“é¨“çµ‚äº†)
            '', // M019 (é€€ä¼š)
            '', // M020 (ä½“é¨“çµ‚äº†)
            '2024-01-25', // M021 (é€šå¸¸)
            '', // M022 (é€€ä¼š)
            '2024-01-25', // M023 (å¹´é–“)
            '2024-01-25', // M024 (é€šå¸¸)
            '2024-01-29', // M025 (é€šå¸¸)
            '2024-01-30', // M026 (å¹´é–“)
            '', // M027 (ä½“é¨“çµ‚äº†)
            '', // M028 (ä½“é¨“çµ‚äº†)
            '', // M029 (ä½“é¨“çµ‚äº†)
            '2024-01-31', // M030 (é€šå¸¸)
            '', // M031 (é€€ä¼š)
            '', // M032 (ä½“é¨“çµ‚äº†)
            '2024-02-01', // M033 (é€šå¸¸)
            '', // M034 (é€€ä¼š)
            '', // M035 (ä½“é¨“çµ‚äº†)
            '', // M036 (ä½“é¨“çµ‚äº†)
            '', // M037 (é€€ä¼š)
            '', // M038 (ä½“é¨“çµ‚äº†)
            '', // M039 (é€€ä¼š)
            '', // M040 (ä½“é¨“çµ‚äº†)
            '', // M041 (ä½“é¨“çµ‚äº†)
            '', // M042 (ä½“é¨“çµ‚äº†)
            '', // M043 (ä½“é¨“çµ‚äº†)
            '2024-02-01', // M044 (å¹´é–“)
            '', // M045 (ä½“é¨“çµ‚äº†)
            '', // M046 (ä½“é¨“çµ‚äº†)
            '', // M047 (ä½“é¨“çµ‚äº†)
            '', // M048 (ä½“é¨“çµ‚äº†)
            '2024-02-28', // M049 (é€šå¸¸)
            '', // M050 (ä½“é¨“çµ‚äº†)
            '', // M051 (é€€ä¼š)
            '', // M052 (ä½“é¨“çµ‚äº†)
            '', // M053 (ä½“é¨“çµ‚äº†)
            '2024-05-15', // M054 (å¹´é–“)
            '2024-06-18', // M055 (é€šå¸¸)
            '', // M056 (é€€ä¼š)
            '2024-07-01', // M057 (é€šå¸¸)
            '2024-06-24', // M058 (é€šå¸¸)
            '2024-11-08', // M059 (å¹´é–“)
            '2024-05-18', // M060 (é€šå¸¸)
            '', // M061 (é€€ä¼š)
            '2024-05-24', // M062 (é€šå¸¸)
            '2024-06-03', // M063 (å¹´é–“)
            '2024-06-14', // M064 (å¹´é–“)
            '', // M065 (é€€ä¼š)
            '', // M066 (ä½“é¨“çµ‚äº†)
            '2024-07-23', // M067 (é€šå¸¸)
            '2024-08-22', // M068 (å¹´é–“)
            '2024-09-07', // M069 (é€šå¸¸)
            '2024-10-27', // M070 (é€šå¸¸)
            '', // M071 (é€€ä¼š)
            '2024-10-02', // M072 (é€šå¸¸)
            '2024-10-24', // M073 (å¹´é–“)
            '2024-10-24', // M074 (é€šå¸¸)
            '', // M075 (é€€ä¼š)
            '', // M076 (ä½“é¨“çµ‚äº†)
            '2024-10-24', // M077 (é€šå¸¸)
            '2024-11-28', // M078 (å¹´é–“)
            '2024-10-24', // M079 (å¹´é–“)
            '2024-10-25', // M080 (é€šå¸¸)
            '2024-10-26', // M081 (é€šå¸¸)
            '', // M082 (é€€ä¼š)
            '', // M083 (ä½“é¨“çµ‚äº†)
            '', // M084 (ä½“é¨“çµ‚äº†)
            '', // M085 (é€€ä¼š)
            '', // M086 (ä½“é¨“çµ‚äº†)
            '', // M087 (ä½“é¨“çµ‚äº†)
            '', // M088 (ä½“é¨“çµ‚äº†)
            '', // M089 (ä½“é¨“çµ‚äº†)
            '2024-10-25', // M090 (é€šå¸¸)
            '', // M091 (ä½“é¨“çµ‚äº†)
            '', // M092 (ä½“é¨“çµ‚äº†)
            '2024-11-26', // M093 (é€šå¸¸)
            '', // M094 (é€€ä¼š)
            '2024-10-26', // M095 (é€šå¸¸)
            '2024-10-26', // M096 (å¹´é–“)
            '', // M097 (é€€ä¼š)
            '2024-10-26', // M098 (å¹´é–“)
            '', // M099 (é€€ä¼š)
            '2024-11-19', // M100 (é€šå¸¸)
            '2024-11-12', // M101 (å¹´é–“)
            '', // M102 (ä½“é¨“çµ‚äº†)
            '2024-10-26', // M103 (å¹´é–“)
            '2024-11-02', // M104 (é€šå¸¸)
            '', // M105 (é€€ä¼š)
            '2024-10-29', // M106 (é€šå¸¸)
            '', // M107 (é€€ä¼š)
            '', // M108 (é€€ä¼š)
            '2024-11-19', // M109 (å¹´é–“)
            '', // M110 (é€€ä¼š)
            '', // M111 (é€€ä¼š)
            '2025-01-16', // M112 (é€šå¸¸)
            '2025-02-15', // M113 (é€šå¸¸)
            '', // M114 (ä½“é¨“çµ‚äº†)
            '', // M115 (ä½“é¨“çµ‚äº†)
            '2025-01-17', // M116 (é€šå¸¸)
            '2025-01-18', // M117 (é€šå¸¸)
            '2025-01-19', // M118 (é€šå¸¸)
            '', // M119 (ä½“é¨“çµ‚äº†)
            '2025-01-19', // M120 (é€šå¸¸)
            '2025-02-28' // M121 (é€šå¸¸)
        ];

        // å¾¹åº•ç²¾é€²è³¼å…¥è€…ãƒªã‚¹ãƒˆ
        const tesseiShinPurchasers = [
            'æ¸¡é‚‰æ™ºå¤§', 'æ¾æ‘é¼æ²³', 'ä½è—¤ä¸€æ°—', 'å°å³¶å•“è¼”', 'å†…é‡çœŸå­',
            'å·¾å´ç”±ç´€å­', 'å‚æœ¬ç ”å¤ªæœ—', 'è–„ç”°äº¬', 'å±±ç”°å¤§å°†', 'æ·ºåˆ©å‹‡æ–—',
            'ç‰‡å±±è£•å­', 'ä¸Šæ‘å¾¹é›„', 'ä»Šé‡å¤§è¼”', 'ä»Šäº•å¥ä»‹', 'æ¾æœ¬ç«œå­£',
            'å®‰ç”°æ»‰ä¸€', 'å°¾å´å‹‡å“‰', 'æ¾ç”°é™½å¹³'
        ];

        // NHãƒ–ãƒ¼ãƒˆã‚­ãƒ£ãƒ³ãƒ—è³¼å…¥è€…ãƒªã‚¹ãƒˆ
        const nhBootcampPurchasers = [
            { name: 'éˆ´æœ¨æ™ºå¼˜', date: '2025-07-12', product: 'NHãƒ–ãƒ¼ãƒˆã‚­ãƒ£ãƒ³ãƒ— åŠå¹´ã‚³ãƒ¼ã‚¹ãƒ»ãƒãƒ¼ãƒãƒ«ãƒ—ãƒ©ãƒ³', amount: 29880 },
            { name: 'å†…é‡çœŸå­', date: '2025-07-13', product: 'NHãƒ–ãƒ¼ãƒˆã‚­ãƒ£ãƒ³ãƒ— åŠå¹´ã‚³ãƒ¼ã‚¹ãƒ»ãƒãƒ¼ãƒãƒ«ãƒ—ãƒ©ãƒ³', amount: 29880 },
            { name: 'å°¾å´å‹‡å“‰', date: '2025-07-21', product: 'NHãƒ–ãƒ¼ãƒˆã‚­ãƒ£ãƒ³ãƒ— 1å¹´ã‚³ãƒ¼ã‚¹ãƒ»ãƒãƒ¼ãƒãƒ«ãƒ—ãƒ©ãƒ³', amount: 49800 },
            { name: 'æ¾æ‘é¼æ²³', date: '2025-07-22', product: 'NHãƒ–ãƒ¼ãƒˆã‚­ãƒ£ãƒ³ãƒ— åŠå¹´ã‚³ãƒ¼ã‚¹ãƒ»ãƒãƒ¼ãƒãƒ«ãƒ—ãƒ©ãƒ³', amount: 29880 },
            { name: 'è–„ç”°äº¬', date: '2025-07-23', product: 'NHãƒ–ãƒ¼ãƒˆã‚­ãƒ£ãƒ³ãƒ— 1å¹´ã‚³ãƒ¼ã‚¹ãƒ»ãƒãƒ¼ãƒãƒ«ãƒ—ãƒ©ãƒ³', amount: 49800 },
            { name: 'æ¸¡é‚‰æ™ºå¤§', date: '2025-07-27', product: 'ç„¡æ˜ä¼š_NHãƒ–ãƒ¼ãƒˆã‚­ãƒ£ãƒ³ãƒ—_å…¥ä¼šè²»', amount: 30000 },
            { name: 'å±±ç”°å¤§å°†', date: '2025-07-27', product: 'NHãƒ–ãƒ¼ãƒˆã‚­ãƒ£ãƒ³ãƒ— åŠå¹´ã‚³ãƒ¼ã‚¹ãƒ»ãƒãƒ¼ãƒãƒ«ãƒ—ãƒ©ãƒ³', amount: 29880 },
            { name: 'æ¾ç”°é™½å¹³', date: '2025-07-16', product: 'NHBC1å¹´VIP', amount: 50000 },
            { name: 'æ¾æœ¬ç«œå­£', date: '2025-07-31', product: 'NHãƒ–ãƒ¼ãƒˆã‚­ãƒ£ãƒ³ãƒ— åŠå¹´ã‚³ãƒ¼ã‚¹ãƒ»ãƒãƒ¼ãƒãƒ«ãƒ—ãƒ©ãƒ³', amount: 29880 }
        ];

        // ç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é…åˆ—ï¼ˆM001ã‹ã‚‰é †ç•ªï¼‰
        const currentStatusArray = [
            'é€€ä¼š',      // M001
            'ä½“é¨“çµ‚äº†',  // M002
            'å¹´é–“',      // M003
            'å¹´é–“',      // M004
            'é€šå¸¸',      // M005
            'ä½“é¨“çµ‚äº†',  // M006
            'é€šå¸¸',      // M007
            'é€€ä¼š',      // M008
            'é€šå¸¸',      // M009
            'é€€ä¼š',      // M010
            'é€€ä¼š',      // M011
            'å¹´é–“',      // M012
            'ä½“é¨“çµ‚äº†',  // M013
            'å¹´é–“',      // M014
            'é€€ä¼š',      // M015
            'é€€ä¼š',      // M016
            'é€€ä¼š',      // M017
            'ä½“é¨“çµ‚äº†',  // M018
            'é€€ä¼š',      // M019
            'ä½“é¨“çµ‚äº†',  // M020
            'é€šå¸¸',      // M021
            'é€€ä¼š',      // M022
            'å¹´é–“',      // M023
            'é€šå¸¸',      // M024
            'é€šå¸¸',      // M025
            'å¹´é–“',      // M026
            'ä½“é¨“çµ‚äº†',  // M027
            'ä½“é¨“çµ‚äº†',  // M028
            'ä½“é¨“çµ‚äº†',  // M029
            'é€šå¸¸',      // M030
            'é€€ä¼š',      // M031
            'ä½“é¨“çµ‚äº†',  // M032
            'é€šå¸¸',      // M033
            'é€€ä¼š',      // M034
            'ä½“é¨“çµ‚äº†',  // M035
            'ä½“é¨“çµ‚äº†',  // M036
            'é€€ä¼š',      // M037
            'ä½“é¨“çµ‚äº†',  // M038
            'é€€ä¼š',      // M039
            'ä½“é¨“çµ‚äº†',  // M040
            'ä½“é¨“çµ‚äº†',  // M041
            'ä½“é¨“çµ‚äº†',  // M042
            'ä½“é¨“çµ‚äº†',  // M043
            'å¹´é–“',      // M044
            'ä½“é¨“çµ‚äº†',  // M045
            'ä½“é¨“çµ‚äº†',  // M046
            'ä½“é¨“çµ‚äº†',  // M047
            'ä½“é¨“çµ‚äº†',  // M048
            'é€šå¸¸',      // M049
            'ä½“é¨“çµ‚äº†',  // M050
            'é€€ä¼š',      // M051
            'ä½“é¨“çµ‚äº†',  // M052
            'ä½“é¨“çµ‚äº†',  // M053
            'å¹´é–“',      // M054
            'é€šå¸¸',      // M055
            'é€€ä¼š',      // M056
            'é€šå¸¸',      // M057
            'é€šå¸¸',      // M058
            'å¹´é–“',      // M059
            'é€šå¸¸',      // M060
            'é€€ä¼š',      // M061
            'é€šå¸¸',      // M062
            'å¹´é–“',      // M063
            'å¹´é–“',      // M064
            'é€€ä¼š',      // M065
            'ä½“é¨“çµ‚äº†',  // M066
            'é€šå¸¸',      // M067
            'å¹´é–“',      // M068
            'é€šå¸¸',      // M069
            'é€šå¸¸',      // M070
            'é€€ä¼š',      // M071
            'é€šå¸¸',      // M072
            'å¹´é–“',      // M073
            'é€šå¸¸',      // M074
            'é€€ä¼š',      // M075
            'ä½“é¨“çµ‚äº†',  // M076
            'é€šå¸¸',      // M077
            'å¹´é–“',      // M078
            'å¹´é–“',      // M079
            'é€šå¸¸',      // M080
            'é€šå¸¸',      // M081
            'é€€ä¼š',      // M082
            'ä½“é¨“çµ‚äº†',  // M083
            'ä½“é¨“çµ‚äº†',  // M084
            'é€€ä¼š',      // M085
            'ä½“é¨“çµ‚äº†',  // M086
            'ä½“é¨“çµ‚äº†',  // M087
            'ä½“é¨“çµ‚äº†',  // M088
            'ä½“é¨“çµ‚äº†',  // M089
            'é€šå¸¸',      // M090
            'ä½“é¨“çµ‚äº†',  // M091
            'ä½“é¨“çµ‚äº†',  // M092
            'é€šå¸¸',      // M093
            'é€€ä¼š',      // M094
            'é€šå¸¸',      // M095
            'å¹´é–“',      // M096
            'é€€ä¼š',      // M097
            'å¹´é–“',      // M098
            'é€€ä¼š',      // M099
            'é€šå¸¸',      // M100
            'å¹´é–“',      // M101
            'ä½“é¨“çµ‚äº†',  // M102
            'å¹´é–“',      // M103
            'é€šå¸¸',      // M104
            'é€€ä¼š',      // M105
            'é€šå¸¸',      // M106
            'é€€ä¼š',      // M107
            'é€€ä¼š',      // M108
            'å¹´é–“',      // M109
            'é€€ä¼š',      // M110
            'é€€ä¼š',      // M111
            'é€šå¸¸',      // M112
            'é€šå¸¸',      // M113
            'ä½“é¨“çµ‚äº†',  // M114
            'ä½“é¨“çµ‚äº†',  // M115
            'é€šå¸¸',      // M116
            'é€šå¸¸',      // M117
            'é€šå¸¸',      // M118
            'ä½“é¨“çµ‚äº†',  // M119
            'é€šå¸¸',      // M120
            'é€šå¸¸'       // M121
        ];

        // ãƒ¡ãƒ³ãƒãƒ¼æ•°æ¨ç§»ãƒ‡ãƒ¼ã‚¿ï¼ˆéå»12ãƒ¶æœˆåˆ†ï¼‰
        const memberGrowthData = {
            '2024-08': { total: 85, annual: 18, regular: 29, churned: 38 },
            '2024-09': { total: 88, annual: 19, regular: 31, churned: 38 },
            '2024-10': { total: 92, annual: 20, regular: 33, churned: 39 },
            '2024-11': { total: 95, annual: 20, regular: 35, churned: 40 },
            '2024-12': { total: 98, annual: 20, regular: 37, churned: 41 },
            '2025-01': { total: 102, annual: 20, regular: 40, churned: 42 },
            '2025-02': { total: 106, annual: 20, regular: 43, churned: 43 },
            '2025-03': { total: 110, annual: 20, regular: 46, churned: 44 },
            '2025-04': { total: 113, annual: 20, regular: 48, churned: 45 },
            '2025-05': { total: 116, annual: 20, regular: 50, churned: 46 },
            '2025-06': { total: 119, annual: 20, regular: 52, churned: 47 },
            '2025-07': { total: 121, annual: 20, regular: 54, churned: 47 }
        };

        // å¹´é–“æ±ºæ¸ˆæ—¥ãƒ‡ãƒ¼ã‚¿ï¼ˆå¹´é–“ä¼šå“¡ã®ã¿ï¼‰
        const annualPaymentDates = {
            'M003': '2024-03-01',
            'M004': '2024-03-08', 
            'M012': '2024-02-28',
            'M014': '2024-02-12',
            'M023': '2024-03-01',
            'M026': '2024-02-09',
            'M044': '2024-02-21',
            'M054': '2024-02-10',
            'M059': '2024-02-05',
            'M063': '2025-02-04',
            'M064': '2024-11-02',
            'M068': '2024-02-26',
            'M073': '2024-07-01',
            'M078': '2024-05-16',
            'M079': '2024-05-18',
            'M096': '2025-01-16',
            'M098': '2025-02-12',
            'M101': '2024-12-04',
            'M103': '2024-10-25',
            'M109': '2024-10-30'
        };

        // ãƒ¡ãƒ³ãƒãƒ¼ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
        const membersDatabase = [
            // å¹´é–“ä¼šå“¡ï¼ˆ20åï¼‰
            { id: 'M001', name: 'è—¤æ¾¤ç§€å½°', discord: 'è—¤æ¾¤', discordId: '', status: 'annual', joinDate: '2024-03-15', ltv: 650000, lastActive: '2025-07-28', events: 15, currentStatus: 'é€€ä¼š' },
            { id: 'M002', name: 'éˆ´æœ¨è£•ä»‹', discord: 'ã‚†ã†', discordId: 'exuberant_pomelo_29770', status: 'annual', joinDate: '2024-04-20', ltv: 9800, lastActive: '2025-07-27', events: 12, currentStatus: 'ä½“é¨“çµ‚äº†' },
            { id: 'M003', name: 'ç¦äº•åº·å¤§', discord: 'yasu0016', discordId: '', status: 'annual', joinDate: '2024-02-10', ltv: 720000, lastActive: '2025-07-29', events: 18, currentStatus: 'å¹´é–“' },
            { id: 'M004', name: 'ä¿µå¥å¤ªéƒ', discord: 'ãŸã‚ã‚‰', discordId: '', status: 'annual', joinDate: '2024-05-12', ltv: 620000, lastActive: '2025-07-26', events: 14, currentStatus: 'å¹´é–“' },
            { id: 'M005', name: 'é€²è—¤å‹‡è¼', discord: 'ã‚·ãƒ³', discordId: '', status: 'annual', joinDate: '2024-01-08', ltv: 780000, lastActive: '2025-07-30', events: 20, currentStatus: 'é€šå¸¸' },
            { id: 'M006', name: 'ä½è—¤è«’é§¿', status: 'annual', joinDate: '2024-06-18', ltv: 540000, lastActive: '2025-07-25', events: 11 },
            { id: 'M007', name: 'æ‰å¹³æ¶¼', status: 'annual', joinDate: '2024-03-22', ltv: 660000, lastActive: '2025-07-28', events: 16 },
            { id: 'M008', name: 'æ¾æœ¬å’Œä¹…', status: 'annual', joinDate: '2024-04-05', ltv: 590000, lastActive: '2025-07-27', events: 13 },
            { id: 'M009', name: 'æ¾ç”°é™½å¹³', status: 'annual', joinDate: '2024-07-01', ltv: 450000, lastActive: '2025-07-29', events: 8 },
            { id: 'M010', name: 'äº•ä¸Šç´”ä¹Ÿ', status: 'annual', joinDate: '2024-02-28', ltv: 710000, lastActive: '2025-07-30', events: 17 },
            { id: 'M011', name: 'æ ¹å¡šé™½å·±', status: 'annual', joinDate: '2024-05-30', ltv: 570000, lastActive: '2025-07-26', events: 12 },
            { id: 'M012', name: 'è—¤åŸç¶œå¤ªéƒ', status: 'annual', joinDate: '2024-01-15', ltv: 790000, lastActive: '2025-07-28', events: 21 },
            { id: 'M013', name: 'çŸ³å³¶ç§€å³°', status: 'annual', joinDate: '2024-06-08', ltv: 520000, lastActive: '2025-07-27', events: 10 },
            { id: 'M014', name: 'ä½è—¤äºœç¾', status: 'annual', joinDate: '2024-03-12', ltv: 680000, lastActive: '2025-07-29', events: 15 },
            { id: 'M015', name: 'å¡šæœ¬çœŸä¼', status: 'annual', joinDate: '2024-04-25', ltv: 600000, lastActive: '2025-07-25', events: 14 },
            { id: 'M016', name: 'æ¹Šç¿”å¤ªéƒ', status: 'annual', joinDate: '2024-07-10', ltv: 440000, lastActive: '2025-07-30', events: 7 },
            { id: 'M017', name: 'éˆ´æœ¨èœæ‘˜', status: 'annual', joinDate: '2024-02-05', ltv: 730000, lastActive: '2025-07-28', events: 19 },
            { id: 'M018', name: 'æ¾å³¶å¾¹', status: 'annual', joinDate: '2024-05-18', ltv: 610000, lastActive: '2025-07-26', events: 13 },
            { id: 'M019', name: 'ç²Ÿæ´¥å¾‹å­', status: 'annual', joinDate: '2024-01-25', ltv: 750000, lastActive: '2025-07-27', events: 20 },
            { id: 'M020', name: 'æ¦æœ¬é«˜ä¹Ÿ', status: 'annual', joinDate: '2024-06-22', ltv: 530000, lastActive: '2025-07-29', events: 11 },

            // é€šå¸¸ä¼šå“¡ï¼ˆ85åï¼‰- æä¾›ã•ã‚ŒãŸãƒªã‚¹ãƒˆã‹ã‚‰85åã‚’é¸å‡º
            { id: 'M021', name: 'çŸ³å£å‰è¦', status: 'regular', joinDate: '2024-08-15', ltv: 280000, lastActive: '2025-07-28', events: 8 },
            { id: 'M022', name: 'ãƒ–ãƒ«', status: 'regular', joinDate: '2024-09-10', ltv: 150000, lastActive: '2025-07-27', events: 5 },
            { id: 'M023', name: 'éˆ´æœ¨åº·å¤ª', status: 'regular', joinDate: '2024-10-05', ltv: 220000, lastActive: '2025-07-29', events: 6 },
            { id: 'M024', name: 'å¥¥æ‘æ‹“å“‰', status: 'regular', joinDate: '2024-11-12', ltv: 180000, lastActive: '2025-07-26', events: 4 },
            { id: 'M025', name: 'æ± æœ¬æ¹Šäº†æ±°', status: 'regular', joinDate: '2024-12-20', ltv: 120000, lastActive: '2025-07-25', events: 3 },
            { id: 'M026', name: 'æ¾æœ¬ç«œå­£', status: 'regular', joinDate: '2025-01-15', ltv: 90000, lastActive: '2025-07-30', events: 2 },
            { id: 'M027', name: 'è¥¿å³¶é¢¯äºº', status: 'regular', joinDate: '2025-02-08', ltv: 60000, lastActive: '2025-07-28', events: 1 },
            { id: 'M028', name: 'å±±ç¸£èª äºŒ', status: 'regular', joinDate: '2024-07-22', ltv: 320000, lastActive: '2025-07-27', events: 9 },
            { id: 'M029', name: 'ç¶¿è²«æ¡‚å¤ª', status: 'regular', joinDate: '2024-08-18', ltv: 260000, lastActive: '2025-07-29', events: 7 },
            { id: 'M030', name: 'æ¸…æ°´æš', status: 'regular', joinDate: '2024-09-25', ltv: 200000, lastActive: '2025-07-26', events: 5 },
            { id: 'M031', name: 'ä¸­æ‘æ„å¤®é‡Œ', status: 'regular', joinDate: '2024-10-30', ltv: 170000, lastActive: '2025-07-25', events: 4 },
            { id: 'M032', name: 'å³¶å®ˆå‹‡æ¬¡', status: 'regular', joinDate: '2024-11-15', ltv: 140000, lastActive: '2025-07-30', events: 3 },
            { id: 'M033', name: 'åƒå‰è‰¯ä¿Šå……', status: 'regular', joinDate: '2024-12-08', ltv: 110000, lastActive: '2025-07-28', events: 2 },
            { id: 'M034', name: 'å²©ä¸‹æœªèª‰å­', status: 'regular', joinDate: '2025-01-20', ltv: 80000, lastActive: '2025-07-27', events: 1 },
            { id: 'M035', name: 'å®‰ç”°æ»‰ä¸€', status: 'regular', joinDate: '2024-06-12', ltv: 380000, lastActive: '2025-07-29', events: 10 },
            { id: 'M036', name: 'çœŸæœ¨æ™ºä¹‹', status: 'regular', joinDate: '2024-07-05', ltv: 340000, lastActive: '2025-07-26', events: 9 },
            { id: 'M037', name: 'å‰åµœä¿Šä¸€éƒ', status: 'regular', joinDate: '2024-08-28', ltv: 240000, lastActive: '2025-07-25', events: 6 },
            { id: 'M038', name: 'ä»Šäº•ä¸€çœŸ', status: 'regular', joinDate: '2024-09-15', ltv: 190000, lastActive: '2025-07-30', events: 5 },
            { id: 'M039', name: 'å¹³é‡ç†çµµ', status: 'regular', joinDate: '2024-10-10', ltv: 160000, lastActive: '2025-07-28', events: 4 },
            { id: 'M040', name: 'å†…ç”°æ³°æ–‡', status: 'regular', joinDate: '2024-11-22', ltv: 130000, lastActive: '2025-07-27', events: 3 },
            { id: 'M041', name: 'å¢—ç”°å‡Œä¸€', status: 'regular', joinDate: '2024-12-18', ltv: 100000, lastActive: '2025-07-29', events: 2 },
            { id: 'M042', name: 'æ–°ä¿å‹æœ›å¥ˆ', status: 'regular', joinDate: '2025-01-12', ltv: 70000, lastActive: '2025-07-26', events: 1 },
            { id: 'M043', name: 'å¸‚å·ä½³å¥ˆ', status: 'regular', joinDate: '2024-05-25', ltv: 420000, lastActive: '2025-07-25', events: 11 },
            { id: 'M044', name: 'æ¸¡é‚‰æ™ºå¤§', status: 'regular', joinDate: '2024-06-30', ltv: 360000, lastActive: '2025-07-30', events: 10 },
            { id: 'M045', name: 'æ³‰ç”°ç¥è¼', status: 'regular', joinDate: '2024-07-18', ltv: 300000, lastActive: '2025-07-28', events: 8 },
            { id: 'M046', name: 'æ°¸äº•å…‹å¹¸', status: 'regular', joinDate: '2024-08-12', ltv: 250000, lastActive: '2025-07-27', events: 7 },
            { id: 'M047', name: 'èŒ‚æœ¨ä¸€å¹¸', status: 'regular', joinDate: '2024-09-08', ltv: 210000, lastActive: '2025-07-29', events: 6 },
            { id: 'M048', name: 'æ¾ç”°åœ­å³', status: 'regular', joinDate: '2024-10-20', ltv: 180000, lastActive: '2025-07-26', events: 4 },
            { id: 'M049', name: 'æ¾æ‘é¼æ²³', status: 'regular', joinDate: '2024-11-08', ltv: 150000, lastActive: '2025-07-25', events: 3 },
            { id: 'M050', name: 'å¹³å²©é¼å¿—', status: 'regular', joinDate: '2024-12-25', ltv: 120000, lastActive: '2025-07-30', events: 2 },
            { id: 'M051', name: 'ä½è—¤ä¸€æ°—', status: 'regular', joinDate: '2025-01-18', ltv: 90000, lastActive: '2025-07-28', events: 1 },
            { id: 'M052', name: 'ç…§äº•ç´€è‡£', status: 'regular', joinDate: '2024-04-15', ltv: 480000, lastActive: '2025-07-27', events: 12 },
            { id: 'M053', name: 'å‚è©°å®£äºº', status: 'regular', joinDate: '2024-05-12', ltv: 440000, lastActive: '2025-07-29', events: 11 },
            { id: 'M054', name: 'ä¸­æ‚ å¤ª', status: 'regular', joinDate: '2024-06-18', ltv: 380000, lastActive: '2025-07-26', events: 10 },
            { id: 'M055', name: 'å°æ—åƒæ³°', status: 'regular', joinDate: '2024-07-25', ltv: 320000, lastActive: '2025-07-25', events: 8 },
            { id: 'M056', name: 'å»£ç”°ä¸€æ•¬', status: 'regular', joinDate: '2024-08-08', ltv: 280000, lastActive: '2025-07-30', events: 7 },
            { id: 'M057', name: 'éˆ´æœ¨æ™ºå¼˜', status: 'regular', joinDate: '2024-09-12', ltv: 240000, lastActive: '2025-07-28', events: 6 },
            { id: 'M058', name: 'å°å³¶å•“è¼”', status: 'regular', joinDate: '2024-10-28', ltv: 200000, lastActive: '2025-07-27', events: 5 },
            { id: 'M059', name: 'å°¾å´å‹‡å“‰', status: 'regular', joinDate: '2024-11-18', ltv: 160000, lastActive: '2025-07-29', events: 4 },
            { id: 'M060', name: 'ä½ã€…æœ¨é€', status: 'regular', joinDate: '2024-12-05', ltv: 130000, lastActive: '2025-07-26', events: 3 },
            { id: 'M061', name: 'å°æ—å’Œè²´', status: 'regular', joinDate: '2025-01-08', ltv: 100000, lastActive: '2025-07-25', events: 2 },
            { id: 'M062', name: 'æ—¥é«˜æ‚ æ²³', status: 'regular', joinDate: '2024-03-20', ltv: 520000, lastActive: '2025-07-30', events: 13 },
            { id: 'M063', name: 'æ±Ÿå£é”å®', status: 'regular', joinDate: '2024-04-22', ltv: 460000, lastActive: '2025-07-28', events: 12 },
            { id: 'M064', name: 'æ±å‡ºæ•™è‹¥', status: 'regular', joinDate: '2024-05-30', ltv: 400000, lastActive: '2025-07-27', events: 10 },
            { id: 'M065', name: 'å‡ºç”°ç«œä¹Ÿ', status: 'regular', joinDate: '2024-06-25', ltv: 350000, lastActive: '2025-07-29', events: 9 },
            { id: 'M066', name: 'é•·ç”°ä¸€', status: 'regular', joinDate: '2024-07-15', ltv: 310000, lastActive: '2025-07-26', events: 8 },
            { id: 'M067', name: 'å¸‚æ©‹æ…å£«', status: 'regular', joinDate: '2024-08-20', ltv: 270000, lastActive: '2025-07-25', events: 7 },
            { id: 'M068', name: 'ä»Šäº•å¥ä»‹', status: 'regular', joinDate: '2024-09-18', ltv: 230000, lastActive: '2025-07-30', events: 6 },
            { id: 'M069', name: 'ä¸­è¥¿èˆªå¹³', status: 'regular', joinDate: '2024-10-15', ltv: 190000, lastActive: '2025-07-28', events: 5 },
            { id: 'M070', name: 'ç†Šè°·ç‘å¥ˆç¾', status: 'regular', joinDate: '2024-11-28', ltv: 150000, lastActive: '2025-07-27', events: 3 },
            { id: 'M071', name: 'å†…é‡çœŸå­', status: 'regular', joinDate: '2024-12-12', ltv: 120000, lastActive: '2025-07-29', events: 2 },
            { id: 'M072', name: 'ç¨²å£çœŸè£•', status: 'regular', joinDate: '2025-01-25', ltv: 80000, lastActive: '2025-07-26', events: 1 },
            { id: 'M073', name: 'æ¸…ç”°å®‡å®™', status: 'regular', joinDate: '2024-02-18', ltv: 560000, lastActive: '2025-07-25', events: 14 },
            { id: 'M074', name: 'çŒªé‡å€«å“‰', status: 'regular', joinDate: '2024-03-15', ltv: 500000, lastActive: '2025-07-30', events: 13 },
            { id: 'M075', name: 'æ¾å£å‹', status: 'regular', joinDate: '2024-04-10', ltv: 440000, lastActive: '2025-07-28', events: 11 },
            { id: 'M076', name: 'ç¯ å´å¼˜å¤š', status: 'regular', joinDate: '2024-05-08', ltv: 390000, lastActive: '2025-07-27', events: 10 },
            { id: 'M077', name: 'å¸‚æ‘æ™º', status: 'regular', joinDate: '2024-06-12', ltv: 340000, lastActive: '2025-07-29', events: 9 },
            { id: 'M078', name: 'ä»Šé‡å¤§è¼”', status: 'regular', joinDate: '2024-07-28', ltv: 290000, lastActive: '2025-07-26', events: 7 },
            { id: 'M079', name: 'å·¾å´ç”±ç´€å­', status: 'regular', joinDate: '2024-08-25', ltv: 250000, lastActive: '2025-07-25', events: 6 },
            { id: 'M080', name: 'ç±¾å±±éŠ€æ²³', status: 'regular', joinDate: '2024-09-22', ltv: 210000, lastActive: '2025-07-30', events: 5 },
            { id: 'M081', name: 'å‚ä¹‹ä¸Šé¢¯äºº', status: 'regular', joinDate: '2024-10-18', ltv: 170000, lastActive: '2025-07-28', events: 4 },
            { id: 'M082', name: 'æ°å®¶å¨å¹', status: 'regular', joinDate: '2024-11-25', ltv: 140000, lastActive: '2025-07-27', events: 3 },
            { id: 'M083', name: 'é»’æŸ³æœ±éŸ³', status: 'regular', joinDate: '2024-12-20', ltv: 110000, lastActive: '2025-07-29', events: 2 },
            { id: 'M084', name: 'å›½å®‰ã‚ãšã¿', status: 'regular', joinDate: '2025-01-15', ltv: 75000, lastActive: '2025-07-26', events: 1 },
            { id: 'M085', name: 'é˜ªæœ¬å·³ç–ä¹Ÿ', status: 'regular', joinDate: '2024-01-20', ltv: 580000, lastActive: '2025-07-25', events: 15 },
            { id: 'M086', name: 'å‚æœ¬ç ”å¤ªæœ—', status: 'regular', joinDate: '2024-02-25', ltv: 540000, lastActive: '2025-07-30', events: 14 },
            { id: 'M087', name: 'è—¤äº•å¾¹', status: 'regular', joinDate: '2024-03-28', ltv: 480000, lastActive: '2025-07-28', events: 12 },
            { id: 'M088', name: 'å‰å²¡ä½‘å¼¥', status: 'regular', joinDate: '2024-04-18', ltv: 420000, lastActive: '2025-07-27', events: 11 },
            { id: 'M089', name: 'ä½è—¤æ­å¹³', status: 'regular', joinDate: '2024-05-22', ltv: 380000, lastActive: '2025-07-29', events: 10 },
            { id: 'M090', name: 'å°æ¸•æ¡ƒå­', status: 'regular', joinDate: '2024-06-15', ltv: 330000, lastActive: '2025-07-26', events: 9 },
            { id: 'M091', name: 'æ£®å²¡è£•ä¹‹', status: 'regular', joinDate: '2024-07-12', ltv: 280000, lastActive: '2025-07-25', events: 8 },
            { id: 'M092', name: 'é è—¤ç‘›å¤ª', status: 'regular', joinDate: '2024-08-05', ltv: 240000, lastActive: '2025-07-30', events: 6 },
            { id: 'M093', name: 'äº€äº•æ‚ ', status: 'regular', joinDate: '2024-09-10', ltv: 200000, lastActive: '2025-07-28', events: 5 },
            { id: 'M094', name: 'ä¼Šè—¤è‹±å“‰', status: 'regular', joinDate: '2024-10-08', ltv: 160000, lastActive: '2025-07-27', events: 4 },
            { id: 'M095', name: 'å°æ‰æ²™é‡Œè¡£', status: 'regular', joinDate: '2024-11-12', ltv: 130000, lastActive: '2025-07-29', events: 3 },
            { id: 'M096', name: 'è–„ç”°äº¬', status: 'regular', joinDate: '2024-12-08', ltv: 100000, lastActive: '2025-07-26', events: 2 },
            { id: 'M097', name: 'æ·ºæ²¼ä½³é‚£å­', status: 'regular', joinDate: '2025-01-05', ltv: 70000, lastActive: '2025-07-25', events: 1 },
            { id: 'M098', name: 'å±±ç”°å¤§å°†', status: 'regular', joinDate: '2023-12-15', ltv: 620000, lastActive: '2025-07-30', events: 16 },
            { id: 'M099', name: 'æ°¸é‡ç¦ä¸‰', status: 'regular', joinDate: '2024-01-08', ltv: 590000, lastActive: '2025-07-28', events: 15 },
            { id: 'M100', name: 'ä¸­æ ¹æ»‰ä»‹', status: 'regular', joinDate: '2024-02-12', ltv: 520000, lastActive: '2025-07-27', events: 13 },
            { id: 'M101', name: 'å±±ç”°å‰›', status: 'regular', joinDate: '2024-03-05', ltv: 460000, lastActive: '2025-07-29', events: 12 },
            { id: 'M102', name: 'ç”°åŸç’ƒéŸ³', status: 'regular', joinDate: '2024-04-08', ltv: 400000, lastActive: '2025-07-26', events: 10 },
            { id: 'M103', name: 'æ·ºåˆ©å‹‡æ–—', status: 'regular', joinDate: '2024-05-15', ltv: 350000, lastActive: '2025-07-25', events: 9 },
            { id: 'M104', name: 'ç‰‡å±±è£•å­', status: 'regular', joinDate: '2024-06-20', ltv: 310000, lastActive: '2025-07-30', events: 8 },
            { id: 'M105', name: 'æ°´æ—éº»é‡Œæµ', status: 'regular', joinDate: '2024-07-08', ltv: 270000, lastActive: '2025-07-28', events: 7 },

            // ä½“é¨“ä¼šå“¡ï¼ˆ5åï¼‰
            { id: 'M106', name: 'æ¦æœ¬çŸ¥ä½³', status: 'trial', joinDate: '2025-07-15', ltv: 5000, lastActive: '2025-07-27', events: 1 },
            { id: 'M107', name: 'ç• ç”°ã¯ãª', status: 'trial', joinDate: '2025-07-18', ltv: 5000, lastActive: '2025-07-29', events: 1 },
            { id: 'M108', name: 'ä¸Šæ‘å¾¹é›„', status: 'trial', joinDate: '2025-07-22', ltv: 5000, lastActive: '2025-07-26', events: 1 },
            { id: 'M109', name: 'æ¸¡é‚Šæ•¦å­', status: 'trial', joinDate: '2025-07-25', ltv: 5000, lastActive: '2025-07-25', events: 1 },
            { id: 'M110', name: 'ä¼Šè—¤å¥è¡£', status: 'trial', joinDate: '2025-07-28', ltv: 5000, lastActive: '2025-07-30', events: 1 }
        ];

        let filteredMembers = [];

        // LTVè¨ˆç®—é–¢æ•°
        function calculateBaseLTV(member) {
            const now = new Date();
            
            // ç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã«åŸºã¥ã„ã¦LTVã‚’è¨ˆç®—
            if (member.currentStatus === 'ä½“é¨“çµ‚äº†') {
                return 3000; // ä½“é¨“ã®ã¿
            } else if (member.currentStatus === 'é€€ä¼š' || member.currentStatus === 'é€šå¸¸') {
                // é€šå¸¸ä¼šå“¡ã®è¨ˆç®—ï¼ˆé€€ä¼šãƒ»ç¶™ç¶šå•ã‚ãšï¼‰
                // regularJoinDateï¼ˆæ­£è¦æ”¯æ‰•ã„é–‹å§‹æ—¥ï¼‰ã‹ã‚‰è¨ˆç®—
                if (member.regularJoinDate) {
                    const regularStartDate = new Date(member.regularJoinDate);
                    const monthsActive = Math.max(1, Math.floor((now - regularStartDate) / (1000 * 60 * 60 * 24 * 30)));
                    return 3000 + (monthsActive * 22000); // ä½“é¨“ + é€šå¸¸ä¼šå“¡æœŸé–“
                } else {
                    // regularJoinDateãŒãªã„å ´åˆã¯joinDateã‹ã‚‰æ¨å®š
                    const joinDate = new Date(member.joinDate);
                    const monthsActive = Math.max(1, Math.floor((now - joinDate) / (1000 * 60 * 60 * 24 * 30)));
                    return monthsActive * 22000;
                }
            } else if (member.currentStatus === 'å¹´é–“') {
                // å¹´é–“ä¼šå“¡ï¼šå…¥ä¼šã‹ã‚‰ã®å¹´æ•° Ã— 220,000å††
                const joinDate = new Date(member.regularJoinDate || member.joinDate);
                const yearsActive = Math.max(1, Math.ceil((now - joinDate) / (1000 * 60 * 60 * 24 * 365)));
                return yearsActive * 220000;
            }
            return 0;
        }

        // å¹´é–“æ±ºæ¸ˆæ›´æ–°æœŸé™è¨ˆç®—
        function calculateRenewalStatus(member) {
            if (member.currentStatus !== 'å¹´é–“' || !member.annualPaymentDate) {
                return { status: 'ãªã—', daysUntilRenewal: null, renewalDate: null };
            }

            const today = new Date();
            const lastPayment = new Date(member.annualPaymentDate);
            const renewalDate = new Date(lastPayment);
            renewalDate.setFullYear(renewalDate.getFullYear() + 1);
            
            const daysUntilRenewal = Math.ceil((renewalDate - today) / (1000 * 60 * 60 * 24));
            
            let status;
            if (daysUntilRenewal < 0) {
                status = 'æ›´æ–°å¿…è¦';
            } else if (daysUntilRenewal <= 30) {
                status = 'æ›´æ–°é–“è¿‘';
            } else if (daysUntilRenewal <= 60) {
                status = 'è¦æ³¨æ„';
            } else {
                status = 'æ­£å¸¸';
            }

            return {
                status: status,
                daysUntilRenewal: daysUntilRenewal,
                renewalDate: renewalDate.toISOString().split('T')[0]
            };
        }

        // ãƒ¡ãƒ³ãƒãƒ¼ãƒ‡ãƒ¼ã‚¿ã®åˆæœŸåŒ–ï¼ˆç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã¨LTVã®èª¿æ•´ï¼‰
        function initializeMemberData() {
            membersDatabase.forEach((member, index) => {
                // ç¾åœ¨ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’è¨­å®š
                member.currentStatus = currentStatusArray[index];
                
                // æ­£è¦æ”¯æ‰•ã„é–‹å§‹æ—¥ã‚’è¨­å®š
                member.regularJoinDate = regularJoinDateArray[index] || null;
                
                // LTVã‚’æ­£ã—ãè¨ˆç®—
                member.ltv = calculateBaseLTV(member);
                
                // ä¸‰æ¯’ãƒãƒ¼ãƒ æƒ…å ±ã‚’è¨­å®š
                if (typeof threePoisonsTeamMapping !== 'undefined') {
                    member.threePoisonsTeam = threePoisonsTeamMapping[member.name] || 'æœªè¨­å®š';
                }
                
                // ã‚¢ãƒƒãƒ—ã‚»ãƒ«å£²ä¸Šã®è¨­å®š
                member.upsales = member.upsales || [];
                let totalUpsales = 0;
                
                // å¾¹åº•ç²¾é€²è³¼å…¥è€…ã®å ´åˆ
                if (tesseiShinPurchasers.includes(member.name)) {
                    const tesseiShin = {
                        name: 'å¾¹åº•ç²¾é€²',
                        totalAmount: 330000,
                        purchaseDate: '2025-06',
                        installments: 3,
                        monthlyAmount: 110000,
                        paidInstallments: 2, // 2å›åˆ†æ”¯æ‰•ã„æ¸ˆã¿ï¼ˆ6æœˆã€7æœˆï¼‰
                        remainingAmount: 110000,
                        nextPaymentDate: '2025-08-31',
                        status: 'åˆ†å‰²ä¸­'
                    };
                    member.upsales.push(tesseiShin);
                    totalUpsales += 330000;
                }
                
                // NHãƒ–ãƒ¼ãƒˆã‚­ãƒ£ãƒ³ãƒ—è³¼å…¥è€…ã®å ´åˆ
                const nhPurchase = nhBootcampPurchasers.find(p => p.name === member.name);
                if (nhPurchase) {
                    const nhBootcamp = {
                        name: nhPurchase.product,
                        totalAmount: nhPurchase.amount,
                        purchaseDate: nhPurchase.date,
                        installments: 1,
                        monthlyAmount: nhPurchase.amount,
                        paidInstallments: 1,
                        remainingAmount: 0,
                        nextPaymentDate: null,
                        status: 'å®Œæ¸ˆ'
                    };
                    member.upsales.push(nhBootcamp);
                    totalUpsales += nhPurchase.amount;
                }
                
                member.totalUpsales = totalUpsales;
                
                member.totalLTV = member.ltv + member.totalUpsales;

                // å¹´é–“æ±ºæ¸ˆæ—¥ã‚’è¨­å®š
                if (member.currentStatus === 'å¹´é–“') {
                    member.annualPaymentDate = annualPaymentDates[member.id] || null;
                    
                    if (member.annualPaymentDate) {
                        const renewalInfo = calculateRenewalStatus(member);
                        member.renewalStatus = renewalInfo.status;
                        member.daysUntilRenewal = renewalInfo.daysUntilRenewal;
                        member.renewalDate = renewalInfo.renewalDate;
                    }
                }
            });
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            try {
                console.log('DOMContentLoadedå®Ÿè¡Œé–‹å§‹');
                console.log('membersDatabaseé•·ã•:', membersDatabase ? membersDatabase.length : 'undefined');
                
                if (!membersDatabase || membersDatabase.length === 0) {
                    console.error('membersDatabase ãŒç©ºã¾ãŸã¯æœªå®šç¾©');
                    document.getElementById('memberGrid').innerHTML = '<div style="text-align:center; padding:50px; color:red;">ãƒ¡ãƒ³ãƒãƒ¼ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</div>';
                    return;
                }
                
                initializeMemberData();
                filteredMembers = [...membersDatabase];
                console.log('filteredMembersé•·ã•:', filteredMembers.length);
                
                // ç›´æ¥renderMembersã‚’å‘¼ã³å‡ºã—ã¦ãƒ†ã‚¹ãƒˆ
                renderMembers();
                setupEventListeners();
                updateStats();
                
                console.log('åˆæœŸåŒ–å®Œäº†');
            } catch (error) {
                console.error('åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
                document.getElementById('memberGrid').innerHTML = '<div style="text-align:center; padding:50px; color:red;">åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: ' + error.message + '</div>';
            }
        });

        // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¡ãƒ³ãƒãƒ¼ã®ã¿è¡¨ç¤ºãƒ•ãƒ©ã‚°
        let showActiveOnly = false;

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
        function setupEventListeners() {
            document.getElementById('searchBox').addEventListener('input', filterMembers);
            document.getElementById('statusFilter').addEventListener('change', filterMembers);
            document.getElementById('sortBy').addEventListener('change', sortMembers);
            document.getElementById('teamFilter').addEventListener('change', filterMembers);
            document.getElementById('activeOnlyBtn').addEventListener('click', toggleActiveOnly);
            document.getElementById('rankingBtn').addEventListener('click', showLTVRanking);
            document.getElementById('renewalAlertBtn').addEventListener('click', showRenewalAlert);
        }

        // LTVãƒ©ãƒ³ã‚­ãƒ³ã‚°è¡¨ç¤º
        function showLTVRanking() {
            // ç¾å½¹ä¼šå“¡ã‚’ãƒ•ã‚£ãƒ«ã‚¿
            showActiveOnly = true;
            const btn = document.getElementById('activeOnlyBtn');
            btn.style.background = '#dc3545';
            btn.textContent = 'ğŸš« å…¨å“¡è¡¨ç¤º';
            
            // LTVé †ã§ã‚½ãƒ¼ãƒˆ
            document.getElementById('sortBy').value = 'ltv';
            filterMembers();
        }

        // æ›´æ–°é–“è¿‘ã‚¢ãƒ©ãƒ¼ãƒˆè¡¨ç¤º
        function showRenewalAlert() {
            const renewalAlertMembers = membersDatabase.filter(m => 
                m.currentStatus === 'å¹´é–“' && 
                (m.renewalStatus === 'æ›´æ–°å¿…è¦' || m.renewalStatus === 'æ›´æ–°é–“è¿‘' || m.renewalStatus === 'è¦æ³¨æ„')
            );

            if (renewalAlertMembers.length === 0) {
                alert('ç¾åœ¨ã€æ›´æ–°ãŒå¿…è¦ãªå¹´é–“ä¼šå“¡ã¯ã„ã¾ã›ã‚“ã€‚');
                return;
            }

            // æ›´æ–°æœŸé™é †ã§ã‚½ãƒ¼ãƒˆ
            renewalAlertMembers.sort((a, b) => (a.daysUntilRenewal || -999) - (b.daysUntilRenewal || -999));

            let alertMessage = `âš ï¸ å¹´é–“ä¼šå“¡æ›´æ–°ã‚¢ãƒ©ãƒ¼ãƒˆ (${renewalAlertMembers.length}å)\n\n`;
            
            renewalAlertMembers.forEach(member => {
                const daysText = member.daysUntilRenewal < 0 ? 
                    `æœŸé™åˆ‡ã‚Œ(${Math.abs(member.daysUntilRenewal)}æ—¥çµŒé)` : 
                    `ã‚ã¨${member.daysUntilRenewal}æ—¥`;
                
                alertMessage += `${member.name} (${member.id})\n`;
                alertMessage += `  â”” ${member.renewalStatus}: ${daysText}\n`;
                alertMessage += `  â”” æ›´æ–°æœŸé™: ${member.renewalDate}\n\n`;
            });

            alert(alertMessage);

            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’å¹´é–“ä¼šå“¡ã«è¨­å®š
            document.getElementById('statusFilter').value = 'å¹´é–“';
            filterMembers();
        }

        // ç¾å½¹ä¼šå“¡ã®ã¿è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
        function toggleActiveOnly() {
            showActiveOnly = !showActiveOnly;
            const btn = document.getElementById('activeOnlyBtn');
            
            if (showActiveOnly) {
                btn.style.background = '#dc3545';
                btn.textContent = 'ğŸš« å…¨å“¡è¡¨ç¤º';
                btn.title = 'ã‚¯ãƒªãƒƒã‚¯ã§å…¨ãƒ¡ãƒ³ãƒãƒ¼ã‚’è¡¨ç¤º';
            } else {
                btn.style.background = '#28a745';
                btn.textContent = 'ğŸ‘¥ ç¾å½¹ä¼šå“¡ã®ã¿';
                btn.title = 'ã‚¯ãƒªãƒƒã‚¯ã§ç¾å½¹ä¼šå“¡ã®ã¿è¡¨ç¤º';
            }
            
            filterMembers();
        }

        // ãƒ¡ãƒ³ãƒãƒ¼ãƒªã‚¹ãƒˆã‚¢ã‚¤ãƒ†ãƒ ã®ç”Ÿæˆ
        function createMemberCard(member) {
            // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤ºï¼ˆå¹´é–“ä¼šå“¡ã¯æ›´æ–°æœŸé™æƒ…å ±ã‚’è¡¨ç¤ºï¼‰
            let statusLabel = member.currentStatus || {
                'annual': 'å¹´é–“',
                'regular': 'é€šå¸¸',
                'trial': 'ä½“é¨“'
            }[member.status];
            
            let statusClass = `status-${member.currentStatus || member.status}`;
            
            if (member.currentStatus === 'å¹´é–“' && member.renewalDate) {
                const today = new Date();
                const currentMonth = today.getMonth() + 1;
                const renewalDate = new Date(member.renewalDate);
                const renewalMonth = renewalDate.getMonth() + 1;
                
                if (member.daysUntilRenewal <= 30) {
                    statusLabel = `å¹´é–“(${renewalMonth}æœˆæ›´æ–°)`;
                    if (member.daysUntilRenewal < 0) {
                        statusClass += ' renewal-overdue';
                    } else {
                        statusClass += ' renewal-soon';
                    }
                } else {
                    statusLabel = `å¹´é–“(${currentMonth}æœˆ)`;
                }
            }

            // ä¸‰æ¯’ãƒãƒ¼ãƒ è¡¨ç¤º
            const teamClass = `team-${member.threePoisonsTeam || 'æœªè¨­å®š'}`;
            const teamLabel = member.threePoisonsTeam || 'æœªè¨­å®š';



            const opacity = (member.currentStatus === 'é€€ä¼š' || member.currentStatus === 'ä½“é¨“çµ‚äº†') ? 'opacity: 0.6;' : '';

            // ã‚¢ãƒƒãƒ—ã‚»ãƒ«è¡¨ç¤º
            let upsaleDisplay = '-';
            if (member.upsales && member.upsales.length > 0) {
                const upsaleNames = member.upsales.map(u => {
                    if (u.name === 'å¾¹åº•ç²¾é€²') return 'å¾¹åº•ç²¾é€²';
                    if (u.name.includes('NHãƒ–ãƒ¼ãƒˆã‚­ãƒ£ãƒ³ãƒ—') || u.name.includes('NHBC')) return 'NHBC';
                    return u.name.substring(0, 8);
                });
                upsaleDisplay = upsaleNames.join(' + ');
            }

            return `
                <div class="member-list-item" onclick="openMemberDetail('${member.id}')" style="${opacity}">
                    <div class="member-id">${member.id}</div>
                    <div class="member-name">${member.name}</div>
                    <div class="member-status ${statusClass}">${statusLabel}</div>
                    <div class="member-team ${teamClass}">${teamLabel}</div>
                    <div class="ltv-display">Â¥${member.ltv.toLocaleString()}</div>
                    <div class="upsale-display">${upsaleDisplay}</div>
                    <div class="total-ltv-display">Â¥${member.totalLTV.toLocaleString()}</div>
                </div>
            `;
        }

        // ãƒ¡ãƒ³ãƒãƒ¼ä¸€è¦§ã®æç”»
        function renderMembers() {
            try {
                console.log('renderMembersé–‹å§‹, filteredMembersæ•°:', filteredMembers ? filteredMembers.length : 'undefined');
                const grid = document.getElementById('memberGrid');
                
                if (!grid) {
                    console.error('memberGridè¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                    return;
                }
                
                if (!filteredMembers || filteredMembers.length === 0) {
                    console.log('filteredMembersãŒç©ºã§ã™');
                    grid.innerHTML = '<div style="text-align:center; padding:50px;">ãƒ¡ãƒ³ãƒãƒ¼ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“</div>';
                    return;
                }
                
                console.log('æœ€åˆã®ãƒ¡ãƒ³ãƒãƒ¼:', filteredMembers[0]);
                
                // ã‚·ãƒ³ãƒ—ãƒ«ãªHTMLç”Ÿæˆã§ãƒ†ã‚¹ãƒˆ
                let html = '';
                for (let i = 0; i < Math.min(filteredMembers.length, 10); i++) {
                    const member = filteredMembers[i];
                    html += `
                        <div style="padding: 10px; border-bottom: 1px solid #eee; display: grid; grid-template-columns: 50px 150px 100px 80px 100px 100px 120px; gap: 8px; font-size: 0.8em;">
                            <div>${member.id}</div>
                            <div>${member.name}</div>
                            <div>${member.currentStatus || member.status || 'ä¸æ˜'}</div>
                            <div>${member.threePoisonsTeam || 'æœªè¨­å®š'}</div>
                            <div>Â¥${(member.ltv || 0).toLocaleString()}</div>
                            <div>Â¥${(member.totalUpsales || 0).toLocaleString()}</div>
                            <div>Â¥${(member.totalLTV || member.ltv || 0).toLocaleString()}</div>
                        </div>
                    `;
                }
                
                grid.innerHTML = html;
                console.log('ãƒ¡ãƒ³ãƒãƒ¼è¡¨ç¤ºå®Œäº†:', Math.min(filteredMembers.length, 10), 'åè¡¨ç¤º');
                
            } catch (error) {
                console.error('renderMembersã‚¨ãƒ©ãƒ¼:', error);
                const grid = document.getElementById('memberGrid');
                if (grid) {
                    grid.innerHTML = '<div style="text-align:center; padding:50px; color:red;">è¡¨ç¤ºã‚¨ãƒ©ãƒ¼: ' + error.message + '</div>';
                }
            }
        }

        // ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
        function filterMembers() {
            const searchTerm = document.getElementById('searchBox').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            const teamFilter = document.getElementById('teamFilter').value;

            filteredMembers = membersDatabase.filter(member => {
                const matchesSearch = member.name.toLowerCase().includes(searchTerm);
                const matchesStatus = !statusFilter || member.currentStatus === statusFilter;
                const matchesTeam = !teamFilter || member.threePoisonsTeam === teamFilter;
                
                // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¡ãƒ³ãƒãƒ¼ã®ã¿è¡¨ç¤ºãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
                const isActive = member.currentStatus === 'å¹´é–“' || member.currentStatus === 'é€šå¸¸';
                const matchesActiveFilter = !showActiveOnly || isActive;
                
                return matchesSearch && matchesStatus && matchesTeam && matchesActiveFilter;
            });

            sortMembers();
        }

        // ã‚½ãƒ¼ãƒˆ
        function sortMembers() {
            const sortBy = document.getElementById('sortBy').value;

            filteredMembers.sort((a, b) => {
                switch(sortBy) {
                    case 'id':
                        return a.id.localeCompare(b.id);
                    case 'ltv':
                        return b.totalLTV - a.totalLTV;
                    case 'ltvLow':
                        return a.totalLTV - b.totalLTV;
                    case 'joinDate':
                        return new Date(b.joinDate) - new Date(a.joinDate);
                    case 'subscription':
                        const aMonths = a.regularJoinDate ? Math.floor((new Date() - new Date(a.regularJoinDate)) / (1000 * 60 * 60 * 24 * 30)) : 0;
                        const bMonths = b.regularJoinDate ? Math.floor((new Date() - new Date(b.regularJoinDate)) / (1000 * 60 * 60 * 24 * 30)) : 0;
                        return bMonths - aMonths;
                    case 'events':
                        return b.events - a.events;
                    case 'name':
                        return a.name.localeCompare(b.name, 'ja');
                    default:
                        return a.id.localeCompare(b.id);
                }
            });

            renderMembers();
            updateStats();
        }

        // çµ±è¨ˆã®æ›´æ–°
        function updateStats() {
            const total = filteredMembers.length;
            const annual = filteredMembers.filter(m => m.currentStatus === 'å¹´é–“').length;
            const regular = filteredMembers.filter(m => m.currentStatus === 'é€šå¸¸').length;
            const trialEnded = filteredMembers.filter(m => m.currentStatus === 'ä½“é¨“çµ‚äº†').length;
            const churned = filteredMembers.filter(m => m.currentStatus === 'é€€ä¼š').length;
            
            // ç¾å½¹ä¼šå“¡ï¼ˆå¹´é–“+é€šå¸¸ï¼‰ã®LTV
            const activeLTV = filteredMembers
                .filter(m => m.currentStatus === 'å¹´é–“' || m.currentStatus === 'é€šå¸¸')
                .reduce((sum, m) => sum + m.ltv, 0);

            // ä»Šæœˆãƒ»æ¥æœˆã®æ›´æ–°äºˆå®šè€…çµ±è¨ˆ
            const today = new Date();
            const currentMonth = today.getMonth() + 1;
            const nextMonth = currentMonth === 12 ? 1 : currentMonth + 1;
            
            const thisMonthRenewals = filteredMembers.filter(m => {
                if (m.currentStatus !== 'å¹´é–“' || !m.renewalDate) return false;
                const renewalDate = new Date(m.renewalDate);
                return renewalDate.getMonth() + 1 === currentMonth;
            }).length;
            
            const nextMonthRenewals = filteredMembers.filter(m => {
                if (m.currentStatus !== 'å¹´é–“' || !m.renewalDate) return false;
                const renewalDate = new Date(m.renewalDate);
                return renewalDate.getMonth() + 1 === nextMonth;
            }).length;

            // ä»Šæœˆãƒ»æ¥æœˆã®å£²ä¸Šäºˆå®šè¨ˆç®—
            const thisMonthRevenue = thisMonthRenewals * 220000; // å¹´é–“æ›´æ–° Â¥220,000
            const nextMonthRevenue = nextMonthRenewals * 220000;

            // é€šå¸¸ä¼šå“¡ã®æœˆé¡å£²ä¸Šã‚‚åŠ ç®—
            const currentRegularMembers = filteredMembers.filter(m => m.currentStatus === 'é€šå¸¸').length;
            const thisMonthTotalRevenue = thisMonthRevenue + (currentRegularMembers * 22000);
            const nextMonthTotalRevenue = nextMonthRevenue + (currentRegularMembers * 22000);

            // ãƒ¡ãƒ³ãƒãƒ¼æ•°æ¨ç§»è¨ˆç®—
            const currentActiveMembers = annual + regular;
            const today = new Date();
            const currentMonthKey = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}`;
            const lastMonthKey = today.getMonth() === 0 ? 
                `${today.getFullYear() - 1}-12` : 
                `${today.getFullYear()}-${String(today.getMonth()).padStart(2, '0')}`;
            const lastYearKey = `${today.getFullYear() - 1}-${String(today.getMonth() + 1).padStart(2, '0')}`;

            const lastMonthData = memberGrowthData[lastMonthKey];
            const lastYearData = memberGrowthData[lastYearKey];

            const monthlyGrowth = lastMonthData ? 
                currentActiveMembers - (lastMonthData.annual + lastMonthData.regular) : 0;
            const yearlyGrowth = lastYearData ? 
                currentActiveMembers - (lastYearData.annual + lastYearData.regular) : 0;
            const growthRate = lastMonthData ? 
                ((currentActiveMembers - (lastMonthData.annual + lastMonthData.regular)) / (lastMonthData.annual + lastMonthData.regular) * 100) : 0;

            // ä¸‰æ¯’ãƒãƒ¼ãƒ çµ±è¨ˆ
            const greedCount = filteredMembers.filter(m => m.threePoisonsTeam === 'è²ªæ¬²').length;
            const angerCount = filteredMembers.filter(m => m.threePoisonsTeam === 'ç‹æš').length;
            const ignoranceCount = filteredMembers.filter(m => m.threePoisonsTeam === 'æ„šç—´').length;
            const noTeamCount = filteredMembers.filter(m => m.threePoisonsTeam === 'ãªã—').length;
            const unassignedCount = filteredMembers.filter(m => m.threePoisonsTeam === 'æœªè¨­å®š').length;

            // çµ±è¨ˆã‚’æ›´æ–°
            document.getElementById('total-members').textContent = total;
            document.getElementById('annual-members').textContent = annual;
            document.getElementById('regular-members').textContent = regular;
            document.getElementById('trial-ended-members').textContent = trialEnded;
            document.getElementById('churned-members').textContent = churned;
            document.getElementById('active-ltv').textContent = `Â¥${(activeLTV / 1000000).toFixed(1)}M`;

            // æ›´æ–°äºˆå®šãƒ»å£²ä¸Šçµ±è¨ˆã‚’æ›´æ–°
            document.getElementById('this-month-count').textContent = thisMonthRenewals;
            document.getElementById('next-month-count').textContent = nextMonthRenewals;
            document.getElementById('this-month-revenue').textContent = `Â¥${(thisMonthTotalRevenue / 1000).toFixed(0)}K`;
            document.getElementById('next-month-revenue').textContent = `Â¥${(nextMonthTotalRevenue / 1000).toFixed(0)}K`;

            // ãƒ¡ãƒ³ãƒãƒ¼æ•°æ¨ç§»çµ±è¨ˆã‚’æ›´æ–°
            document.getElementById('current-active-members').textContent = currentActiveMembers;
            document.getElementById('monthly-growth').textContent = monthlyGrowth >= 0 ? `+${monthlyGrowth}` : monthlyGrowth;
            document.getElementById('yearly-growth').textContent = yearlyGrowth >= 0 ? `+${yearlyGrowth}` : yearlyGrowth;
            document.getElementById('growth-rate').textContent = `${growthRate.toFixed(1)}%`;

            // ä¸‰æ¯’ãƒãƒ¼ãƒ çµ±è¨ˆã‚’æ›´æ–°
            document.getElementById('greed-count').textContent = greedCount;
            document.getElementById('anger-count').textContent = angerCount;
            document.getElementById('ignorance-count').textContent = ignoranceCount;
            document.getElementById('no-team-count').textContent = noTeamCount;
            document.getElementById('unassigned-count').textContent = unassignedCount;
        }

        // ãƒ¡ãƒ³ãƒãƒ¼è©³ç´°ã‚’é–‹ã
        function openMemberDetail(memberId) {
            const member = membersDatabase.find(m => m.id === memberId);
            if (member) {
                // ãƒ¡ãƒ³ãƒãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’localStorageã«ä¿å­˜
                localStorage.setItem(`member_${memberId}`, JSON.stringify(member));
                
                // è©³ç´°ãƒšãƒ¼ã‚¸ã«é·ç§»
                window.open(`member_detail.html?id=${memberId}`, '_blank');
            }
        }

        // æ–°ã—ã„ãƒ¡ãƒ³ãƒãƒ¼ã‚’è¿½åŠ 
        function addNewMember() {
            const name = prompt('æ–°ã—ã„ãƒ¡ãƒ³ãƒãƒ¼ã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:');
            if (name && name.trim()) {
                const newMember = {
                    id: `M${String(membersDatabase.length + 1).padStart(3, '0')}`,
                    name: name.trim(),
                    status: 'trial',
                    joinDate: new Date().toISOString().split('T')[0],
                    ltv: 5000,
                    lastActive: new Date().toISOString().split('T')[0],
                    events: 0
                };
                membersDatabase.push(newMember);
                filterMembers();
                alert(`${name}ã•ã‚“ã‚’è¿½åŠ ã—ã¾ã—ãŸï¼`);
            }
        }
    </script>
</body>
</html>
